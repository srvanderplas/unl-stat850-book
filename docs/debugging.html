<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 7 Principles of Debugging | Stat 850: Computing Tools for Statisticians</title>
  <meta name="description" content="Introductions to statistical computing packages and document preparation software. Topics include: graphical techniques, data management, Monte Carlo simulation, dynamic document preparation, presentation software." />
  <meta name="generator" content="bookdown 0.20.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 7 Principles of Debugging | Stat 850: Computing Tools for Statisticians" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introductions to statistical computing packages and document preparation software. Topics include: graphical techniques, data management, Monte Carlo simulation, dynamic document preparation, presentation software." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 7 Principles of Debugging | Stat 850: Computing Tools for Statisticians" />
  
  <meta name="twitter:description" content="Introductions to statistical computing packages and document preparation software. Topics include: graphical techniques, data management, Monte Carlo simulation, dynamic document preparation, presentation software." />
  

<meta name="author" content="Susan Vanderplas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="transforming-data.html"/>
<link rel="next" href="data-vis-intro.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script>

(function() {
  var codes = document.querySelectorAll('pre:not([class])');
  var code, i, d, s, p;
  for (i = 0; i < codes.length; i++) {
    code = codes[i];
    p = code.parentNode;
    d = document.createElement('details');
    s = document.createElement('summary');
    s.innerText = 'Answers';
    // <details><summary>Answers</summary></details>
      d.appendChild(s);
    // move the code into <details>
      p.replaceChild(d, code);
    d.appendChild(code);
  }
})();
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Statistical Computing</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>1</b> Tools for Statistical Computing</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="1.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a><ul>
<li class="chapter" data-level="1.1.1" data-path="tools.html"><a href="tools.html#getting-set-up-r"><i class="fa fa-check"></i><b>1.1.1</b> Getting Set up: R</a></li>
<li class="chapter" data-level="1.1.2" data-path="tools.html"><a href="tools.html#getting-set-up-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Getting Set up: RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="tools.html"><a href="tools.html#exploring-rstudio"><i class="fa fa-check"></i><b>1.1.3</b> Exploring RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tools.html"><a href="tools.html#sas"><i class="fa fa-check"></i><b>1.2</b> SAS</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#note"><i class="fa fa-check"></i>Note</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="tools.html"><a href="tools.html#version-control-with-git"><i class="fa fa-check"></i><b>1.3</b> Version Control with Git</a><ul>
<li class="chapter" data-level="1.3.1" data-path="tools.html"><a href="tools.html#getting-set-up-github"><i class="fa fa-check"></i><b>1.3.1</b> Getting set up: github</a></li>
<li class="chapter" data-level="1.3.2" data-path="tools.html"><a href="tools.html#getting-set-up-git"><i class="fa fa-check"></i><b>1.3.2</b> Getting set up: git</a></li>
<li class="chapter" data-level="1.3.3" data-path="tools.html"><a href="tools.html#introduce-yourself-to-git"><i class="fa fa-check"></i><b>1.3.3</b> Introduce yourself to git</a></li>
<li class="chapter" data-level="1.3.4" data-path="tools.html"><a href="tools.html#optional-install-a-git-client"><i class="fa fa-check"></i><b>1.3.4</b> Optional: Install a git client</a></li>
<li class="chapter" data-level="1.3.5" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>1.3.5</b> Git and Github</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="tools.html"><a href="tools.html#easy-extra-setup-script"><i class="fa fa-check"></i><b>1.4</b> Easy Extra Setup Script</a></li>
<li class="chapter" data-level="1.5" data-path="tools.html"><a href="tools.html#latex"><i class="fa fa-check"></i><b>1.5</b> LaTeX</a></li>
<li class="chapter" data-level="1.6" data-path="tools.html"><a href="tools.html#topic-sequencing"><i class="fa fa-check"></i><b>1.6</b> Topic Sequencing</a></li>
<li class="chapter" data-level="1.7" data-path="tools.html"><a href="tools.html#using-version-control"><i class="fa fa-check"></i><b>1.7</b> Using Version Control</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-prog.html"><a href="intro-prog.html"><i class="fa fa-check"></i><b>2</b> Introduction to Statistical Programming</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#definitions"><i class="fa fa-check"></i>Definitions</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#statistical-programming-languages"><i class="fa fa-check"></i>Statistical Programming Languages</a></li>
<li class="chapter" data-level="2.1" data-path="intro-prog.html"><a href="intro-prog.html#variable-types"><i class="fa fa-check"></i><b>2.1</b> Variable types</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro-prog.html"><a href="intro-prog.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="tools.html"><a href="tools.html#sas"><i class="fa fa-check"></i><b>2.1.2</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro-prog.html"><a href="intro-prog.html#data-structures"><i class="fa fa-check"></i><b>2.2</b> Data structures</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro-prog.html"><a href="intro-prog.html#homogeneous-data-structures-r-and-sas"><i class="fa fa-check"></i><b>2.2.1</b> Homogeneous data structures (R and SAS)</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro-prog.html"><a href="intro-prog.html#heterogeneous-data-structures"><i class="fa fa-check"></i><b>2.2.2</b> Heterogeneous data structures</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro-prog.html"><a href="intro-prog.html#indexing"><i class="fa fa-check"></i><b>2.2.3</b> Indexing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro-prog.html"><a href="intro-prog.html#control-structures"><i class="fa fa-check"></i><b>2.3</b> Control structures</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro-prog.html"><a href="intro-prog.html#if-statements"><i class="fa fa-check"></i><b>2.3.1</b> If statements</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro-prog.html"><a href="intro-prog.html#loops"><i class="fa fa-check"></i><b>2.3.2</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro-prog.html"><a href="intro-prog.html#overgrown-calculators"><i class="fa fa-check"></i><b>2.4</b> Overgrown Calculators</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#references-and-links"><i class="fa fa-check"></i>References and Links</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organization.html"><a href="organization.html"><i class="fa fa-check"></i><b>3</b> Organization: Packages, Functions, Scripts, and Documents</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="3.1" data-path="organization.html"><a href="organization.html#reproducibility"><i class="fa fa-check"></i><b>3.1</b> Reproducibility</a><ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#reproducibility-references-and-reading"><i class="fa fa-check"></i>Reproducibility References and Reading</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="organization.html"><a href="organization.html#markdown"><i class="fa fa-check"></i><b>3.2</b> Markdown</a><ul>
<li class="chapter" data-level="3.2.1" data-path="organization.html"><a href="organization.html#rmarkdown-with-sas"><i class="fa fa-check"></i><b>3.2.1</b> Rmarkdown with… SAS?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="organization.html"><a href="organization.html#functions-and-modules"><i class="fa fa-check"></i><b>3.3</b> Functions and Modules</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out"><i class="fa fa-check"></i>Try it out</a></li>
<li class="chapter" data-level="3.3.1" data-path="organization.html"><a href="organization.html#scope"><i class="fa fa-check"></i><b>3.3.1</b> Scope</a></li>
<li class="chapter" data-level="3.3.2" data-path="organization.html"><a href="organization.html#the-pipe"><i class="fa fa-check"></i><b>3.3.2</b> The Pipe</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="organization.html"><a href="organization.html#procs-and-data-steps"><i class="fa fa-check"></i><b>3.4</b> Procs and Data steps</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-2"><i class="fa fa-check"></i>Try It Out</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="organization.html"><a href="organization.html#scripts"><i class="fa fa-check"></i><b>3.5</b> Scripts</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-3"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="organization.html"><a href="organization.html#packages"><i class="fa fa-check"></i><b>3.6</b> Packages</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-4"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#references-and-links"><i class="fa fa-check"></i>References and Links</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>4</b> External Data</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="4.1" data-path="reading-data.html"><a href="reading-data.html#external-data-formats"><i class="fa fa-check"></i><b>4.1</b> External Data Formats</a></li>
<li class="chapter" data-level="4.2" data-path="reading-data.html"><a href="reading-data.html#text-files"><i class="fa fa-check"></i><b>4.2</b> Text Files</a><ul>
<li class="chapter" data-level="4.2.1" data-path="reading-data.html"><a href="reading-data.html#fixed-width-files"><i class="fa fa-check"></i><b>4.2.1</b> Fixed-width files</a></li>
<li class="chapter" data-level="4.2.2" data-path="reading-data.html"><a href="reading-data.html#delimited-text-files"><i class="fa fa-check"></i><b>4.2.2</b> Delimited Text Files</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-data.html"><a href="reading-data.html#spreadsheets"><i class="fa fa-check"></i><b>4.3</b> Spreadsheets</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-1"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="reading-data.html"><a href="reading-data.html#binary-files"><i class="fa fa-check"></i><b>4.4</b> Binary Files</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-2"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="reading-data.html"><a href="reading-data.html#databases"><i class="fa fa-check"></i><b>4.5</b> Databases</a><ul>
<li class="chapter" data-level="4.5.1" data-path="reading-data.html"><a href="reading-data.html#microsoft-access"><i class="fa fa-check"></i><b>4.5.1</b> Microsoft Access</a></li>
<li class="chapter" data-level="4.5.2" data-path="reading-data.html"><a href="reading-data.html#sqlite"><i class="fa fa-check"></i><b>4.5.2</b> SQLite</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="reading-data.html"><a href="reading-data.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>4.6</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="4.6.1" data-path="tools.html"><a href="tools.html#sas"><i class="fa fa-check"></i><b>4.6.1</b> SAS</a></li>
<li class="chapter" data-level="4.6.2" data-path="intro-prog.html"><a href="intro-prog.html#r"><i class="fa fa-check"></i><b>4.6.2</b> R</a></li>
<li class="chapter" data-level="4.6.3" data-path="reading-data.html"><a href="reading-data.html#comparison"><i class="fa fa-check"></i><b>4.6.3</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="reading-data.html"><a href="reading-data.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-data.html"><a href="manipulating-data.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="5.1" data-path="manipulating-data.html"><a href="manipulating-data.html#tidy-data"><i class="fa fa-check"></i><b>5.1</b> Tidy Data</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data.html"><a href="manipulating-data.html#filter-pick-cases-rows-based-on-their-values"><i class="fa fa-check"></i><b>5.2</b> Filter: Pick cases (rows) based on their values</a><ul>
<li class="chapter" data-level="5.2.1" data-path="manipulating-data.html"><a href="manipulating-data.html#common-filter-tasks"><i class="fa fa-check"></i><b>5.2.1</b> Common Filter() Tasks</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data.html"><a href="manipulating-data.html#select-pick-columns"><i class="fa fa-check"></i><b>5.3</b> Select: Pick columns</a></li>
<li class="chapter" data-level="5.4" data-path="manipulating-data.html"><a href="manipulating-data.html#mutate-add-and-transform-variables"><i class="fa fa-check"></i><b>5.4</b> Mutate: Add and transform variables</a></li>
<li class="chapter" data-level="5.5" data-path="manipulating-data.html"><a href="manipulating-data.html#summarize"><i class="fa fa-check"></i><b>5.5</b> Summarize</a></li>
<li class="chapter" data-level="5.6" data-path="manipulating-data.html"><a href="manipulating-data.html#group-by-power"><i class="fa fa-check"></i><b>5.6</b> Group By + (?) = Power!</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-1"><i class="fa fa-check"></i>Try it out</a></li>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>6</b> Transforming Data</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="6.1" data-path="transforming-data.html"><a href="transforming-data.html#identifying-the-problem-messy-data"><i class="fa fa-check"></i><b>6.1</b> Identifying the problem: Messy data</a><ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="transforming-data.html"><a href="transforming-data.html#string-operations-creating-new-variables-and-separating-multi-variable-columns"><i class="fa fa-check"></i><b>6.2</b> String operations: Creating new variables and separating multi-variable columns</a><ul>
<li class="chapter" data-level="6.2.1" data-path="transforming-data.html"><a href="transforming-data.html#basic-string-operations"><i class="fa fa-check"></i><b>6.2.1</b> Basic String Operations</a></li>
<li class="chapter" data-level="6.2.2" data-path="transforming-data.html"><a href="transforming-data.html#regular-expressions"><i class="fa fa-check"></i><b>6.2.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="6.2.3" data-path="transforming-data.html"><a href="transforming-data.html#joining-and-splitting-variables"><i class="fa fa-check"></i><b>6.2.3</b> Joining and Splitting Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="transforming-data.html"><a href="transforming-data.html#pivot-operations"><i class="fa fa-check"></i><b>6.3</b> Pivot operations</a><ul>
<li class="chapter" data-level="6.3.1" data-path="transforming-data.html"><a href="transforming-data.html#longer"><i class="fa fa-check"></i><b>6.3.1</b> Longer</a></li>
<li class="chapter" data-level="6.3.2" data-path="transforming-data.html"><a href="transforming-data.html#wider"><i class="fa fa-check"></i><b>6.3.2</b> Wider</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="transforming-data.html"><a href="transforming-data.html#relational-data-and-joining-tables"><i class="fa fa-check"></i><b>6.4</b> Relational Data and Joining Tables</a><ul>
<li class="chapter" data-level="6.4.1" data-path="transforming-data.html"><a href="transforming-data.html#demonstration-dataset-setup"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration dataset setup</a></li>
<li class="chapter" data-level="6.4.2" data-path="transforming-data.html"><a href="transforming-data.html#mutating-joins"><i class="fa fa-check"></i><b>6.4.2</b> Mutating joins</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>7</b> Principles of Debugging</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="7.1" data-path="debugging.html"><a href="debugging.html#defensive-programming"><i class="fa fa-check"></i><b>7.1</b> Defensive Programming</a></li>
<li class="chapter" data-level="7.2" data-path="debugging.html"><a href="debugging.html#general-debugging-strategies"><i class="fa fa-check"></i><b>7.2</b> General Debugging Strategies</a></li>
<li class="chapter" data-level="7.3" data-path="debugging.html"><a href="debugging.html#debugging-tools-in-r"><i class="fa fa-check"></i><b>7.3</b> Debugging Tools in R</a><ul>
<li class="chapter" data-level="7.3.1" data-path="debugging.html"><a href="debugging.html#low-tech-debugging-with-print-and-other-tools"><i class="fa fa-check"></i><b>7.3.1</b> Low tech debugging with print() and other tools</a></li>
<li class="chapter" data-level="7.3.2" data-path="debugging.html"><a href="debugging.html#after-an-error-has-occurred---traceback"><i class="fa fa-check"></i><b>7.3.2</b> After an error has occurred - <code>traceback()</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="debugging.html"><a href="debugging.html#browser---debugging-your-own-code-interactively"><i class="fa fa-check"></i><b>7.3.3</b> <code>browser()</code> - debugging your own code, interactively</a></li>
<li class="chapter" data-level="7.3.4" data-path="debugging.html"><a href="debugging.html#debug---the-general-debugging-workhorse"><i class="fa fa-check"></i><b>7.3.4</b> <code>debug()</code> - the general debugging workhorse</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#try-it-out-1"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="debugging.html"><a href="debugging.html#debugging-tools-in-sas"><i class="fa fa-check"></i><b>7.4</b> Debugging Tools in SAS</a></li>
<li class="chapter" data-level="7.5" data-path="debugging.html"><a href="debugging.html#minimal-working-examples"><i class="fa fa-check"></i><b>7.5</b> Minimal Working Examples</a></li>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-vis-intro.html"><a href="data-vis-intro.html"><i class="fa fa-check"></i><b>8</b> Introduction to Data Visualization</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="8.1" data-path="data-vis-intro.html"><a href="data-vis-intro.html#creating-charts-in-sas"><i class="fa fa-check"></i><b>8.1</b> Creating Charts in SAS</a></li>
<li class="chapter" data-level="8.2" data-path="data-vis-intro.html"><a href="data-vis-intro.html#creating-charts-in-r-base"><i class="fa fa-check"></i><b>8.2</b> Creating Charts in R (base)</a></li>
<li class="chapter" data-level="8.3" data-path="data-vis-intro.html"><a href="data-vis-intro.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>8.3</b> The Grammar of Graphics</a></li>
<li class="chapter" data-level="8.4" data-path="data-vis-intro.html"><a href="data-vis-intro.html#good-charts"><i class="fa fa-check"></i><b>8.4</b> Good charts</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>9</b> Introduction to Data Analysis</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="9.1" data-path="data-analysis.html"><a href="data-analysis.html#models-in-sas"><i class="fa fa-check"></i><b>9.1</b> Models in SAS</a></li>
<li class="chapter" data-level="9.2" data-path="data-analysis.html"><a href="data-analysis.html#models-in-r"><i class="fa fa-check"></i><b>9.2</b> Models in R</a><ul>
<li class="chapter" data-level="9.2.1" data-path="data-analysis.html"><a href="data-analysis.html#standard-models"><i class="fa fa-check"></i><b>9.2.1</b> Standard Models</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-analysis.html"><a href="data-analysis.html#tidymodels"><i class="fa fa-check"></i><b>9.2.2</b> Tidymodels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>10</b> Simulation and Reproducibility</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="10.1" data-path="simulation.html"><a href="simulation.html#pseudorandom-number-generation"><i class="fa fa-check"></i><b>10.1</b> Pseudorandom Number Generation</a></li>
<li class="chapter" data-level="10.2" data-path="simulation.html"><a href="simulation.html#random-number-generation-and-reproducibility"><i class="fa fa-check"></i><b>10.2</b> Random Number Generation and Reproducibility</a><ul>
<li class="chapter" data-level="10.2.1" data-path="simulation.html"><a href="simulation.html#seeds"><i class="fa fa-check"></i><b>10.2.1</b> Seeds</a></li>
<li class="chapter" data-level="10.2.2" data-path="simulation.html"><a href="simulation.html#rmarkdown-reproducibility"><i class="fa fa-check"></i><b>10.2.2</b> Rmarkdown Reproducibility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="docs-reports.html"><a href="docs-reports.html"><i class="fa fa-check"></i><b>11</b> Documents and Reports</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-objectives"><i class="fa fa-check"></i>Module Objectives</a></li>
<li class="chapter" data-level="11.1" data-path="docs-reports.html"><a href="docs-reports.html#slides"><i class="fa fa-check"></i><b>11.1</b> Slides</a><ul>
<li class="chapter" data-level="11.1.1" data-path="docs-reports.html"><a href="docs-reports.html#beamer-latex-and-knitr"><i class="fa fa-check"></i><b>11.1.1</b> Beamer (LaTeX) and knitr</a></li>
<li class="chapter" data-level="11.1.2" data-path="docs-reports.html"><a href="docs-reports.html#xaringan"><i class="fa fa-check"></i><b>11.1.2</b> xaringan</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="docs-reports.html"><a href="docs-reports.html#posters"><i class="fa fa-check"></i><b>11.2</b> Posters</a><ul>
<li class="chapter" data-level="11.2.1" data-path="docs-reports.html"><a href="docs-reports.html#beamer-latex-and-knitr-1"><i class="fa fa-check"></i><b>11.2.1</b> Beamer (LaTeX) and knitr</a></li>
<li class="chapter" data-level="11.2.2" data-path="docs-reports.html"><a href="docs-reports.html#pagedown"><i class="fa fa-check"></i><b>11.2.2</b> Pagedown</a></li>
<li class="chapter" data-level="11.2.3" data-path="docs-reports.html"><a href="docs-reports.html#xaringan-1"><i class="fa fa-check"></i><b>11.2.3</b> xaringan</a></li>
<li class="chapter" data-level="11.2.4" data-path="docs-reports.html"><a href="docs-reports.html#pagedown-1"><i class="fa fa-check"></i><b>11.2.4</b> pagedown</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="docs-reports.html"><a href="docs-reports.html#other-options"><i class="fa fa-check"></i><b>11.3</b> Other options</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="presentations.html"><a href="presentations.html"><i class="fa fa-check"></i><b>12</b> Dynamic Presentations</a><ul>
<li class="chapter" data-level="12.1" data-path="docs-reports.html"><a href="docs-reports.html#slides"><i class="fa fa-check"></i><b>12.1</b> Slides</a><ul>
<li class="chapter" data-level="12.1.1" data-path="docs-reports.html"><a href="docs-reports.html#beamer-latex-and-knitr"><i class="fa fa-check"></i><b>12.1.1</b> Beamer (LaTeX) and knitr</a></li>
<li class="chapter" data-level="12.1.2" data-path="docs-reports.html"><a href="docs-reports.html#xaringan"><i class="fa fa-check"></i><b>12.1.2</b> xaringan</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="docs-reports.html"><a href="docs-reports.html#posters"><i class="fa fa-check"></i><b>12.2</b> Posters</a><ul>
<li class="chapter" data-level="12.2.1" data-path="docs-reports.html"><a href="docs-reports.html#beamer-latex-and-knitr-1"><i class="fa fa-check"></i><b>12.2.1</b> Beamer (LaTeX) and knitr</a></li>
<li class="chapter" data-level="12.2.2" data-path="docs-reports.html"><a href="docs-reports.html#pagedown"><i class="fa fa-check"></i><b>12.2.2</b> Pagedown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat 850: Computing Tools for Statisticians</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="debugging" class="section level1">
<h1><span class="header-section-number">Module 7</span> Principles of Debugging</h1>
<div id="module-objectives" class="section level2 unnumbered">
<h2>Module Objectives</h2>
<ul>
<li><p>Break down a complex procedure into simpler steps, mapping each step to a separate function which performs a single task.</p></li>
<li><p>Simplify a problem to the minimal components necessary to reproduce the error, and use that information to ask for help appropriately.</p></li>
<li><p>Use built-in debugging tools to trace an error to its source</p></li>
<li><p>Use online forums and mailing lists to research error messages</p></li>
</ul>
<p>Note: The skills in this chapter take a lifetime to truly master. The real goal here is that you know how to ask for help appropriately (and in a way that people will respond positively to) and that you know how to do the research to get help yourself.</p>
<div class="figure">
<img src="https://imgs.xkcd.com/comics/inexplicable.png" alt="“It has a ghost in it. Take it back.” “No.” (xkcd #1316)" />
<p class="caption">“It has a ghost in it. Take it back.” “No.” (xkcd #1316)</p>
</div>
</div>
<div id="defensive-programming" class="section level2">
<h2><span class="header-section-number">7.1</span> Defensive Programming</h2>
<p>One of the best debugging strategies (that isn’t a debugging strategy at all, really) is to code defensively. By that, I mean, code in a way that you will make debugging things easier later.</p>
<ul>
<li><p><strong>Modularize your code</strong>. Each function should do only one task, ideally in the least-complex way possible.</p></li>
<li><p><strong>Make your code readable</strong>. If you can read the code easily, you’ll be able to narrow down the location of the bug more quickly.</p></li>
<li><p><strong>Comment your code</strong>. This makes it more likely that you will be able to locate the spot where the bug is likely to have occurred, and will remind you how things are calculated. Remember, comments aren’t just for your collaborators or others who see the code. They’re for future you.</p></li>
<li><p><strong>Don’t duplicate code</strong>. If you have the same code (or essentially the same code) in two or three different places, put that code in a function and call the function instead. This will save you trouble when updating the code in the future, but also makes narrowing down the source of the bug less complex.</p></li>
<li><p><strong>Reduce the number of dependencies</strong> you have on outside software packages. Often bugs are introduced when a dependency is updated and the functionality changes slightly. The <code>tidyverse</code> is <em>notorious</em> for this.<br />
It’s ok to write code using lots of dependencies, but as you transition from “experimental” code to “production” code (you’re using the code without tinkering with it) you should work to reduce the dependencies.</p></li>
<li><p><strong>Add safeguards against unexpected inputs</strong>. Check to make sure inputs to the function are valid. Check to make sure intermediate results are reasonable (e.g. you don’t compute the derivative of a function and come up with “a”.)</p></li>
<li><p><strong>Don’t reinvent the wheel</strong>. If you have working, tested code for a task, use that! If someone else has working code that’s used by the community, don’t write your own unless you have a very good reason. The implementation of <code>lm</code> has been better tested than your homegrown linear regression.<br />
(This is easier if you’re writing modular code to begin with)</p></li>
<li><p>Collect your often-reused code in packages (R) or scripts (SAS) that you can easily load and make available to “future you”</p></li>
</ul>
<div class="learn-more">
<p>Wikipedia’s article on defensive programming is much more general than the applications to statistical programming, but may be <a href="https://en.wikipedia.org/wiki/Defensive_programming">worth scanning</a>.</p>
</div>
</div>
<div id="general-debugging-strategies" class="section level2">
<h2><span class="header-section-number">7.2</span> General Debugging Strategies</h2>
<blockquote>
<p>Debugging: Being the detective in a crime movie where you are also the murderer. - some t-shirt I saw once</p>
</blockquote>
<p>While defensive programming is a nice idea, if you’re already at the point where you have an error you can’t diagnose, then… it doesn’t help that much. At that point, you’ll need some general debugging strategies to work with. The overall process is well described in <a href="https://adv-r.hadley.nz/debugging.html">Advanced R</a> by H. Wickham<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>; I’ve copied it here because it’s such a succinct distillation of the process, but I’ve adapted some of the explanations to this class rather than the original c ontext of package development.</p>
<ol start="0" style="list-style-type: decimal">
<li><p>Realize that you have a bug</p></li>
<li><p><strong>Google!</strong> In R you can automate this with the <code>errorist</code> and <code>searcher</code> packages. In SAS, if the error message isn’t that clear you’ll find a SAS forum page where someone else has made the same mistake - I can almost guarantee it.</p></li>
<li><strong>Make the error repeatable</strong>: This makes it easier to figure out what the error is, faster to iterate, and easier to ask for help.
<ul>
<li>Use binary search (remove 1/2 of the code, see if the error occurs, if not go to the other 1/2 of the code. Repeat until you’ve isolated the error.)</li>
<li>Generate the error faster - use a minimal test dataset, if possible, so that you can ask for help easily and run code faster. This is worth the investment if you’ve been debugging the same error for a while.</li>
<li>Note which inputs <em>don’t</em> generate the bug – this negative “data” is helpful when asking for help.</li>
</ul></li>
<li><p><strong>Figure out where it is</strong>. Debuggers may help with this, but you can also use the <a href="http://web.mit.edu/6.031/www/fa17/classes/13-debugging/#find_the_bug_using_the_scientific_method">scientific method</a> to explore the code, or the tried-and-true method of using lots of <code>print()</code> statements.</p></li>
<li><p><strong>Fix it and test it</strong>. The goal with tests is to ensure that the same error doesn’t pop back up in a future version of your code. Generate an example that will test for the error, and add it to your documentation. If you’re developing a package, unit test suites offer a more formalized way to test errors and you can automate your testing so that every time your code is changed, tests are run and checked.</p></li>
</ol>
<p>There are several other general strategies for debugging:</p>
<ul>
<li><p>Visualize your data as it moves through the program. This may be done using <code>print()</code> statements, or the debugger, or some other strategy depending on your application.</p></li>
<li><p>Tracing statements. Again, this is part of <code>print()</code> debugging, but these messages indicate progress - “got into function x”, “returning from function y”, and so on.</p></li>
<li><p>Rubber ducking. Have you ever tried to explain a problem you’re having to someone else, only to have a moment of insight and “oh, nevermind”? Rubber ducking outsources the problem to a nonjudgemental entity, such as a rubber duck<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. You simply explain, in terms simple enough for your rubber duck to understand, exactly what your code does, line by line, until you’ve found the problem. <a href="https://gitduck.com/blog/improve-how-to-code-with-rubber-duck-debugging/">A more thorough explanation can be found at gitduck.com</a>.</p></li>
</ul>
<div class="figure"><span id="fig:duck-cape"></span>
<img src="image/rubber_duck_cape.png" alt="You may find it helpful to procure a rubber duck expert for each language you work in. I use color-your-own rubber ducks to endow my ducks with certain language expertise. Other people use plain rubber ducks and give them capes." width="50%" />
<p class="caption">
Figure 7.1: You may find it helpful to procure a rubber duck expert for each language you work in. I use color-your-own rubber ducks to endow my ducks with certain language expertise. Other people use plain rubber ducks and give them capes.
</p>
</div>
<p>Do not be surprised if, in the process of debugging, you encounter new bugs. This is a problem that’s well-known enough that it has its <a href="image/99bugs_shirt.png">own t-shirt</a>, in addition to an <a href="https://xkcd.com/1739/">xkcd comic</a>. At some point, getting up and going for a walk may help. Redesigning your code to be more modular and more organized is also a good idea.</p>
</div>
<div id="debugging-tools-in-r" class="section level2">
<h2><span class="header-section-number">7.3</span> Debugging Tools in R</h2>
<p>Now that we’ve discussed general strategies for debugging that will work in any language, lets get down to the dirty details of debugging in R.</p>
<div id="low-tech-debugging-with-print-and-other-tools" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Low tech debugging with print() and other tools</h3>
<p>Sometimes called “tracing” techniques, the most common, universal, and low tech strategy for debugging involves scattering messages throughout your code. When the code is executed, you get a window into what the variables look like during execution.</p>
<details>
<p><summary>Simple example</summary>
Imagine we start with this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  b &lt;-<span class="st"> </span><span class="cf">function</span>(y) {</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">    c &lt;-<span class="st"> </span><span class="cf">function</span>(z) {</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">      z <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    }</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="kw">c</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  }</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  x <span class="op">+</span><span class="st"> </span><span class="kw">b</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">a</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 12</code></pre>
<p>and the goal is to understand what’s happening in the code. We might add some lines:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Entering a(). x = &quot;</span>, x))</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  b &lt;-<span class="st"> </span><span class="cf">function</span>(y) {</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Entering b(). x = &quot;</span>, x, <span class="st">&quot;y = &quot;</span>, y))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    c &lt;-<span class="st"> </span><span class="cf">function</span>(z) {</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">      <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Entering c(). x = &quot;</span>, x, <span class="st">&quot;y = &quot;</span>, y, <span class="st">&quot;z = &quot;</span>, z))</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">      cres &lt;-<span class="st"> </span>z <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">      <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Returning&quot;</span>, cres, <span class="st">&quot;from c()&quot;</span>))</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">      cres</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    }</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    bres &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Returning&quot;</span>, bres, <span class="st">&quot;from b()&quot;</span>))</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">    bres</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  }</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  ares &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">b</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Returning&quot;</span>,ares, <span class="st">&quot;from a()&quot;</span>))</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  ares</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="kw">a</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] &quot;Entering a(). x =  5&quot;
## [1] &quot;Entering b(). x =  5 y =  4&quot;
## [1] &quot;Entering c(). x =  5 y =  4 z =  3&quot;
## [1] &quot;Returning 7 from c()&quot;
## [1] &quot;Returning 7 from b()&quot;
## [1] &quot;Returning 12 from a()&quot;</code></pre>
<pre><code>## [1] 12</code></pre>
</details>
<p>For more complex data structures, it can be useful to add <code>str()</code>, <code>head()</code>, or <code>summary()</code> functions.</p>
<details>
<p><summary>Real world example</summary>
I was recently writing a webscraper to get election polling data from the RealClearPolitics site as part of the <a href="github.com/heike/electionViz"><code>electionViz</code> package</a>. I wrote the function <code>search_for_parent()</code> to get the parent HTML tag which matched the “tag” argument, that had the “node” argument as a descendant.</p>
<p>I was assuming that the order of the parents would be “html”, “body”, “div”, “table”, “tbody”, “tr” - descending from outer to inner (if you know anything about HTML/XML structure).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(xml2) <span class="co"># read html</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">search_for_parent &lt;-<span class="st"> </span><span class="cf">function</span>(node, tag) {</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="co"># Get all of the parent nodes </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  parents &lt;-<span class="st"> </span>xml2<span class="op">::</span><span class="kw">xml_parents</span>(node)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="co"># Get the tags of every parent node</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  tags &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map_chr</span>(parents, rvest<span class="op">::</span>html_name)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="kw">print</span>(tags)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="co"># Find matching taggs</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  matches &lt;-<span class="st"> </span><span class="kw">which</span>(tags <span class="op">==</span><span class="st"> </span>tag)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="kw">print</span>(matches)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  <span class="co"># Take the minimum matching tag</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  min_match &lt;-<span class="st"> </span><span class="kw">min</span>(matches)</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  <span class="cf">if</span> (<span class="kw">length</span>(matches) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">return</span>(parents[min_match]) <span class="cf">else</span> <span class="kw">return</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb6-18" data-line-number="18"></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">page &lt;-<span class="st"> </span><span class="kw">read_html</span>(<span class="st">&quot;data/realclearpolitics_frag.html&quot;</span>)</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">node &lt;-<span class="st"> </span><span class="kw">xml_find_all</span>(page, <span class="st">&quot;//td[@class=&#39;lp-results&#39;]&quot;</span>) <span class="co"># find all poll results in any table</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="kw">search_for_parent</span>(node[<span class="dv">1</span>], <span class="st">&quot;table&quot;</span>) <span class="co"># find the table that contains it</span></a></code></pre></div>
<pre><code>## [1] &quot;tr&quot;    &quot;tbody&quot; &quot;table&quot; &quot;div&quot;   &quot;body&quot;  &quot;html&quot; 
## [1] 3</code></pre>
<pre><code>## {xml_nodeset (1)}
## [1] &lt;table cellpadding=&quot;2&quot; cellspacing=&quot;0&quot; class=&quot;sortable&quot;&gt;\n&lt;thead&gt;&lt;tr clas ...</code></pre>
By printing out all of the tags that contain <code>node</code>, I could see the order – inner to outer. I asked the function to return the location of the first table node, so the index (2nd value printed out) should match table in the character vector that was printed out first. I could then see that the HTML node that is returned is in fact the table node.
</details>
<div id="try-it-out" class="section level4 unnumbered tryitout">
<h4>Try it out</h4>
<p>Not all bugs result in error messages, unfortunately, which makes higher-level techniques like <code>traceback()</code> less useful. The low-tech debugging tools, however, still work wonderfully.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">worldmap &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;world&quot;</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co"># Load the data</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw">data</span>(storms, <span class="dt">package =</span> <span class="st">&quot;dplyr&quot;</span>)</a></code></pre></div>
<p>The code below is supposed to print out a map of the tracks of all hurricanes of a specific category, 1 to 5, in 2013. Use print statements to figure out what’s wrong with my code.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Make base map to be used for each iteration</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">basemap &lt;-<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="co"># Country shapes</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">               <span class="dt">data =</span> worldmap, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">  </span><span class="co"># Zoom in </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_quickmap</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-10</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">  </span><span class="co"># Don&#39;t need scales b/c maps provide their own geographic context...</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_map</span>()</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">  <span class="co"># Subset the data</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13">  subdata &lt;-<span class="st"> </span>storms <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2013</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">    </span><span class="kw">filter</span>(status <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb10-17" data-line-number="17">  <span class="co"># Plot the data - path + points to show the observations</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18">  plot &lt;-<span class="st"> </span>basemap <span class="op">+</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="st">    </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms in 2013&quot;</span>))</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">  <span class="kw">print</span>(plot)</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">}</a></code></pre></div>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-4-1.png" width="18%" /><img src="unl-stat850_files/figure-html/unnamed-chunk-4-2.png" width="18%" /><img src="unl-stat850_files/figure-html/unnamed-chunk-4-3.png" width="18%" /><img src="unl-stat850_files/figure-html/unnamed-chunk-4-4.png" width="18%" /><img src="unl-stat850_files/figure-html/unnamed-chunk-4-5.png" width="18%" /></p>
<details>
<p><summary>Solution</summary>
First, lets split the setup from the loop.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Make base map to be used for each iteration</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">basemap &lt;-<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="co"># Country shapes</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">               <span class="dt">data =</span> worldmap, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="co"># Zoom in </span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_quickmap</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-10</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="co"># Don&#39;t need scales b/c maps provide their own geographic context...</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_map</span>()</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="kw">print</span>(basemap) <span class="co"># make sure the basemap is fine</span></a></code></pre></div>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Load the data</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">data</span>(storms, <span class="dt">package =</span> <span class="st">&quot;dplyr&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">str</span>(storms) <span class="co"># make sure the data exists and is formatted as expected</span></a></code></pre></div>
<pre><code>## tibble [10,010 × 13] (S3: tbl_df/tbl/data.frame)
##  $ name       : chr [1:10010] &quot;Amy&quot; &quot;Amy&quot; &quot;Amy&quot; &quot;Amy&quot; ...
##  $ year       : num [1:10010] 1975 1975 1975 1975 1975 ...
##  $ month      : num [1:10010] 6 6 6 6 6 6 6 6 6 6 ...
##  $ day        : int [1:10010] 27 27 27 27 28 28 28 28 29 29 ...
##  $ hour       : num [1:10010] 0 6 12 18 0 6 12 18 0 6 ...
##  $ lat        : num [1:10010] 27.5 28.5 29.5 30.5 31.5 32.4 33.3 34 34.4 34 ...
##  $ long       : num [1:10010] -79 -79 -79 -79 -78.8 -78.7 -78 -77 -75.8 -74.8 ...
##  $ status     : chr [1:10010] &quot;tropical depression&quot; &quot;tropical depression&quot; &quot;tropical depression&quot; &quot;tropical depression&quot; ...
##  $ category   : Ord.factor w/ 7 levels &quot;-1&quot;&lt;&quot;0&quot;&lt;&quot;1&quot;&lt;&quot;2&quot;&lt;..: 1 1 1 1 1 1 1 1 2 2 ...
##  $ wind       : int [1:10010] 25 25 25 25 25 25 25 30 35 40 ...
##  $ pressure   : int [1:10010] 1013 1013 1013 1013 1012 1012 1011 1006 1004 1002 ...
##  $ ts_diameter: num [1:10010] NA NA NA NA NA NA NA NA NA NA ...
##  $ hu_diameter: num [1:10010] NA NA NA NA NA NA NA NA NA NA ...</code></pre>
<p>Everything looks ok in the setup chunk…</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms&quot;</span>))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="co"># Subset the data</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  subdata &lt;-<span class="st"> </span>storms <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2013</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st">    </span><span class="kw">filter</span>(status <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;subdata dims: nrow &quot;</span>, <span class="kw">nrow</span>(subdata), <span class="st">&quot; ncol &quot;</span>, <span class="kw">ncol</span>(subdata)))</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">        <span class="co"># str(subdata) works too, but produces more clutter. I started</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">        <span class="co"># with str() and moved to dim() when I saw the problem</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb14-12" data-line-number="12">  <span class="co"># Plot the data - path + points to show the observations</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">  plot &lt;-<span class="st"> </span>basemap <span class="op">+</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms in 2013&quot;</span>))</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">  <span class="co"># print(plot) # Don&#39;t print plots - clutters up output at the moment</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18">}</a></code></pre></div>
<pre><code>## [1] &quot;Category 1 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 2 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 3 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 4 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 5 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;</code></pre>
<p>Ok, so from this we can see that something is going wrong with our filter statement - we have no rows of data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">head</span>(storms)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 13
##   name   year month   day  hour   lat  long status category  wind pressure
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;ord&gt;    &lt;int&gt;    &lt;int&gt;
## 1 Amy    1975     6    27     0  27.5 -79   tropi… -1          25     1013
## 2 Amy    1975     6    27     6  28.5 -79   tropi… -1          25     1013
## 3 Amy    1975     6    27    12  29.5 -79   tropi… -1          25     1013
## 4 Amy    1975     6    27    18  30.5 -79   tropi… -1          25     1013
## 5 Amy    1975     6    28     0  31.5 -78.8 tropi… -1          25     1012
## 6 Amy    1975     6    28     6  32.4 -78.7 tropi… -1          25     1012
## # … with 2 more variables: ts_diameter &lt;dbl&gt;, hu_diameter &lt;dbl&gt;</code></pre>
<p>Whoops. I meant “category” when I typed “status”.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms&quot;</span>))</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="co"># Subset the data</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  subdata &lt;-<span class="st"> </span>storms <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2013</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="st">    </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb18-8" data-line-number="8">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;subdata dims: nrow &quot;</span>, <span class="kw">nrow</span>(subdata), <span class="st">&quot; ncol &quot;</span>, <span class="kw">ncol</span>(subdata)))</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">        <span class="co"># str(subdata) works too, but produces more clutter. I started</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10">        <span class="co"># with str() and moved to dim() when I saw the problem</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb18-12" data-line-number="12">  <span class="co"># Plot the data - path + points to show the observations</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13">  plot &lt;-<span class="st"> </span>basemap <span class="op">+</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms in 2013&quot;</span>))</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">  <span class="co"># print(plot) # Don&#39;t print plots - clutters up output at the moment</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18">}</a></code></pre></div>
<pre><code>## [1] &quot;Category 1 storms&quot;
## [1] &quot;subdata dims: nrow 13 ncol 13&quot;
## [1] &quot;Category 2 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 3 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 4 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;
## [1] &quot;Category 5 storms&quot;
## [1] &quot;subdata dims: nrow 0 ncol 13&quot;</code></pre>
<p>Ok, that’s something, at least. We now have some data for category 1 storms…</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">filter</span>(storms, year <span class="op">==</span><span class="st"> </span><span class="dv">2013</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="co"># Get max category for each named storm</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(category)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">  </span><span class="co"># See what categories exist</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(name, category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="st">  </span><span class="kw">unique</span>()</a></code></pre></div>
<pre><code>## # A tibble: 14 x 2
##    name      category
##    &lt;chr&gt;     &lt;ord&gt;   
##  1 Andrea    0       
##  2 Barry     0       
##  3 Chantal   0       
##  4 Dorian    0       
##  5 Erin      0       
##  6 Fernand   0       
##  7 Gabrielle 0       
##  8 Eight     -1      
##  9 Humberto  1       
## 10 Ingrid    1       
## 11 Jerry     0       
## 12 Karen     0       
## 13 Lorenzo   0       
## 14 Melissa   0</code></pre>
<p>It looks like 2013 was just an incredibly quiet year for tropical activity.</p>
<p>2004, however, was not. So let’s just make sure our code works by checking out 2004.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms&quot;</span>))</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">  <span class="co"># Subset the data</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  subdata &lt;-<span class="st"> </span>storms <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2004</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">    </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb22-8" data-line-number="8">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;subdata dims: nrow &quot;</span>, <span class="kw">nrow</span>(subdata), <span class="st">&quot; ncol &quot;</span>, <span class="kw">ncol</span>(subdata)))</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">        <span class="co"># str(subdata) works too, but produces more clutter. I started</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10">        <span class="co"># with str() and moved to dim() when I saw the problem</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb22-12" data-line-number="12">  <span class="co"># Plot the data - path + points to show the observations</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13">  plot &lt;-<span class="st"> </span>basemap <span class="op">+</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms in 2013&quot;</span>))</a>
<a class="sourceLine" id="cb22-17" data-line-number="17">  <span class="kw">print</span>(plot) <span class="co"># Don&#39;t print plots - clutters up output at the moment</span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18">}</a></code></pre></div>
<pre><code>## [1] &quot;Category 1 storms&quot;
## [1] &quot;subdata dims: nrow 45 ncol 13&quot;</code></pre>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre><code>## [1] &quot;Category 2 storms&quot;
## [1] &quot;subdata dims: nrow 39 ncol 13&quot;</code></pre>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre><code>## [1] &quot;Category 3 storms&quot;
## [1] &quot;subdata dims: nrow 29 ncol 13&quot;</code></pre>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<pre><code>## [1] &quot;Category 4 storms&quot;
## [1] &quot;subdata dims: nrow 32 ncol 13&quot;</code></pre>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
<pre><code>## [1] &quot;Category 5 storms&quot;
## [1] &quot;subdata dims: nrow 12 ncol 13&quot;</code></pre>
<p><img src="unl-stat850_files/figure-html/unnamed-chunk-10-5.png" width="672" /></p>
<p>If we want to only print informative plots, we could add an if statement. Now that the code works, we can also comment out our print() statements (we could delete them, too, depending on whether we anticipate future problems with the code).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  <span class="co"># print(paste0(&quot;Category &quot;, i, &quot; storms&quot;))</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb28-4" data-line-number="4">  <span class="co"># Subset the data</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  subdata &lt;-<span class="st"> </span>storms <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2013</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="st">    </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> </span>i)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb28-9" data-line-number="9">  <span class="co"># print(paste0(&quot;subdata dims: nrow &quot;, nrow(subdata), &quot; ncol &quot;, ncol(subdata)))</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10">  <span class="co">#       # str(subdata) works too, but produces more clutter. I started</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11">  <span class="co">#       # with str() and moved to dim() when I saw the problem</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb28-13" data-line-number="13">  <span class="co"># Plot the data - path + points to show the observations</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14">  plot &lt;-<span class="st"> </span>basemap <span class="op">+</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">color =</span> name), <span class="dt">data =</span> subdata) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Category &quot;</span>, i, <span class="st">&quot; storms in 2013&quot;</span>))</a>
<a class="sourceLine" id="cb28-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb28-19" data-line-number="19">  <span class="cf">if</span> (<span class="kw">nrow</span>(subdata) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">print</span>(plot) </a>
<a class="sourceLine" id="cb28-20" data-line-number="20">}</a></code></pre></div>
<img src="unl-stat850_files/figure-html/unnamed-chunk-11-1.png" width="672" />
</details>
</div>
</div>
<div id="after-an-error-has-occurred---traceback" class="section level3">
<h3><span class="header-section-number">7.3.2</span> After an error has occurred - <code>traceback()</code></h3>
<p><code>traceback()</code> can help you narrow down where an error occurs by taking you through the series of function calls that led up to the error. This can help, but it can also be pretty arcane.</p>
<details>
<p><summary><code>traceback()</code> example</summary></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  b &lt;-<span class="st"> </span><span class="cf">function</span>(y) {</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">    c &lt;-<span class="st"> </span><span class="cf">function</span>(z) {</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">     <span class="kw">stop</span>(<span class="st">&#39;there was a problem&#39;</span>)  <span class="co"># This generates an error</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">    }</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">    <span class="kw">c</span>()</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">  }</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  <span class="kw">b</span>()</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb29-10" data-line-number="10"></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="kw">a</span>()</a></code></pre></div>
<pre><code>## Error in c(): there was a problem</code></pre>
<p>For more information, you could run traceback</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">traceback</span>()</a></code></pre></div>
<p>Which will provide the following output:</p>
<pre><code>4: stop(&quot;there was a problem&quot;) at #4
3: c() at #6
2: b() at #8
1: a()</code></pre>
<p>Reading through this, we see that a() was called, b() was called, c() was called, and then there was an error. It’s even kind enough to tell us that the error occurred at line 4 of the code.</p>
<p>If you are running this code interactively in RStudio, it’s even easier to run <code>traceback()</code> by clicking on the “Show Traceback” option that appears when there is an error.</p>
<div class="figure"><span id="fig:unnamed-chunk-14"></span>
<img src="image/Rstudio_rerun_traceback.png" alt="Both Show Traceback and Rerun with Debug are useful tools" width="50%" />
<p class="caption">
Figure 7.2: Both Show Traceback and Rerun with Debug are useful tools
</p>
</div>
If you are using <code>source()</code> to run the code in Rstudio, it will even provide a link to the file and line location of the error.
<img src="image/Rstudio_rerun_traceback_source.png" alt="The output of source(&quot;code/07_debug_ex.R&quot;) as run in RStudio. The traceback() function information contains links to the files of the functions causing the error. For instance, 07_debug_ex.R#4 text is a link to line 4 of the file." />
</details>
</div>
<div id="browser---debugging-your-own-code-interactively" class="section level3">
<h3><span class="header-section-number">7.3.3</span> <code>browser()</code> - debugging your own code, interactively</h3>
<p>The <code>browser()</code> function is useful for debugging your own code. If you’re writing a function and something isn’t working quite right, you can insert a call to <code>browser()</code> in that function, and examine what’s going on.</p>
<details>
<p><summary>Example of using browser()</summary>
Suppose that I want to write a function that will plot an xkcd comic in R.</p>
<p>I start with</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">library</span>(png)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co"># get the most current xkcd or the specified number</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5">get_xkcd &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">id =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">  url &lt;-<span class="st"> &quot;http://xkcd.com&quot;</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7">  page &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</a>
<a class="sourceLine" id="cb33-8" data-line-number="8">  <span class="co"># Find the comic</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9">  image &lt;-<span class="st"> </span><span class="kw">xml_find_first</span>(page, <span class="st">&quot;//div[@id=&#39;comic&#39;]/img&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="st">    </span><span class="co"># pull the address out of the tag</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="st">    </span><span class="kw">xml_attr</span>(<span class="st">&quot;src&quot;</span>)</a>
<a class="sourceLine" id="cb33-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb33-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb33-14" data-line-number="14">  <span class="kw">readPNG</span>(<span class="dt">source =</span> image)</a>
<a class="sourceLine" id="cb33-15" data-line-number="15">}</a></code></pre></div>
<p>Watch this live-coding video to see how I use browser() to figure out what’s going on in the function and how to fix it.</p>
<p>Here’s the final function</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">library</span>(png)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ tibble  3.0.1     ✓ purrr   0.3.4
## ✓ tidyr   1.1.0     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x tidyr::extract()   masks magrittr::extract()
## x dplyr::filter()    masks stats::filter()
## x dplyr::lag()       masks stats::lag()
## x purrr::map()       masks maps::map()
## x purrr::set_names() masks magrittr::set_names()</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># get the most current xkcd or the specified number</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">get_xkcd &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">id =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb38-4" data-line-number="4">  url &lt;-<span class="st"> &quot;http://xkcd.com&quot;</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5">  page &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">  <span class="co"># Find the comic</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7">  image &lt;-<span class="st"> </span><span class="kw">xml_find_first</span>(page, <span class="st">&quot;//div[@id=&#39;comic&#39;]/img&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="st">    </span><span class="co"># pull the address out of the tag</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="st">    </span><span class="kw">xml_attr</span>(<span class="st">&quot;src&quot;</span>)</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb38-11" data-line-number="11">  <span class="co"># Fix image address so that we can access the image</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12">  image &lt;-<span class="st"> </span><span class="kw">substr</span>(image, <span class="dv">3</span>, <span class="kw">nchar</span>(image))</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb38-14" data-line-number="14">  <span class="co"># Download the file to a temp file and read from there</span></a>
<a class="sourceLine" id="cb38-15" data-line-number="15">  file_location &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.png&quot;</span>)</a>
<a class="sourceLine" id="cb38-16" data-line-number="16">  <span class="kw">download.file</span>(image, <span class="dt">destfile =</span> file_location, <span class="dt">quiet =</span> T)</a>
<a class="sourceLine" id="cb38-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb38-18" data-line-number="18">  <span class="kw">readPNG</span>(<span class="dt">source =</span> file_location)</a>
<a class="sourceLine" id="cb38-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb38-20" data-line-number="20"></a>
<a class="sourceLine" id="cb38-21" data-line-number="21"><span class="kw">get_xkcd</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-22" data-line-number="22"><span class="st">  </span><span class="kw">as.raster</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-23" data-line-number="23"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<img src="unl-stat850_files/figure-html/unnamed-chunk-16-1.png" width="672" />
</details>
</div>
<div id="debug---the-general-debugging-workhorse" class="section level3">
<h3><span class="header-section-number">7.3.4</span> <code>debug()</code> - the general debugging workhorse</h3>
<p>In the <code>traceback()</code> Rstudio output, the other option is “rerun with debug”. In short, debug mode opens up a new interactive session inside the function evaluation environment. This lets you observe what’s going on in the function, pinpoint the error (and what causes it), and potentially fix the error, all in one neat workflow.</p>
<p><code>debug()</code> is most useful when you’re working with code that you didn’t write yourself. So, if you can’t change the code in the function causing the error, <code>debug()</code> is the way to go. Otherwise, using <code>browser()</code> is generally easier. Essentially, <code>debug()</code> places a <code>browser()</code> statement at the first line of a function, but without having to actually alter the function’s source code.</p>
<details>
<p><summary>Example of using debug </summary></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"></a>
<a class="sourceLine" id="cb39-3" data-line-number="3">tmp &lt;-<span class="st"> </span><span class="kw">lm</span>(Species <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> iris)</a></code></pre></div>
<pre><code>## Warning in model.response(mf, &quot;numeric&quot;): using type = &quot;numeric&quot; with a factor
## response will be ignored</code></pre>
<pre><code>## Warning in Ops.factor(y, z$residuals): &#39;-&#39; not meaningful for factors</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">summary</span>(tmp)</a></code></pre></div>
<pre><code>## Warning in Ops.factor(r, 2): &#39;^&#39; not meaningful for factors</code></pre>
<pre><code>## 
## Call:
## lm(formula = Species ~ ., data = iris)
## 
## Residuals:</code></pre>
<pre><code>## Error in quantile.default(resid): factors are not allowed</code></pre>
<p>We get this weird warning, and then an error about factors when we use summary() to look at the coefficients.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">debug</span>(lm) <span class="co"># turn debugging on</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"></a>
<a class="sourceLine" id="cb46-4" data-line-number="4">tmp &lt;-<span class="st"> </span><span class="kw">lm</span>(Species <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> iris)</a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="kw">summary</span>(tmp)</a>
<a class="sourceLine" id="cb46-6" data-line-number="6"></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"><span class="kw">undebug</span>(lm) <span class="co"># turn debugging off)</span></a></code></pre></div>
<div class="figure">
<img src="image/07_debug_init.png" alt="The first thing I see when I run lm after turning on debug (screenshot)" />
<p class="caption">The first thing I see when I run lm after turning on debug (screenshot)</p>
</div>
<div class="figure">
<img src="image/07_debug_console.png" alt="The variables passed into the lm function are available as named and used in the function. In addition, we have some handy buttons in the console window that will let us ‘drive’ through the function" />
<p class="caption">The variables passed into the lm function are available as named and used in the function. In addition, we have some handy buttons in the console window that will let us ‘drive’ through the function</p>
</div>
<p>After pressing “next” a few times, you can see that I’ve stepped through the first few lines of the lm function.</p>
<p><img src="image/07_debug_console2.png" alt="Stepping through the function. The arrow on the left side in the editor window shows which line of code we’re currently at." />
We can see that once we’re at line 21, we get a warning about using type with a factor response, and that the warning occurs during a call to the <code>model.response</code> function. So, we’ve narrowed our problem down - we passed in a numeric variable as the response (y) variable, but it’s a factor, so our results aren’t going to mean much. We were using the function wrong.</p>
<p>We probably could have gotten there from reading the error message carefully, but this has allowed us to figure out exactly what happened, where it happened, and why it happened.</p>
<div class="figure">
<img src="image/07_debug_console_exit.png" alt="I can hit “Stop” or type “Q” to exit the debug environment." />
<p class="caption">I can hit “Stop” or type “Q” to exit the debug environment.</p>
</div>
But, until I run <code>undebug(lm)</code>, every call to <code>lm</code> will take me into the debug window.
</details>
<p><code>undebug(f)</code> will remove the debug flag on the function <code>f</code>. <code>debugonce(f)</code> will only debug f the first time it is run.</p>
</div>
<div id="try-it-out-1" class="section level3 unnumbered tryitout">
<h3>Try it out</h3>
<p>larger(x, y) is supposed to return the elementwise maximum of two vectors.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">larger &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb47-2" data-line-number="2">  y.is.bigger &lt;-<span class="st"> </span>y <span class="op">&gt;</span><span class="st"> </span>x </a>
<a class="sourceLine" id="cb47-3" data-line-number="3">  x[y.is.bigger] &lt;-<span class="st"> </span>y[y.is.bigger] </a>
<a class="sourceLine" id="cb47-4" data-line-number="4">  x</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">} </a>
<a class="sourceLine" id="cb47-6" data-line-number="6"></a>
<a class="sourceLine" id="cb47-7" data-line-number="7"><span class="kw">larger</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">11</span>))</a></code></pre></div>
<pre><code>## [1]  2  5 11</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">larger</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="dv">6</span>)</a></code></pre></div>
<pre><code>## [1]  6 NA 10</code></pre>
<p>Why is there an NA in the second example? It should be a 6. Figure out why this happens, then try to fix it.</p>
<details>
<p><summary>Solution</summary>
I’ll replicate “debug” in non-interactive mode by setting up an environment where x and y are defined</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="co"># Inside of larger() with x = c(1, 5, 10), y = 6</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5">(y.is.bigger &lt;-<span class="st"> </span>y <span class="op">&gt;</span><span class="st"> </span>x ) <span class="co"># putting something in () prints it out</span></a></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">y[y.is.bigger] <span class="co"># This isn&#39;t quite what we were going for, but it&#39;s what&#39;s causing the issue</span></a></code></pre></div>
<pre><code>## [1]  6 NA</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">x[y.is.bigger] <span class="co"># What gets replaced</span></a></code></pre></div>
<pre><code>## [1] 1 5</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co"># Better option</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2">larger &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb57-3" data-line-number="3">  y.is.bigger &lt;-<span class="st"> </span>y <span class="op">&gt;</span><span class="st"> </span>x </a>
<a class="sourceLine" id="cb57-4" data-line-number="4">  <span class="kw">ifelse</span>(y.is.bigger, y, x)</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">} </a></code></pre></div>
</details>
</div>
</div>
<div id="debugging-tools-in-sas" class="section level2">
<h2><span class="header-section-number">7.4</span> Debugging Tools in SAS</h2>
<p>In SAS, there are two stages that occur after you submit lines to the console.
- The Compilation Phase: code is parsed. In this step, SAS will catch the logic errors, misspellings, missing key words, etc.
- The Execution Phase: program is run. In this step, SAS will catch any wrong assignments, loop issues, etc.</p>
<p>Sas recognizes four types of errors:
- Syntax errors - violations of the language structure
- Semantic errors - structure of the statement is incorrect, but the syntax is correct. e.g. trying to reference an index that doesn’t exist.
- Execution-time errors - errors that occur when the compiled function is run on data values – e.g. division by zero
- Data errors - errors that occur when statements are correct but data is invalid (taking the log of a negative number, etc.)</p>
<p>SAS is built around enterprise users, as opposed to R’s open-source philosophy. SAS code also is more formulaic than R code, which means it is usually easier to figure out what is going wrong with the code. As a result, you may find that errors in your SAS code are much easier to diagnose than errors in your R code. Generally, it will tell you exactly where you are missing a semicolon, or exactly what word it thinks you’ve misspelled (and usually, it tries to correct that for you, but it doesn’t always succeed). In my experience with SAS (which is very limited and mostly contained in this book), SAS error messages are much easier to google and find solutions, right up until you’re working in Linux or some other not-well-supported system and the error is related to how the underlying OS handles some task. As a downside, though, trying to do a task SAS doesn’t think you need to do can be much more difficult than necessary.</p>
<p>See the references section for a couple of good guides to SAS error statements and warnings. These guides are likely sufficient for most of your SAS debugging needs.</p>
<p>There are certainly other errors which can occur in SAS – logic errors are not something SAS can protect you from . These errors can have dramatic consequences, as demonstrated in <a href="https://twitter.com/eric_weinhandl/status/1253127109830156289">this twitter thread</a> about a <a href="https://twitter.com/hswapnil/status/1252783448055517185">JAMA retraction due to a coding error</a>. To debug these types of errors, you can use the same print() techniques demonstrated in R. For these types of errors, there’s nothing special about what language you’re using (outside of the usual quirks of every language) - the error is in the logic, not the encoding of that logic.</p>
</div>
<div id="minimal-working-examples" class="section level2">
<h2><span class="header-section-number">7.5</span> Minimal Working Examples</h2>
<p>If all else has failed, and you can’t figure out what is causing your error, it’s probably time to ask for help. If you have a friend or buddy that knows the language you’re working in, by all means ask for help sooner - use them as a rubber duck if you have to. But when you ask for help online, often you’re asking people who are much more knowledgeable about the topic - members of R core and SAS browse stackoverflow and may drop in and help you out. Under those circumstances, it’s better to make the task of helping you as easy as possible because it shows respect for their time. The same thing goes for your supervisors and professors.</p>
<p>So, with that said, there are numerous resources for writing what’s called a “minimal working example”, “reproducible example” (commonly abbreviated reprex), or MCVE (minimal complete verifiable example). Much of this is lifted directly from the StackOverflow post describing a <a href="https://stackoverflow.com/help/minimal-reproducible-example">minimal reproducible example</a>.</p>
<p>The goal is to reproduce the error message with information that is
- <strong>minimal</strong> - as little code as possible to still reproduce the problem
- <strong>complete</strong> - everything necessary to reproduce the issue is contained in the description/question
- <strong>reproducible</strong> - test the code you provide to reproduce the problem.</p>
<p>You should format your question to make it as easy as possible to help you. Make it so that code can be copied from your post directly and pasted into a terminal. Describe what you see and what you’d hope to see if the code were working.</p>
</div>
<div id="references" class="section level2 unnumbered learn-more">
<h2>References</h2>
<ul>
<li><p><a href="https://doi.org/10.1109/85.728224">Stalking the elusive computer bug</a> - the etymology and historical use of the term “debugging”, from Thomas Edison to Grace Hopper.</p></li>
<li><p><a href="http://web.mit.edu/6.031/www/fa17/classes/13-debugging/">Debugging</a> (lecture materials from software construction class at MIT) - written with java, but mostly comprehensible for any language.</p></li>
<li><p><a href="https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-RStudio">Debugging with RStudio</a></p></li>
<li><p><a href="http://www.biostat.jhsph.edu/~rpeng/docs/R-debug-tools.pdf">An Introduction to the Interactive Debugging Tools in R</a></p></li>
<li><p><a href="https://stackoverflow.com/questions/4442518/general-suggestions-for-debugging-in-r">Stackoverflow: General Suggestions for Debugging in R</a></p></li>
<li><p><a href="https://rstats.wtf/debugging-r-code.html">WTF R - What They Forgot to Teach You about R Debugging chapter</a></p></li>
<li><p><a href="https://support.sas.com/resources/papers/proceedings16/2748-2016.pdf">Debugging 101 in SAS</a></p></li>
<li><p><a href="https://support.sas.com/publishing/pubcat/chaps/57743.pdf">Debugging SAS Programs - Ch. 1: The Basics of Debugging</a></p></li>
<li><p><a href="https://rstudio.com/resources/webinars/help-me-help-you-creating-reproducible-examples/">A webinar by Jenny Bryan/RStudio on Reproducible Examples</a></p></li>
</ul>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>the 0th step is from the 1st edition, the remaining steps are from the 2nd.<a href="debugging.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Some people use cats, but I find that they don’t meet the nonjudgemental criteria. Of course, they’re equally judgemental whether your code works or not, so maybe that works if you’re a cat person, which I am not. Dogs, in my experience, can work, but often will try to comfort you when they realize you’re upset, which both helps and lessens your motivation to fix the problem. A rubber duck is the perfect dispassionate listener.<a href="debugging.html#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="transforming-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-vis-intro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
