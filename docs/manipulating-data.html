<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 5 Manipulating Data | Stat 850: Computing Tools for Statisticians</title>
  <meta name="description" content="Introductions to statistical computing packages and document preparation software. Topics include: graphical techniques, data management, Monte Carlo simulation, dynamic document preparation, presentation software." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 5 Manipulating Data | Stat 850: Computing Tools for Statisticians" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introductions to statistical computing packages and document preparation software. Topics include: graphical techniques, data management, Monte Carlo simulation, dynamic document preparation, presentation software." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 5 Manipulating Data | Stat 850: Computing Tools for Statisticians" />
  
  <meta name="twitter:description" content="Introductions to statistical computing packages and document preparation software. Topics include: graphical techniques, data management, Monte Carlo simulation, dynamic document preparation, presentation software." />
  

<meta name="author" content="Susan Vanderplas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading-data.html"/>
<link rel="next" href="transforming-data.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script>

(function() {
  var codes = document.querySelectorAll('pre:not([class])');
  var code, i, d, s, p;
  for (i = 0; i < codes.length; i++) {
    code = codes[i];
    p = code.parentNode;
    d = document.createElement('details');
    s = document.createElement('summary');
    s.innerText = 'Answers';
    // <details><summary>Answers</summary></details>
      d.appendChild(s);
    // move the code into <details>
      p.replaceChild(d, code);
    d.appendChild(code);
  }
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Statistical Computing</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#forward"><i class="fa fa-check"></i>Forward</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course Description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-goals"><i class="fa fa-check"></i>Course Goals</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i>Course Objectives</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>1</b> Tools for Statistical Computing</a>
<ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#module-1-objectives"><i class="fa fa-check"></i>Tools: Module Objectives</a></li>
<li class="chapter" data-level="1.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="tools.html"><a href="tools.html#getting-set-up-r"><i class="fa fa-check"></i><b>1.1.1</b> Getting Set up: R</a></li>
<li class="chapter" data-level="1.1.2" data-path="tools.html"><a href="tools.html#getting-set-up-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Getting Set up: RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="tools.html"><a href="tools.html#exploring-rstudio"><i class="fa fa-check"></i><b>1.1.3</b> Exploring RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tools.html"><a href="tools.html#sas"><i class="fa fa-check"></i><b>1.2</b> SAS</a>
<ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#note"><i class="fa fa-check"></i>Note</a></li>
<li class="chapter" data-level="1.2.1" data-path="tools.html"><a href="tools.html#sas-windowspanes"><i class="fa fa-check"></i><b>1.2.1</b> SAS Windows/Panes</a></li>
<li class="chapter" data-level="1.2.2" data-path="tools.html"><a href="tools.html#sas-modules"><i class="fa fa-check"></i><b>1.2.2</b> SAS Modules</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="tools.html"><a href="tools.html#version-control-with-git"><i class="fa fa-check"></i><b>1.3</b> Version Control with Git</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="tools.html"><a href="tools.html#getting-set-up-github"><i class="fa fa-check"></i><b>1.3.1</b> Getting set up: GitHub</a></li>
<li class="chapter" data-level="1.3.2" data-path="tools.html"><a href="tools.html#getting-set-up-git"><i class="fa fa-check"></i><b>1.3.2</b> Getting set up: git</a></li>
<li class="chapter" data-level="1.3.3" data-path="tools.html"><a href="tools.html#introduce-yourself-to-git"><i class="fa fa-check"></i><b>1.3.3</b> Introduce yourself to git</a></li>
<li class="chapter" data-level="1.3.4" data-path="tools.html"><a href="tools.html#optional-install-a-git-client"><i class="fa fa-check"></i><b>1.3.4</b> Optional: Install a git client</a></li>
<li class="chapter" data-level="1.3.5" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>1.3.5</b> Git and Github</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="tools.html"><a href="tools.html#latex"><i class="fa fa-check"></i><b>1.4</b> LaTeX</a></li>
<li class="chapter" data-level="1.5" data-path="tools.html"><a href="tools.html#easy-extra-setup-script"><i class="fa fa-check"></i><b>1.5</b> Easy Extra Setup Script</a></li>
<li class="chapter" data-level="1.6" data-path="tools.html"><a href="tools.html#topic-sequencing"><i class="fa fa-check"></i><b>1.6</b> Topic Sequencing</a></li>
<li class="chapter" data-level="1.7" data-path="tools.html"><a href="tools.html#using-version-control"><i class="fa fa-check"></i><b>1.7</b> Using Version Control</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="tools.html"><a href="tools.html#create-a-repository"><i class="fa fa-check"></i><b>1.7.1</b> Create a Repository</a></li>
<li class="chapter" data-level="1.7.2" data-path="tools.html"><a href="tools.html#adding-files"><i class="fa fa-check"></i><b>1.7.2</b> Adding files</a></li>
<li class="chapter" data-level="1.7.3" data-path="tools.html"><a href="tools.html#staging-your-changes"><i class="fa fa-check"></i><b>1.7.3</b> Staging your changes</a></li>
<li class="chapter" data-level="1.7.4" data-path="tools.html"><a href="tools.html#committing-your-changes"><i class="fa fa-check"></i><b>1.7.4</b> Committing your changes</a></li>
<li class="chapter" data-level="1.7.5" data-path="tools.html"><a href="tools.html#pushing-and-pulling"><i class="fa fa-check"></i><b>1.7.5</b> Pushing and Pulling</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="tools.html"><a href="tools.html#references"><i class="fa fa-check"></i><b>1.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-prog.html"><a href="intro-prog.html"><i class="fa fa-check"></i><b>2</b> Introduction to Statistical Programming</a>
<ul>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#a-quick-note-on-rmarkdown"><i class="fa fa-check"></i>A quick note on Rmarkdown</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#module-2-objectives"><i class="fa fa-check"></i>Intro to Programming: Module Objectives</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#definitions"><i class="fa fa-check"></i>Definitions</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#statistical-programming-languages"><i class="fa fa-check"></i>Statistical Programming Languages</a></li>
<li class="chapter" data-level="2.1" data-path="intro-prog.html"><a href="intro-prog.html#variable-types"><i class="fa fa-check"></i><b>2.1</b> Variable types</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro-prog.html"><a href="intro-prog.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro-prog.html"><a href="intro-prog.html#sas-1"><i class="fa fa-check"></i><b>2.1.2</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro-prog.html"><a href="intro-prog.html#data-structures"><i class="fa fa-check"></i><b>2.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro-prog.html"><a href="intro-prog.html#homogeneous-data-structures-r-and-sas"><i class="fa fa-check"></i><b>2.2.1</b> Homogeneous data structures (R and SAS)</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro-prog.html"><a href="intro-prog.html#heterogeneous-data-structures"><i class="fa fa-check"></i><b>2.2.2</b> Heterogeneous data structures</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro-prog.html"><a href="intro-prog.html#indexing"><i class="fa fa-check"></i><b>2.2.3</b> Indexing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro-prog.html"><a href="intro-prog.html#control-structures"><i class="fa fa-check"></i><b>2.3</b> Control structures</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro-prog.html"><a href="intro-prog.html#if-statements"><i class="fa fa-check"></i><b>2.3.1</b> If statements</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro-prog.html"><a href="intro-prog.html#loops"><i class="fa fa-check"></i><b>2.3.2</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro-prog.html"><a href="intro-prog.html#overgrown-calculators"><i class="fa fa-check"></i><b>2.4</b> Overgrown Calculators</a></li>
<li class="chapter" data-level="" data-path="intro-prog.html"><a href="intro-prog.html#references-and-links"><i class="fa fa-check"></i>References and Links</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro-prog.html"><a href="intro-prog.html#cheat-sheets-and-reference-cards"><i class="fa fa-check"></i><b>2.4.1</b> Cheat Sheets and Reference Cards</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro-prog.html"><a href="intro-prog.html#sas-as-taught-in-other-places"><i class="fa fa-check"></i><b>2.4.2</b> SAS (as taught in other places)</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro-prog.html"><a href="intro-prog.html#r-courses-as-taught-elsewhere-and-textbooks"><i class="fa fa-check"></i><b>2.4.3</b> R courses (as taught elsewhere) and Textbooks</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro-prog.html"><a href="intro-prog.html#combination-of-r-and-sas-courses"><i class="fa fa-check"></i><b>2.4.4</b> Combination of R and SAS courses</a></li>
<li class="chapter" data-level="2.4.5" data-path="intro-prog.html"><a href="intro-prog.html#non-exhaustive-list-of-sources-used-to-aggregate-core-programming-concepts"><i class="fa fa-check"></i><b>2.4.5</b> Non-Exhaustive List of Sources used to aggregate “core programming concepts”:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organization.html"><a href="organization.html"><i class="fa fa-check"></i><b>3</b> Organization: Packages, Functions, Scripts, and Documents</a>
<ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#module-3-objectives"><i class="fa fa-check"></i>Organization: Module Objectives</a></li>
<li class="chapter" data-level="3.1" data-path="organization.html"><a href="organization.html#reproducibility"><i class="fa fa-check"></i><b>3.1</b> Reproducibility</a>
<ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#reproducibility-references-and-reading"><i class="fa fa-check"></i>Reproducibility References and Reading</a></li>
<li class="chapter" data-level="3.1.1" data-path="organization.html"><a href="organization.html#rmarkdown"><i class="fa fa-check"></i><b>3.1.1</b> Markdown and R</a></li>
<li class="chapter" data-level="3.1.2" data-path="organization.html"><a href="organization.html#rmarkdown-with-sas"><i class="fa fa-check"></i><b>3.1.2</b> Rmarkdown with… SAS?</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="organization.html"><a href="organization.html#functions-and-modules"><i class="fa fa-check"></i><b>3.2</b> Functions and Modules</a>
<ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#try-it-out-7"><i class="fa fa-check"></i>Try it out</a></li>
<li class="chapter" data-level="3.2.1" data-path="organization.html"><a href="organization.html#scope"><i class="fa fa-check"></i><b>3.2.1</b> Scope</a></li>
<li class="chapter" data-level="3.2.2" data-path="organization.html"><a href="organization.html#the-pipe"><i class="fa fa-check"></i><b>3.2.2</b> The Pipe</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="organization.html"><a href="organization.html#procs-and-data-steps"><i class="fa fa-check"></i><b>3.3</b> Procs and Data steps</a>
<ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#try-it-out-9"><i class="fa fa-check"></i>Try It Out</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="organization.html"><a href="organization.html#scripts"><i class="fa fa-check"></i><b>3.4</b> Scripts</a>
<ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#try-it-out-10"><i class="fa fa-check"></i>Try it out</a></li>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#try-it-out-sas"><i class="fa fa-check"></i>Try it out (SAS)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="organization.html"><a href="organization.html#packages"><i class="fa fa-check"></i><b>3.5</b> Packages</a>
<ul>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#try-it-out-11"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html#references-and-links-1"><i class="fa fa-check"></i>References and Links</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>4</b> External Data</a>
<ul>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#reading-data-module-objectives"><i class="fa fa-check"></i>Reading Data: Module Objectives</a></li>
<li class="chapter" data-level="4.1" data-path="reading-data.html"><a href="reading-data.html#external-data-formats"><i class="fa fa-check"></i><b>4.1</b> External Data Formats</a></li>
<li class="chapter" data-level="4.2" data-path="reading-data.html"><a href="reading-data.html#text-files"><i class="fa fa-check"></i><b>4.2</b> Text Files</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-data.html"><a href="reading-data.html#fixed-width-files"><i class="fa fa-check"></i><b>4.2.1</b> Fixed-width files</a></li>
<li class="chapter" data-level="4.2.2" data-path="reading-data.html"><a href="reading-data.html#delimited-text-files"><i class="fa fa-check"></i><b>4.2.2</b> Delimited Text Files</a></li>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#try-it-out-12"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-data.html"><a href="reading-data.html#spreadsheets"><i class="fa fa-check"></i><b>4.3</b> Spreadsheets</a>
<ul>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#try-it-out-13"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="reading-data.html"><a href="reading-data.html#binary-files"><i class="fa fa-check"></i><b>4.4</b> Binary Files</a>
<ul>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#try-it-out-14"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="reading-data.html"><a href="reading-data.html#databases"><i class="fa fa-check"></i><b>4.5</b> Databases</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="reading-data.html"><a href="reading-data.html#microsoft-access"><i class="fa fa-check"></i><b>4.5.1</b> Microsoft Access</a></li>
<li class="chapter" data-level="4.5.2" data-path="reading-data.html"><a href="reading-data.html#sqlite"><i class="fa fa-check"></i><b>4.5.2</b> SQLite</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="reading-data.html"><a href="reading-data.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>4.6</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="reading-data.html"><a href="reading-data.html#sas-2"><i class="fa fa-check"></i><b>4.6.1</b> SAS</a></li>
<li class="chapter" data-level="4.6.2" data-path="reading-data.html"><a href="reading-data.html#r-1"><i class="fa fa-check"></i><b>4.6.2</b> R</a></li>
<li class="chapter" data-level="4.6.3" data-path="reading-data.html"><a href="reading-data.html#comparison"><i class="fa fa-check"></i><b>4.6.3</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-data.html"><a href="reading-data.html#references-and-links-2"><i class="fa fa-check"></i>References and Links</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-data.html"><a href="manipulating-data.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data</a>
<ul>
<li class="chapter" data-level="" data-path="manipulating-data.html"><a href="manipulating-data.html#manipulating-data-module-objectives"><i class="fa fa-check"></i>Manipulating Data: Module Objectives</a></li>
<li class="chapter" data-level="5.1" data-path="manipulating-data.html"><a href="manipulating-data.html#tidy-data"><i class="fa fa-check"></i><b>5.1</b> Tidy Data</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data.html"><a href="manipulating-data.html#filter-pick-cases-rows-based-on-their-values"><i class="fa fa-check"></i><b>5.2</b> Filter: Pick cases (rows) based on their values</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="manipulating-data.html"><a href="manipulating-data.html#common-filter-tasks"><i class="fa fa-check"></i><b>5.2.1</b> Common Filter() Tasks</a></li>
<li class="chapter" data-level="" data-path="manipulating-data.html"><a href="manipulating-data.html#try-it-out-15"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data.html"><a href="manipulating-data.html#select-pick-columns"><i class="fa fa-check"></i><b>5.3</b> Select: Pick columns</a></li>
<li class="chapter" data-level="5.4" data-path="manipulating-data.html"><a href="manipulating-data.html#mutate-add-and-transform-variables"><i class="fa fa-check"></i><b>5.4</b> Mutate: Add and transform variables</a></li>
<li class="chapter" data-level="5.5" data-path="manipulating-data.html"><a href="manipulating-data.html#summarize"><i class="fa fa-check"></i><b>5.5</b> Summarize</a></li>
<li class="chapter" data-level="5.6" data-path="manipulating-data.html"><a href="manipulating-data.html#group-by-power"><i class="fa fa-check"></i><b>5.6</b> Group By + (?) = Power!</a></li>
<li class="chapter" data-level="5.7" data-path="manipulating-data.html"><a href="manipulating-data.html#other-dplyr-functions-across-relocate"><i class="fa fa-check"></i><b>5.7</b> Other <code>dplyr</code> functions: across, relocate</a></li>
<li class="chapter" data-level="" data-path="manipulating-data.html"><a href="manipulating-data.html#try-it-out-16"><i class="fa fa-check"></i>Try it out</a></li>
<li class="chapter" data-level="" data-path="manipulating-data.html"><a href="manipulating-data.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>6</b> Transforming Data</a>
<ul>
<li class="chapter" data-level="" data-path="transforming-data.html"><a href="transforming-data.html#transforming-data-module-objectives"><i class="fa fa-check"></i>Transforming Data: Module Objectives</a></li>
<li class="chapter" data-level="6.1" data-path="transforming-data.html"><a href="transforming-data.html#identifying-the-problem-messy-data"><i class="fa fa-check"></i><b>6.1</b> Identifying the problem: Messy data</a>
<ul>
<li class="chapter" data-level="" data-path="transforming-data.html"><a href="transforming-data.html#try-it-out-17"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="transforming-data.html"><a href="transforming-data.html#string-operations-creating-new-variables-and-separating-multi-variable-columns"><i class="fa fa-check"></i><b>6.2</b> String operations: Creating new variables and separating multi-variable columns</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="transforming-data.html"><a href="transforming-data.html#basic-string-operations"><i class="fa fa-check"></i><b>6.2.1</b> Basic String Operations</a></li>
<li class="chapter" data-level="6.2.2" data-path="transforming-data.html"><a href="transforming-data.html#regular-expressions"><i class="fa fa-check"></i><b>6.2.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="6.2.3" data-path="transforming-data.html"><a href="transforming-data.html#joining-and-splitting-variables"><i class="fa fa-check"></i><b>6.2.3</b> Joining and Splitting Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="transforming-data.html"><a href="transforming-data.html#pivot-operations"><i class="fa fa-check"></i><b>6.3</b> Pivot operations</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="transforming-data.html"><a href="transforming-data.html#longer"><i class="fa fa-check"></i><b>6.3.1</b> Longer</a></li>
<li class="chapter" data-level="6.3.2" data-path="transforming-data.html"><a href="transforming-data.html#wider"><i class="fa fa-check"></i><b>6.3.2</b> Wider</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="transforming-data.html"><a href="transforming-data.html#relational-data-and-joining-tables"><i class="fa fa-check"></i><b>6.4</b> Relational Data and Joining Tables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="transforming-data.html"><a href="transforming-data.html#demonstration-dataset-setup"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration dataset setup</a></li>
<li class="chapter" data-level="6.4.2" data-path="transforming-data.html"><a href="transforming-data.html#mutating-joins"><i class="fa fa-check"></i><b>6.4.2</b> Mutating joins</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="transforming-data.html"><a href="transforming-data.html#example-gas-prices-data"><i class="fa fa-check"></i><b>6.5</b> Example: Gas Prices Data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="transforming-data.html"><a href="transforming-data.html#option-1-manual-formatting-in-excel"><i class="fa fa-check"></i><b>6.5.1</b> Option 1: Manual formatting in Excel</a></li>
<li class="chapter" data-level="6.5.2" data-path="transforming-data.html"><a href="transforming-data.html#option-2-r"><i class="fa fa-check"></i><b>6.5.2</b> Option 2: R</a></li>
<li class="chapter" data-level="6.5.3" data-path="transforming-data.html"><a href="transforming-data.html#option-3-sas"><i class="fa fa-check"></i><b>6.5.3</b> Option 3: SAS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="transforming-data.html"><a href="transforming-data.html#references-2"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>7</b> Principles of Debugging</a>
<ul>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#debugging-module-objectives"><i class="fa fa-check"></i>Debugging: Module Objectives</a></li>
<li class="chapter" data-level="7.1" data-path="debugging.html"><a href="debugging.html#step-1-check-your-spelling."><i class="fa fa-check"></i><b>7.1</b> Step 1: Check your spelling.</a></li>
<li class="chapter" data-level="7.2" data-path="debugging.html"><a href="debugging.html#defensive-programming"><i class="fa fa-check"></i><b>7.2</b> Defensive Programming</a></li>
<li class="chapter" data-level="7.3" data-path="debugging.html"><a href="debugging.html#general-debugging-strategies"><i class="fa fa-check"></i><b>7.3</b> General Debugging Strategies</a></li>
<li class="chapter" data-level="7.4" data-path="debugging.html"><a href="debugging.html#debugging-tools-in-r"><i class="fa fa-check"></i><b>7.4</b> Debugging Tools in R</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="debugging.html"><a href="debugging.html#low-tech-debugging-with-print-and-other-tools"><i class="fa fa-check"></i><b>7.4.1</b> Low tech debugging with print() and other tools</a></li>
<li class="chapter" data-level="7.4.2" data-path="debugging.html"><a href="debugging.html#after-an-error-has-occurred---traceback"><i class="fa fa-check"></i><b>7.4.2</b> After an error has occurred - <code>traceback()</code></a></li>
<li class="chapter" data-level="7.4.3" data-path="debugging.html"><a href="debugging.html#browser---debugging-your-own-code-interactively"><i class="fa fa-check"></i><b>7.4.3</b> <code>browser()</code> - debugging your own code, interactively</a></li>
<li class="chapter" data-level="7.4.4" data-path="debugging.html"><a href="debugging.html#debug---the-general-debugging-workhorse"><i class="fa fa-check"></i><b>7.4.4</b> <code>debug()</code> - the general debugging workhorse</a></li>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#try-it-out-23"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="debugging.html"><a href="debugging.html#debugging-tools-in-sas"><i class="fa fa-check"></i><b>7.5</b> Debugging Tools in SAS</a></li>
<li class="chapter" data-level="7.6" data-path="debugging.html"><a href="debugging.html#minimal-working-examples"><i class="fa fa-check"></i><b>7.6</b> Minimal Working Examples</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="debugging.html"><a href="debugging.html#example-mwes"><i class="fa fa-check"></i><b>7.6.1</b> Example: MWEs</a></li>
<li class="chapter" data-level="7.6.2" data-path="debugging.html"><a href="debugging.html#try-it-out-24"><i class="fa fa-check"></i><b>7.6.2</b> Try It Out</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-vis-intro.html"><a href="data-vis-intro.html"><i class="fa fa-check"></i><b>8</b> Introduction to Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="data-vis-intro.html"><a href="data-vis-intro.html#visualization-module-objectives"><i class="fa fa-check"></i>Visualization: Module Objectives</a></li>
<li class="chapter" data-level="8.1" data-path="data-vis-intro.html"><a href="data-vis-intro.html#why-do-we-create-graphics"><i class="fa fa-check"></i><b>8.1</b> Why do we create graphics?</a></li>
<li class="chapter" data-level="8.2" data-path="data-vis-intro.html"><a href="data-vis-intro.html#general-approaches-to-creating-graphics"><i class="fa fa-check"></i><b>8.2</b> General approaches to creating graphics</a></li>
<li class="chapter" data-level="8.3" data-path="data-vis-intro.html"><a href="data-vis-intro.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>8.3</b> The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-vis-intro.html"><a href="data-vis-intro.html#demonstration-aesthetic-mappings-and-basic-plots"><i class="fa fa-check"></i><b>8.3.1</b> Demonstration: Aesthetic Mappings and Basic Plots</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-vis-intro.html"><a href="data-vis-intro.html#syntax-and-general-structure-layers"><i class="fa fa-check"></i><b>8.3.2</b> Syntax and General Structure: Layers</a></li>
<li class="chapter" data-level="8.3.3" data-path="data-vis-intro.html"><a href="data-vis-intro.html#statistics-and-different-types-of-plots"><i class="fa fa-check"></i><b>8.3.3</b> Statistics and Different Types of Plots</a></li>
<li class="chapter" data-level="8.3.4" data-path="data-vis-intro.html"><a href="data-vis-intro.html#small-multiples"><i class="fa fa-check"></i><b>8.3.4</b> Small Multiples</a></li>
<li class="chapter" data-level="" data-path="data-vis-intro.html"><a href="data-vis-intro.html#try-it-out-28"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="data-vis-intro.html"><a href="data-vis-intro.html#good-charts"><i class="fa fa-check"></i><b>8.4</b> Good charts</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-vis-intro.html"><a href="data-vis-intro.html#perceptual-and-cognitive-factors"><i class="fa fa-check"></i><b>8.4.1</b> Perceptual and Cognitive Factors</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-vis-intro.html"><a href="data-vis-intro.html#general-guidelines-for-accuracy"><i class="fa fa-check"></i><b>8.4.2</b> General guidelines for accuracy</a></li>
<li class="chapter" data-level="8.4.3" data-path="data-vis-intro.html"><a href="data-vis-intro.html#how-do-we-know"><i class="fa fa-check"></i><b>8.4.3</b> How do we know?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-vis-intro.html"><a href="data-vis-intro.html#other-things-worth-exploring-and-future-expansions-for-this-chapter"><i class="fa fa-check"></i><b>8.5</b> Other things worth exploring (and future expansions for this chapter)</a></li>
<li class="chapter" data-level="" data-path="data-vis-intro.html"><a href="data-vis-intro.html#references-4"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="data-vis-intro.html"><a href="data-vis-intro.html#motivation"><i class="fa fa-check"></i><b>8.5.1</b> Motivation</a></li>
<li class="chapter" data-level="8.5.2" data-path="data-vis-intro.html"><a href="data-vis-intro.html#r-graphics"><i class="fa fa-check"></i><b>8.5.2</b> R graphics</a></li>
<li class="chapter" data-level="8.5.3" data-path="data-vis-intro.html"><a href="data-vis-intro.html#sas-graphics"><i class="fa fa-check"></i><b>8.5.3</b> SAS graphics</a></li>
<li class="chapter" data-level="8.5.4" data-path="data-vis-intro.html"><a href="data-vis-intro.html#types-of-charts-and-chart-styling"><i class="fa fa-check"></i><b>8.5.4</b> Types of Charts and Chart Styling</a></li>
<li class="chapter" data-level="8.5.5" data-path="data-vis-intro.html"><a href="data-vis-intro.html#other-graphics-packages"><i class="fa fa-check"></i><b>8.5.5</b> Other Graphics packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>9</b> Simulation and Reproducibility</a>
<ul>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#simulation-module-objectives"><i class="fa fa-check"></i>Simulation: Module Objectives</a></li>
<li class="chapter" data-level="9.1" data-path="simulation.html"><a href="simulation.html#pseudorandom-number-generation"><i class="fa fa-check"></i><b>9.1</b> Pseudorandom Number Generation</a></li>
<li class="chapter" data-level="9.2" data-path="simulation.html"><a href="simulation.html#built-in-simulations-from-distributions"><i class="fa fa-check"></i><b>9.2</b> Built-in simulations from distributions</a>
<ul>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#try-it-out-30"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="simulation.html"><a href="simulation.html#simulation-to-test-model-assumptions"><i class="fa fa-check"></i><b>9.3</b> Simulation to test model assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#try-it-out-31"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="simulation.html"><a href="simulation.html#monte-carlo-methods"><i class="fa fa-check"></i><b>9.4</b> Monte Carlo methods</a>
<ul>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#try-it-out-32"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="simulation.html"><a href="simulation.html#references-5"><i class="fa fa-check"></i><b>9.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="docs-reports.html"><a href="docs-reports.html"><i class="fa fa-check"></i><b>10</b> Documents and Reports</a>
<ul>
<li class="chapter" data-level="" data-path="docs-reports.html"><a href="docs-reports.html#documents-and-reports-module-objectives"><i class="fa fa-check"></i>Documents and Reports: Module Objectives</a></li>
<li class="chapter" data-level="10.1" data-path="docs-reports.html"><a href="docs-reports.html#literate-programming-knitr-and-rmarkdown"><i class="fa fa-check"></i><b>10.1</b> Literate Programming, <code>knitr</code>, and <code>rmarkdown</code></a></li>
<li class="chapter" data-level="10.2" data-path="docs-reports.html"><a href="docs-reports.html#a-very-brief-introduction-to-latex"><i class="fa fa-check"></i><b>10.2</b> A Very Brief Introduction to LaTeX</a>
<ul>
<li class="chapter" data-level="" data-path="docs-reports.html"><a href="docs-reports.html#try-it-out-33"><i class="fa fa-check"></i>Try it out</a></li>
<li class="chapter" data-level="10.2.1" data-path="docs-reports.html"><a href="docs-reports.html#knitr"><i class="fa fa-check"></i><b>10.2.1</b> Knitr</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="docs-reports.html"><a href="docs-reports.html#slides"><i class="fa fa-check"></i><b>10.3</b> Slides</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="docs-reports.html"><a href="docs-reports.html#beamer-latex-and-knitr"><i class="fa fa-check"></i><b>10.3.1</b> Beamer (LaTeX) and knitr</a></li>
<li class="chapter" data-level="10.3.2" data-path="docs-reports.html"><a href="docs-reports.html#html-slides"><i class="fa fa-check"></i><b>10.3.2</b> HTML slides</a></li>
<li class="chapter" data-level="" data-path="docs-reports.html"><a href="docs-reports.html#try-it-out-35"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="docs-reports.html"><a href="docs-reports.html#posters"><i class="fa fa-check"></i><b>10.4</b> Posters</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="docs-reports.html"><a href="docs-reports.html#latex-1"><i class="fa fa-check"></i><b>10.4.1</b> LaTeX</a></li>
<li class="chapter" data-level="10.4.2" data-path="docs-reports.html"><a href="docs-reports.html#posterdown"><i class="fa fa-check"></i><b>10.4.2</b> Posterdown</a></li>
<li class="chapter" data-level="10.4.3" data-path="docs-reports.html"><a href="docs-reports.html#pagedown"><i class="fa fa-check"></i><b>10.4.3</b> Pagedown</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="docs-reports.html"><a href="docs-reports.html#resumecv"><i class="fa fa-check"></i><b>10.5</b> Resume/CV</a></li>
<li class="chapter" data-level="10.6" data-path="docs-reports.html"><a href="docs-reports.html#using-github-pages"><i class="fa fa-check"></i><b>10.6</b> Using Github Pages</a></li>
<li class="chapter" data-level="10.7" data-path="docs-reports.html"><a href="docs-reports.html#references-6"><i class="fa fa-check"></i><b>10.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html"><i class="fa fa-check"></i><b>11</b> Animated and Interactive Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#animated-and-interactive-graphics-module-objectives"><i class="fa fa-check"></i>Animated and Interactive Graphics: Module Objectives</a></li>
<li class="chapter" data-level="11.1" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#plotly"><i class="fa fa-check"></i><b>11.1</b> Plotly</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#ggplotly-ggplot2-to-plotly-conversions"><i class="fa fa-check"></i><b>11.1.1</b> <code>ggplotly</code>: ggplot2 to plotly conversions</a></li>
<li class="chapter" data-level="11.1.2" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#plot_ly-like-base-plotting-but-interactive"><i class="fa fa-check"></i><b>11.1.2</b> <code>plot_ly</code>: Like base plotting, but interactive!</a></li>
<li class="chapter" data-level="11.1.3" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#animation"><i class="fa fa-check"></i><b>11.1.3</b> Animation</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#leaflet-maps"><i class="fa fa-check"></i><b>11.2</b> Leaflet maps</a>
<ul>
<li class="chapter" data-level="" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#try-it-out-39"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#shiny"><i class="fa fa-check"></i><b>11.3</b> Shiny</a></li>
<li class="chapter" data-level="11.4" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#general-references"><i class="fa fa-check"></i><b>11.4</b> General References</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#other-interactive-tools"><i class="fa fa-check"></i><b>11.4.1</b> Other interactive tools</a></li>
<li class="chapter" data-level="11.4.2" data-path="animated-and-interactive-graphics.html"><a href="animated-and-interactive-graphics.html#debugging-1"><i class="fa fa-check"></i><b>11.4.2</b> Debugging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html"><i class="fa fa-check"></i><b>12</b> Lists, Nested Lists, and Functional Programming</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#review-lists-and-vectors"><i class="fa fa-check"></i><b>12.1</b> Review: Lists and Vectors</a></li>
<li class="chapter" data-level="12.2" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#introduction-to-map"><i class="fa fa-check"></i><b>12.2</b> Introduction to <code>map</code></a></li>
<li class="chapter" data-level="12.3" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#creating-and-using-list-columns"><i class="fa fa-check"></i><b>12.3</b> Creating (and Using) List-columns</a></li>
<li class="chapter" data-level="12.4" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#ways-to-use-map"><i class="fa fa-check"></i><b>12.4</b> Ways to use <code>map</code></a>
<ul>
<li class="chapter" data-level="" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#try-it-out-40"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#beyond-map-functions-with-multiple-inputs"><i class="fa fa-check"></i><b>12.5</b> Beyond <code>map</code>: Functions with multiple inputs</a>
<ul>
<li class="chapter" data-level="" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#try-it-out-41"><i class="fa fa-check"></i>Try it out</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lists-nested-lists-and-functional-programming.html"><a href="lists-nested-lists-and-functional-programming.html#purrr-references"><i class="fa fa-check"></i>Purrr References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="high-performance-computing.html"><a href="high-performance-computing.html"><i class="fa fa-check"></i><b>13</b> High Performance Computing</a>
<ul>
<li class="chapter" data-level="" data-path="high-performance-computing.html"><a href="high-performance-computing.html#hpc-references"><i class="fa fa-check"></i>HPC References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="tidy-models.html"><a href="tidy-models.html"><i class="fa fa-check"></i><b>14</b> Tidy Models</a></li>
<li class="chapter" data-level="15" data-path="spatial-packages.html"><a href="spatial-packages.html"><i class="fa fa-check"></i><b>15</b> Spatial packages</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-packages.html"><a href="spatial-packages.html#references-7"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="common-problems-and-general-computing-topics.html"><a href="common-problems-and-general-computing-topics.html"><i class="fa fa-check"></i><b>16</b> Common Problems and General Computing Topics</a>
<ul>
<li class="chapter" data-level="16.1" data-path="common-problems-and-general-computing-topics.html"><a href="common-problems-and-general-computing-topics.html#file-paths-working-directories-and-reproducibility"><i class="fa fa-check"></i><b>16.1</b> File Paths, Working Directories, and Reproducibility</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="common-problems-and-general-computing-topics.html"><a href="common-problems-and-general-computing-topics.html#file-paths"><i class="fa fa-check"></i><b>16.1.1</b> File paths</a></li>
<li class="chapter" data-level="16.1.2" data-path="common-problems-and-general-computing-topics.html"><a href="common-problems-and-general-computing-topics.html#working-directory"><i class="fa fa-check"></i><b>16.1.2</b> Working Directory</a></li>
<li class="chapter" data-level="16.1.3" data-path="common-problems-and-general-computing-topics.html"><a href="common-problems-and-general-computing-topics.html#reproducibility-1"><i class="fa fa-check"></i><b>16.1.3</b> Reproducibility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="other-resources-articles-and-food-for-thought.html"><a href="other-resources-articles-and-food-for-thought.html"><i class="fa fa-check"></i><b>17</b> Other Resources, Articles, and Food for Thought</a>
<ul>
<li class="chapter" data-level="17.1" data-path="other-resources-articles-and-food-for-thought.html"><a href="other-resources-articles-and-food-for-thought.html#comparing-languages"><i class="fa fa-check"></i><b>17.1</b> Comparing Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-8.html"><a href="references-8.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat 850: Computing Tools for Statisticians</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulating-data" class="section level1" number="5">
<h1><span class="header-section-number">Module 5</span> Manipulating Data</h1>
<p>In this section, we’re going start learning how to work with data. Generally speaking, data doesn’t come in a form suitable for analysis<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> - you have to clean it up, create the variables you care about, get rid of those you don’t care about, and so on.</p>
<p>In R, we’ll be using the <code>tidyverse</code> for this. It’s a meta-package (a package that just loads other packages) that collects packages designed with the same philosophy<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> and interface (basically, the commands will use predictable argument names and structure). You’ve already been introduced to the tidyverse - specifically, <code>readr</code>.</p>
<p>In SAS, there is no tidyverse, but there is a relatively consistent structure for how to accomplish each task. Most data cleaning in SAS is accomplished in data steps. In the interests of not confusing terms too much between languages, I’m going to use the tidyverse “verbs” to describe operations in both SAS and R.</p>
<p><code>dplyr</code> (one of the packages in the tidyverse) creates a “grammar of data manipulation” to make it easier to describe different operations. I find the <code>dplyr</code> grammar to be extremely useful when talking about data operations, so I’m going to attempt to show you how to do the same operations in R with dplyr, and in SAS (without the underlying framework). Each verb describes a common task when doing both exploratory data analysis and more formal statistical modeling. In all tidyverse functions, data comes first – literally, as it’s the first argument to any function. In addition, you don’t use df$variable to access a variable - you refer to the variable by its name alone. This makes the syntax much cleaner and easier to read, which is another principle of the tidy philosophy.</p>
<div class="learn-more">
<a href="https://github.com/rstudio/cheatsheets/blob/master/data-transformation.pdf">There is an excellent dplyr cheatsheet available from RStudio</a>. You may want to print it out to have a copy to reference as you work through this chapter.
</div>
<div id="manipulating-data-module-objectives" class="section level2 unnumbered">
<h2>Manipulating Data: Module Objectives</h2>
<ul>
<li>Filter, subset, and clean data to prepare a dataset for analysis</li>
<li>Describe and document operations performed on a data set transparently, and implement the operations using reproducible steps.</li>
<li>Create summaries of data appropriate for additional analysis or display</li>
</ul>
</div>
<div id="tidy-data" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Tidy Data</h2>
<p>There are infinitely many ways to configure “messy” data, but data that is “tidy” has 3 attributes:</p>
<ol style="list-style-type: decimal">
<li>Each variable has its own column</li>
<li>Each observation has its own row</li>
<li>Each value has its own cell</li>
</ol>
<p>These attributes aren’t sufficient to define “clean” data, but they work to define “tidy” data (in the same way that you can have a “tidy” room because all of your dirty clothes are folded, but they aren’t clean just because they’re folded).</p>
<p>We’ll get more into how to work with different “messy” data configurations in the next module, but it’s worth keeping rules 1 and 3 in mind while working through this module.</p>
</div>
<div id="filter-pick-cases-rows-based-on-their-values" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Filter: Pick cases (rows) based on their values</h2>
<p>Filter allows us to work with a subset of a larger data frame, keeping only the rows we’re interested in. We provide one or more logical conditions, and only those rows which meet the logical conditions are returned from <code>filter()</code>. Note that unless we store the result from <code>filter()</code> in the original object, we don’t change the original.</p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/raw/master/rstats-artwork/dplyr_filter.jpg" alt="" />
<p class="caption">dplyr filter() by Allison Horst</p>
</div>
Let’s explore how it works, using the <code>starwars</code> dataset, which contains a comprehensive list of the characters in the Star Wars movies.
<details>
<summary>
Data set up
</summary>
<p>This data set is included in the <code>dplyr</code> package, so we load that package and then use the <code>data()</code> function to load dataset into memory. The loading isn’t complete until we actually use the dataset though… so let’s print the first few rows.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="manipulating-data.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb180-2"><a href="manipulating-data.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(starwars)</span>
<span id="cb180-3"><a href="manipulating-data.html#cb180-3" aria-hidden="true" tabindex="-1"></a>starwars</span>
<span id="cb180-4"><a href="manipulating-data.html#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 87 x 14</span></span>
<span id="cb180-5"><a href="manipulating-data.html#cb180-5" aria-hidden="true" tabindex="-1"></a>   name    height  mass hair_color  skin_color eye_color birth_year sex   gender</span>
<span id="cb180-6"><a href="manipulating-data.html#cb180-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>chr<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> </span>
<span id="cb180-7"><a href="manipulating-data.html#cb180-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Luke S…    <span class="dv">172</span>    <span class="dv">77</span> blond       fair       blue            <span class="dv">19</span>   male  mascu…</span>
<span id="cb180-8"><a href="manipulating-data.html#cb180-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> C<span class="sc">-</span>3PO      <span class="dv">167</span>    <span class="dv">75</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>        gold       yellow         <span class="dv">112</span>   none  mascu…</span>
<span id="cb180-9"><a href="manipulating-data.html#cb180-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> R2<span class="sc">-</span>D2       <span class="dv">96</span>    <span class="dv">32</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>        white, bl… red             <span class="dv">33</span>   none  mascu…</span>
<span id="cb180-10"><a href="manipulating-data.html#cb180-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Darth …    <span class="dv">202</span>   <span class="dv">136</span> none        white      yellow          <span class="fl">41.9</span> male  mascu…</span>
<span id="cb180-11"><a href="manipulating-data.html#cb180-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Leia O…    <span class="dv">150</span>    <span class="dv">49</span> brown       light      brown           <span class="dv">19</span>   fema… femin…</span>
<span id="cb180-12"><a href="manipulating-data.html#cb180-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Owen L…    <span class="dv">178</span>   <span class="dv">120</span> brown, grey light      blue            <span class="dv">52</span>   male  mascu…</span>
<span id="cb180-13"><a href="manipulating-data.html#cb180-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Beru W…    <span class="dv">165</span>    <span class="dv">75</span> brown       light      blue            <span class="dv">47</span>   fema… femin…</span>
<span id="cb180-14"><a href="manipulating-data.html#cb180-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> R5<span class="sc">-</span>D4       <span class="dv">97</span>    <span class="dv">32</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>        white, red red             <span class="cn">NA</span>   none  mascu…</span>
<span id="cb180-15"><a href="manipulating-data.html#cb180-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Biggs …    <span class="dv">183</span>    <span class="dv">84</span> black       light      brown           <span class="dv">24</span>   male  mascu…</span>
<span id="cb180-16"><a href="manipulating-data.html#cb180-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Obi<span class="sc">-</span>Wa…    <span class="dv">182</span>    <span class="dv">77</span> auburn, wh… fair       blue<span class="sc">-</span>gray       <span class="dv">57</span>   male  mascu…</span>
<span id="cb180-17"><a href="manipulating-data.html#cb180-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 77 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span></span>
<span id="cb180-18"><a href="manipulating-data.html#cb180-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></span></code></pre></div>
<p>In the interests of demonstrating the process on the same data, I’ve exported the starwars data to a CSV file using the <code>readr</code> package.</p>
<p>I had to remove the list-columns (films, vehicles, starships) because that format isn’t supported by SAS. You can access the csv data <a href="data/starwars.csv">here</a>. Note that I exported the data using ‘.’ as the NA/missing character so that it will be easy to read into SAS.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="manipulating-data.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb181-2"><a href="manipulating-data.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="do">## write_csv(starwars[,1:11], &quot;data/starwars.csv&quot;, na = &#39;.&#39;)</span></span></code></pre></div>
<p>Let’s set that data up first:</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          filename swdat &quot;data/starwars.csv&quot;;
8          
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: The SAS System stopped processing this step because of errors.
9          PROC IMPORT DATAFILE = swdat OUT = classdat.starwars
10             DBMS = CSV
11             REPLACE;
12             GETNAMES = YES;
13         RUN;
14         


15         PROC PRINT DATA=classdat.starwars (obs=10);
16         RUN;

NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13.</code></pre>
If you want to directly load the SAS datafile, you can find it <a href="sas/starwars.sas7bdat">here</a>
</details>
<p>Once the data is set up, using <code>filter</code> is actually very simple.</p>
<details>
<summary>
Demonstration of <code>filter()</code> in R
</summary>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="manipulating-data.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get only the people</span></span>
<span id="cb183-2"><a href="manipulating-data.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, species <span class="sc">==</span> <span class="st">&quot;Human&quot;</span>)</span>
<span id="cb183-3"><a href="manipulating-data.html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 35 x 14</span></span>
<span id="cb183-4"><a href="manipulating-data.html#cb183-4" aria-hidden="true" tabindex="-1"></a>   name    height  mass hair_color  skin_color eye_color birth_year sex   gender</span>
<span id="cb183-5"><a href="manipulating-data.html#cb183-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>chr<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> </span>
<span id="cb183-6"><a href="manipulating-data.html#cb183-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Luke S…    <span class="dv">172</span>    <span class="dv">77</span> blond       fair       blue            <span class="dv">19</span>   male  mascu…</span>
<span id="cb183-7"><a href="manipulating-data.html#cb183-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Darth …    <span class="dv">202</span>   <span class="dv">136</span> none        white      yellow          <span class="fl">41.9</span> male  mascu…</span>
<span id="cb183-8"><a href="manipulating-data.html#cb183-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Leia O…    <span class="dv">150</span>    <span class="dv">49</span> brown       light      brown           <span class="dv">19</span>   fema… femin…</span>
<span id="cb183-9"><a href="manipulating-data.html#cb183-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Owen L…    <span class="dv">178</span>   <span class="dv">120</span> brown, grey light      blue            <span class="dv">52</span>   male  mascu…</span>
<span id="cb183-10"><a href="manipulating-data.html#cb183-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Beru W…    <span class="dv">165</span>    <span class="dv">75</span> brown       light      blue            <span class="dv">47</span>   fema… femin…</span>
<span id="cb183-11"><a href="manipulating-data.html#cb183-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Biggs …    <span class="dv">183</span>    <span class="dv">84</span> black       light      brown           <span class="dv">24</span>   male  mascu…</span>
<span id="cb183-12"><a href="manipulating-data.html#cb183-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Obi<span class="sc">-</span>Wa…    <span class="dv">182</span>    <span class="dv">77</span> auburn, wh… fair       blue<span class="sc">-</span>gray       <span class="dv">57</span>   male  mascu…</span>
<span id="cb183-13"><a href="manipulating-data.html#cb183-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Anakin…    <span class="dv">188</span>    <span class="dv">84</span> blond       fair       blue            <span class="fl">41.9</span> male  mascu…</span>
<span id="cb183-14"><a href="manipulating-data.html#cb183-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Wilhuf…    <span class="dv">180</span>    <span class="cn">NA</span> auburn, gr… fair       blue            <span class="dv">64</span>   male  mascu…</span>
<span id="cb183-15"><a href="manipulating-data.html#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Han So…    <span class="dv">180</span>    <span class="dv">80</span> brown       fair       brown           <span class="dv">29</span>   male  mascu…</span>
<span id="cb183-16"><a href="manipulating-data.html#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 25 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span></span>
<span id="cb183-17"><a href="manipulating-data.html#cb183-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></span>
<span id="cb183-18"><a href="manipulating-data.html#cb183-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-19"><a href="manipulating-data.html#cb183-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get only the people who come from Tatooine</span></span>
<span id="cb183-20"><a href="manipulating-data.html#cb183-20" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, species <span class="sc">==</span> <span class="st">&quot;Human&quot;</span>, homeworld <span class="sc">==</span> <span class="st">&quot;Tatooine&quot;</span>)</span>
<span id="cb183-21"><a href="manipulating-data.html#cb183-21" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 8 x 14</span></span>
<span id="cb183-22"><a href="manipulating-data.html#cb183-22" aria-hidden="true" tabindex="-1"></a>  name     height  mass hair_color  skin_color eye_color birth_year sex   gender</span>
<span id="cb183-23"><a href="manipulating-data.html#cb183-23" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>chr<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> </span>
<span id="cb183-24"><a href="manipulating-data.html#cb183-24" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Luke Sk…    <span class="dv">172</span>    <span class="dv">77</span> blond       fair       blue            <span class="dv">19</span>   male  mascu…</span>
<span id="cb183-25"><a href="manipulating-data.html#cb183-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Darth V…    <span class="dv">202</span>   <span class="dv">136</span> none        white      yellow          <span class="fl">41.9</span> male  mascu…</span>
<span id="cb183-26"><a href="manipulating-data.html#cb183-26" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Owen La…    <span class="dv">178</span>   <span class="dv">120</span> brown, grey light      blue            <span class="dv">52</span>   male  mascu…</span>
<span id="cb183-27"><a href="manipulating-data.html#cb183-27" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Beru Wh…    <span class="dv">165</span>    <span class="dv">75</span> brown       light      blue            <span class="dv">47</span>   fema… femin…</span>
<span id="cb183-28"><a href="manipulating-data.html#cb183-28" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> Biggs D…    <span class="dv">183</span>    <span class="dv">84</span> black       light      brown           <span class="dv">24</span>   male  mascu…</span>
<span id="cb183-29"><a href="manipulating-data.html#cb183-29" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Anakin …    <span class="dv">188</span>    <span class="dv">84</span> blond       fair       blue            <span class="fl">41.9</span> male  mascu…</span>
<span id="cb183-30"><a href="manipulating-data.html#cb183-30" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> Shmi Sk…    <span class="dv">163</span>    <span class="cn">NA</span> black       fair       brown           <span class="dv">72</span>   fema… femin…</span>
<span id="cb183-31"><a href="manipulating-data.html#cb183-31" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> Cliegg …    <span class="dv">183</span>    <span class="cn">NA</span> brown       fair       blue            <span class="dv">82</span>   male  mascu…</span>
<span id="cb183-32"><a href="manipulating-data.html#cb183-32" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,</span></span>
<span id="cb183-33"><a href="manipulating-data.html#cb183-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   vehicles &lt;list&gt;, starships &lt;list&gt;</span></span></code></pre></div>
</details>
In SAS, as in SQL, the <code>filter()</code> operation is accomplished using a <code>where</code> clause. Multiple clauses can be connected using <code>and</code>, and compound statements can be grouped with parentheses.
<details>
<summary>
Demonstration of <code>where</code> in SAS
</summary>
<p>Rather than output the whole data table (which would take up a lot of space), I’ve linked the log file from each chunk below the chunk. If you are running this code in SAS, you should NOT copy the <code>proc printto</code> line.</p>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          /* SAS limits dataset names to 8 characters, which is super
8        ! annoying. */
9          /* Sorry the names aren&#39;t descriptive... */
10         
11         DATA tmp1; /* this is the out dataset */
12         /* By not having a library attached, SAS places this in WORK */
13         /* It&#39;s a temporary dataset */
14           set classdat.starwars;
15           where (species = &#39;Human&#39;);
16           run;

NOTE: The data set WORK.TMP1 has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13.</code></pre>
<p>See the log file <a href="other/05-filter-1.log">here</a></p>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          DATA tmp2;
9            set classdat.starwars;
10           where (species = &#39;Human&#39;) and (homeworld = &#39;Tatooine&#39;);
11           run;

NOTE: The data set WORK.TMP2 has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13.</code></pre>
See the log file <a href="other/05-filter-2.log">here</a>
</details>
<p>At this point, you’ve seen the traditional SAS Data step options, but there is another SAS PROC that may be more useful (and more similar to <code>dplyr</code>). <code>dplyr</code> was developed to provide SQL-like syntax while enabling the use of more advanced computations than are supported in SQL. While SAS doesn’t have anything quite the same as <code>dplyr</code>, it does have <a href="https://documentation.sas.com/?docsetId=sqlproc&amp;docsetTarget=p07v6ho0hymhfvn1jboqfe38jnox.htm&amp;docsetVersion=9.4&amp;locale=en">PROC SQL</a>.</p>
<details>
<summary>
SAS PROC SQL
</summary>
<p>In SQL, as in the SAS DATA step, <code>filter()</code> operations are performed using the keyword <code>WHERE</code>.</p>
<p>To limit the output I’m going to cheat a bit and use SELECT statements before I officially teach them to you - this is mostly so you don’t get a table with all 49 variables in it. Similarly, I’m limiting the dataset to the first 5 observations that meet the condition so that we don’t have to see <em>all</em> the water type pokemon.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          SELECT pokedex_number, name, type_1, type_number FROM
9        ! classdat.poke (obs=5)
10         WHERE type_1 = &quot;Water&quot;;
NOTE: Statement not executed due to NOEXEC option.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13.</code></pre>
<p>If we want to store the output of our query to a new table, we can do that by starting our query with CREATE TABLE &lt;table name&gt; AS - this creates a table with our results.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE aquapoke AS
10         SELECT pokedex_number, name, type_1, type_2, type_number FROM
10       ! classdat.poke
11         WHERE (type_1 = &quot;Water&quot; OR type_2 = &quot;Water&quot;);
NOTE: Statement not executed due to NOEXEC option.
12         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


13         PROC PRINT DATA=aquapoke (obs=10);
ERROR: File WORK.AQUAPOKE.DATA does not exist.
14         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13,14.</code></pre>
</details>
<div id="common-filter-tasks" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Common Filter() Tasks</h3>
<p>In <code>dplyr</code>, there are a few helper functions which may be useful when constructing filter statements.</p>
<details>
<summary>
<code>row_number()</code> - this is only used inside of another dplyr function (e.g. filter). You might want to keep only even rows, or only the first 10 rows in a table.
</summary>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="manipulating-data.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(poke, (<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb188-2"><a href="manipulating-data.html#cb188-2" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">filter</span>(poke, (<span class="fu">row_number</span>()<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>))<span class="sc">:</span> object <span class="st">&#39;poke&#39;</span> not found</span>
<span id="cb188-3"><a href="manipulating-data.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co"># There are several pokemon who have multiple entries in the table,</span></span>
<span id="cb188-4"><a href="manipulating-data.html#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># so the pokedex_number doesn&#39;t line up with the row number.</span></span></code></pre></div>
</details>
<details>
<summary>
<code>arrange()</code> - sort rows in the table by one or more variables
</summary>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="manipulating-data.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(poke, <span class="fu">desc</span>(total_points))</span>
<span id="cb189-2"><a href="manipulating-data.html#cb189-2" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">arrange</span>(poke, <span class="fu">desc</span>(total_points))<span class="sc">:</span> object <span class="st">&#39;poke&#39;</span> not found</span></code></pre></div>
</details>
<details>
<summary>
<code>slice_max()</code> - this will keep the top values of a specified variable.
</summary>
<p>It’s like a filter statement, but it’s a shortcut built to handle a common task. You could write a filter statement that would do this, but it would take a lot more code.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="manipulating-data.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_max</span>(poke, <span class="at">order_by =</span> total_points, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="manipulating-data.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_points)) <span class="co"># Sort decreasing</span></span>
<span id="cb190-3"><a href="manipulating-data.html#cb190-3" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">slice_max</span>(poke, <span class="at">order_by =</span> total_points, <span class="at">n =</span> <span class="dv">5</span>)<span class="sc">:</span> object <span class="st">&#39;poke&#39;</span> not found</span></code></pre></div>
<p>By default, <code>slice_max()</code> returns values tied with the nth value as well, which is why our result has 6 rows.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="manipulating-data.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_max</span>(poke, <span class="at">order_by =</span> total_points, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">with_ties =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="manipulating-data.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_points)) <span class="co"># Sort decreasing</span></span>
<span id="cb191-3"><a href="manipulating-data.html#cb191-3" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">slice_max</span>(poke, <span class="at">order_by =</span> total_points, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">with_ties =</span> F)<span class="sc">:</span> object <span class="st">&#39;poke&#39;</span> not found</span></code></pre></div>
</details>
<p>In SAS, these same tasks can sometimes require a bit more code.</p>
<details>
<summary>
Keeping only certain rows in SAS
</summary>
<p>In SAS, to use a variable, you have to define it in one data step, then make another data step in order to use that variable. But, like <code>dplyr</code>, SAS has a row number counter that we can use for this purpose.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          DATA tmp;
9          SET classdat.poke;
10           rownum=_n_; /* SAS shorthand for row number */
11         RUN;

NOTE: The data set WORK.TMP has 0 observations and 50 variables.
WARNING: Data set WORK.TMP was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12         
13         DATA evenrow;
14           SET WORK.tmp;
15           WHERE MOD(rownum, 2) = 0;
ERROR: Variable rownum is not on file WORK.TMP.
16           DROP rownum; /* ditch temp variable */
17         RUN;

WARNING: The variable rownum in the DROP, KEEP, or RENAME list has never 
         been referenced.
NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.EVENROW may be incomplete.  When this step was 
         stopped there were 0 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13,15.</code></pre>
</details>
<details>
<summary>
Top N values
</summary>
<p>We’re going to want to use PROC SORT to get the data arranged before we take the top N values.
According to <a href="https://communities.sas.com/t5/General-SAS-Programming/if-and-where-statement-for-n/td-p/237647">this</a>, we can’t use <code>_n_</code> in a where statement, and the proposed solution isn’t reliable. So we’ll do it the long way.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          PROC SORT DATA = classdat.poke
9            OUT = pokesort;
10           BY descending total_points;
11         RUN;

NOTE: The data set WORK.POKESORT has 0 observations and 0 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12         
13         DATA poken;
14           SET WORK.pokesort;
15           rownum = _n_;
16         RUN;

NOTE: The data set WORK.POKEN has 0 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

17         
18         DATA poken;
19           SET WORK.poken;
20           WHERE rownum &lt;= 5;
21           DROP rownum;
22         RUN;

NOTE: The data set WORK.POKEN has 0 observations and 0 variables.
WARNING: Data set WORK.POKEN was not replaced because this step was 
         stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

23         
24         PROC PRINT DATA = poken;
25           VAR pokedex_number name status species type_1 total_points;
ERROR: Variable POKEDEX_NUMBER not found.
ERROR: Variable NAME not found.
ERROR: Variable STATUS not found.
ERROR: Variable SPECIES not found.
ERROR: Variable TYPE_1 not found.
ERROR: Variable TOTAL_POINTS not found.
26         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13,15.</code></pre>
</details>
<p>In both cases, the SAS statements required to perform the task require a WHERE clause, but also a few other statements to get things working. The equivalent base R code would be about the same (though tricky in different spots).</p>
<div class="my-opinion">
<p>The thing that makes the <code>tidyverse</code> philosophy so addictive is that it makes these common, everyday tasks both easy and concise (that is, few lines of code are required).</p>
</div>
<details>
<summary>
PROC SQL filter statements
</summary>
<p>SQL doesn’t have an intrinsic notion of ordered rows, so in order to select even rows, we need to create a temporary dataset with <code>_n_</code> copied into a variable (just like last time).</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          DATA poke;
9            SET classdat.poke;
10           rownum=_n_;
11         RUN;

NOTE: The data set WORK.POKE has 0 observations and 50 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12         
13         PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
14         SELECT * FROM poke(obs=5)
15         WHERE mod(rownum, 2) = 0;
NOTE: Statement not executed due to NOEXEC option.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 4,5,7,11,12,13,15,16.</code></pre>
<p>SELECT * says to select all variables. We’ll talk about SELECT in the next section, but with SQL it’s not reqlly possible to avoid using SELECT.</p>
<p>If we want the 5 pokemon with the highest total points, we can use ORDER BY to sort the table, and then specify that we only want 5 rows.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          SELECT pokedex_number, name, status, species, type_1,
9        ! total_points
10         FROM classdat.poke(obs=5)
11         ORDER BY total_points DESC;
NOTE: Data file CLASSDAT.POKE.DATA is in a format that is native to 
      another host, or the file encoding does not match the session 
      encoding. Cross Environment Data Access will be used, which might 
      require additional CPU resources and might reduce performance.
NOTE: Statement not executed due to NOEXEC option.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12.</code></pre>
<p>As a reminder, if we want to store this new data into a new dataset, we have to start our statement with CREATE TABLE <tablename> AS, and then follow the statement with our query.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE poketmp AS
10         SELECT pokedex_number, name, status, species, type_1,
10       ! total_points
11         FROM classdat.poke(obs=5)
12         ORDER BY total_points DESC;
NOTE: Statement not executed due to NOEXEC option.
13         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


14         PROC PRINT DATA=poketmp;
ERROR: File WORK.POKETMP.DATA does not exist.
15         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12.</code></pre>
</details>
</div>
<div id="try-it-out-15" class="section level3 unnumbered tryitout">
<h3>Try it out</h3>
<p>Using the pokemon data, can you create a new data set or data frame (SAS and R, respectively) that has only water type pokemon? Can you write a filter statement that looks for any pokemon which has water type for either type1 or type2?</p>
<details>
<summary>
R
</summary>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="manipulating-data.html#cb197-1" aria-hidden="true" tabindex="-1"></a>poke <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/pokemon_ascii.csv&quot;</span>)</span>
<span id="cb197-2"><a href="manipulating-data.html#cb197-2" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> <span class="dv">1</span> parsing failure.</span>
<span id="cb197-3"><a href="manipulating-data.html#cb197-3" aria-hidden="true" tabindex="-1"></a> row       col expected actual                     file</span>
<span id="cb197-4"><a href="manipulating-data.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1028</span> weight_kg a double      . <span class="st">&#39;data/pokemon_ascii.csv&#39;</span></span>
<span id="cb197-5"><a href="manipulating-data.html#cb197-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-6"><a href="manipulating-data.html#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(poke, type_1 <span class="sc">==</span> <span class="st">&quot;Water&quot;</span>)</span>
<span id="cb197-7"><a href="manipulating-data.html#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 134 x 49</span></span>
<span id="cb197-8"><a href="manipulating-data.html#cb197-8" aria-hidden="true" tabindex="-1"></a>   pokedex_number name  german_name generation status species type_number type_1</span>
<span id="cb197-9"><a href="manipulating-data.html#cb197-9" aria-hidden="true" tabindex="-1"></a>            <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>            <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>         <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> </span>
<span id="cb197-10"><a href="manipulating-data.html#cb197-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>              <span class="dv">7</span> Squi… Schiggy              <span class="dv">1</span> Normal Tiny T…           <span class="dv">1</span> Water </span>
<span id="cb197-11"><a href="manipulating-data.html#cb197-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>              <span class="dv">8</span> Wart… Schillok             <span class="dv">1</span> Normal Turtle…           <span class="dv">1</span> Water </span>
<span id="cb197-12"><a href="manipulating-data.html#cb197-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>              <span class="dv">9</span> Blas… Turtok               <span class="dv">1</span> Normal Shellf…           <span class="dv">1</span> Water </span>
<span id="cb197-13"><a href="manipulating-data.html#cb197-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>              <span class="dv">9</span> Mega… Turtok               <span class="dv">1</span> Normal Shellf…           <span class="dv">1</span> Water </span>
<span id="cb197-14"><a href="manipulating-data.html#cb197-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>             <span class="dv">54</span> Psyd… Enton                <span class="dv">1</span> Normal Duck P…           <span class="dv">1</span> Water </span>
<span id="cb197-15"><a href="manipulating-data.html#cb197-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>             <span class="dv">55</span> Gold… Entoron              <span class="dv">1</span> Normal Duck P…           <span class="dv">1</span> Water </span>
<span id="cb197-16"><a href="manipulating-data.html#cb197-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>             <span class="dv">60</span> Poli… Quapsel              <span class="dv">1</span> Normal Tadpol…           <span class="dv">1</span> Water </span>
<span id="cb197-17"><a href="manipulating-data.html#cb197-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>             <span class="dv">61</span> Poli… Quaputzi             <span class="dv">1</span> Normal Tadpol…           <span class="dv">1</span> Water </span>
<span id="cb197-18"><a href="manipulating-data.html#cb197-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>             <span class="dv">62</span> Poli… Quappo               <span class="dv">1</span> Normal Tadpol…           <span class="dv">2</span> Water </span>
<span id="cb197-19"><a href="manipulating-data.html#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>             <span class="dv">72</span> Tent… Tentacha             <span class="dv">1</span> Normal Jellyf…           <span class="dv">2</span> Water </span>
<span id="cb197-20"><a href="manipulating-data.html#cb197-20" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 124 more rows, and 41 more variables: type_2 &lt;chr&gt;, height_m &lt;dbl&gt;,</span></span>
<span id="cb197-21"><a href="manipulating-data.html#cb197-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   weight_kg &lt;dbl&gt;, abilities_number &lt;dbl&gt;, ability_1 &lt;chr&gt;, ability_2 &lt;chr&gt;,</span></span>
<span id="cb197-22"><a href="manipulating-data.html#cb197-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   ability_hidden &lt;chr&gt;, total_points &lt;dbl&gt;, hp &lt;dbl&gt;, attack &lt;dbl&gt;,</span></span>
<span id="cb197-23"><a href="manipulating-data.html#cb197-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   defense &lt;dbl&gt;, sp_attack &lt;dbl&gt;, sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;,</span></span>
<span id="cb197-24"><a href="manipulating-data.html#cb197-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   catch_rate &lt;chr&gt;, base_friendship &lt;chr&gt;, base_experience &lt;chr&gt;,</span></span>
<span id="cb197-25"><a href="manipulating-data.html#cb197-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   growth_rate &lt;chr&gt;, egg_type_number &lt;dbl&gt;, egg_type_1 &lt;chr&gt;,</span></span>
<span id="cb197-26"><a href="manipulating-data.html#cb197-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   egg_type_2 &lt;chr&gt;, percentage_male &lt;chr&gt;, egg_cycles &lt;chr&gt;,</span></span>
<span id="cb197-27"><a href="manipulating-data.html#cb197-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_normal &lt;dbl&gt;, against_fire &lt;dbl&gt;, against_water &lt;dbl&gt;,</span></span>
<span id="cb197-28"><a href="manipulating-data.html#cb197-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_electric &lt;dbl&gt;, against_grass &lt;dbl&gt;, against_ice &lt;dbl&gt;,</span></span>
<span id="cb197-29"><a href="manipulating-data.html#cb197-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_fight &lt;dbl&gt;, against_poison &lt;dbl&gt;, against_ground &lt;dbl&gt;,</span></span>
<span id="cb197-30"><a href="manipulating-data.html#cb197-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_flying &lt;dbl&gt;, against_psychic &lt;dbl&gt;, against_bug &lt;dbl&gt;,</span></span>
<span id="cb197-31"><a href="manipulating-data.html#cb197-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_rock &lt;dbl&gt;, against_ghost &lt;dbl&gt;, against_dragon &lt;dbl&gt;,</span></span>
<span id="cb197-32"><a href="manipulating-data.html#cb197-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_dark &lt;dbl&gt;, against_steel &lt;dbl&gt;, against_fairy &lt;dbl&gt;</span></span>
<span id="cb197-33"><a href="manipulating-data.html#cb197-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-34"><a href="manipulating-data.html#cb197-34" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(poke, type_1 <span class="sc">==</span> <span class="st">&quot;Water&quot;</span> <span class="sc">|</span> type_2 <span class="sc">==</span> <span class="st">&quot;Water&quot;</span>)</span>
<span id="cb197-35"><a href="manipulating-data.html#cb197-35" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 153 x 49</span></span>
<span id="cb197-36"><a href="manipulating-data.html#cb197-36" aria-hidden="true" tabindex="-1"></a>   pokedex_number name  german_name generation status species type_number type_1</span>
<span id="cb197-37"><a href="manipulating-data.html#cb197-37" aria-hidden="true" tabindex="-1"></a>            <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>            <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>         <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> </span>
<span id="cb197-38"><a href="manipulating-data.html#cb197-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>              <span class="dv">7</span> Squi… Schiggy              <span class="dv">1</span> Normal Tiny T…           <span class="dv">1</span> Water </span>
<span id="cb197-39"><a href="manipulating-data.html#cb197-39" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>              <span class="dv">8</span> Wart… Schillok             <span class="dv">1</span> Normal Turtle…           <span class="dv">1</span> Water </span>
<span id="cb197-40"><a href="manipulating-data.html#cb197-40" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>              <span class="dv">9</span> Blas… Turtok               <span class="dv">1</span> Normal Shellf…           <span class="dv">1</span> Water </span>
<span id="cb197-41"><a href="manipulating-data.html#cb197-41" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>              <span class="dv">9</span> Mega… Turtok               <span class="dv">1</span> Normal Shellf…           <span class="dv">1</span> Water </span>
<span id="cb197-42"><a href="manipulating-data.html#cb197-42" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>             <span class="dv">54</span> Psyd… Enton                <span class="dv">1</span> Normal Duck P…           <span class="dv">1</span> Water </span>
<span id="cb197-43"><a href="manipulating-data.html#cb197-43" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>             <span class="dv">55</span> Gold… Entoron              <span class="dv">1</span> Normal Duck P…           <span class="dv">1</span> Water </span>
<span id="cb197-44"><a href="manipulating-data.html#cb197-44" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>             <span class="dv">60</span> Poli… Quapsel              <span class="dv">1</span> Normal Tadpol…           <span class="dv">1</span> Water </span>
<span id="cb197-45"><a href="manipulating-data.html#cb197-45" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>             <span class="dv">61</span> Poli… Quaputzi             <span class="dv">1</span> Normal Tadpol…           <span class="dv">1</span> Water </span>
<span id="cb197-46"><a href="manipulating-data.html#cb197-46" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>             <span class="dv">62</span> Poli… Quappo               <span class="dv">1</span> Normal Tadpol…           <span class="dv">2</span> Water </span>
<span id="cb197-47"><a href="manipulating-data.html#cb197-47" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>             <span class="dv">72</span> Tent… Tentacha             <span class="dv">1</span> Normal Jellyf…           <span class="dv">2</span> Water </span>
<span id="cb197-48"><a href="manipulating-data.html#cb197-48" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 143 more rows, and 41 more variables: type_2 &lt;chr&gt;, height_m &lt;dbl&gt;,</span></span>
<span id="cb197-49"><a href="manipulating-data.html#cb197-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   weight_kg &lt;dbl&gt;, abilities_number &lt;dbl&gt;, ability_1 &lt;chr&gt;, ability_2 &lt;chr&gt;,</span></span>
<span id="cb197-50"><a href="manipulating-data.html#cb197-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   ability_hidden &lt;chr&gt;, total_points &lt;dbl&gt;, hp &lt;dbl&gt;, attack &lt;dbl&gt;,</span></span>
<span id="cb197-51"><a href="manipulating-data.html#cb197-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   defense &lt;dbl&gt;, sp_attack &lt;dbl&gt;, sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;,</span></span>
<span id="cb197-52"><a href="manipulating-data.html#cb197-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   catch_rate &lt;chr&gt;, base_friendship &lt;chr&gt;, base_experience &lt;chr&gt;,</span></span>
<span id="cb197-53"><a href="manipulating-data.html#cb197-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   growth_rate &lt;chr&gt;, egg_type_number &lt;dbl&gt;, egg_type_1 &lt;chr&gt;,</span></span>
<span id="cb197-54"><a href="manipulating-data.html#cb197-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   egg_type_2 &lt;chr&gt;, percentage_male &lt;chr&gt;, egg_cycles &lt;chr&gt;,</span></span>
<span id="cb197-55"><a href="manipulating-data.html#cb197-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_normal &lt;dbl&gt;, against_fire &lt;dbl&gt;, against_water &lt;dbl&gt;,</span></span>
<span id="cb197-56"><a href="manipulating-data.html#cb197-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_electric &lt;dbl&gt;, against_grass &lt;dbl&gt;, against_ice &lt;dbl&gt;,</span></span>
<span id="cb197-57"><a href="manipulating-data.html#cb197-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_fight &lt;dbl&gt;, against_poison &lt;dbl&gt;, against_ground &lt;dbl&gt;,</span></span>
<span id="cb197-58"><a href="manipulating-data.html#cb197-58" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_flying &lt;dbl&gt;, against_psychic &lt;dbl&gt;, against_bug &lt;dbl&gt;,</span></span>
<span id="cb197-59"><a href="manipulating-data.html#cb197-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_rock &lt;dbl&gt;, against_ghost &lt;dbl&gt;, against_dragon &lt;dbl&gt;,</span></span>
<span id="cb197-60"><a href="manipulating-data.html#cb197-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   against_dark &lt;dbl&gt;, against_steel &lt;dbl&gt;, against_fairy &lt;dbl&gt;</span></span>
<span id="cb197-61"><a href="manipulating-data.html#cb197-61" aria-hidden="true" tabindex="-1"></a><span class="co"># The conditions have to be separated by |, which means &quot;or&quot;</span></span></code></pre></div>
</details>
<details>
<summary>
SAS DATA Step
</summary>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          DATA water1;
9          SET classdat.poke;
10         WHERE type_1 = &quot;Water&quot;;
11         RUN;

NOTE: The data set WORK.WATER1 has 0 observations and 49 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12         
13         DATA water2;
14         SET classdat.poke;
15         WHERE (type_1 = &quot;Water&quot; OR type_2 = &quot;Water&quot;);
16         RUN;

NOTE: The data set WORK.WATER2 has 0 observations and 49 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
<p>In the interests of only showing the parts of the log that are useful, I’ve just pasted them into this chunk. Not reproducible, but faster to read.</p>
<pre><code>NOTE: There were 134 observations read from the data set CLASSDAT.POKE.
      WHERE type_1=&#39;Water&#39;;
NOTE: The data set WORK.WATER1 has 134 observations and 49 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds

NOTE: There were 153 observations read from the data set CLASSDAT.POKE.
      WHERE (type_1=&#39;Water&#39;) or (type_2=&#39;Water&#39;);
NOTE: The data set WORK.WATER2 has 153 observations and 49 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds</code></pre>
</details>
</div>
</div>
<div id="select-pick-columns" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Select: Pick columns</h2>
<p>Sometimes, we don’t want to work with a set of 50 variables when we’re only interested in 5. When that happens, we might be able to pick the variables we want by index (e.g. <code>df[, c(1, 3, 5)]</code>, or VAR statements, but that can get tedious).</p>
<p>In <code>dplyr</code>, the function to pick a few columns is <code>select()</code>. The syntax from the help file (<code>?select</code>) looks deceptively simple.</p>
<blockquote>
<p>select(.data, …)</p>
</blockquote>
<p>So as with just about every other tidyverse function, the first argument in a select statement is the data. After that, though, you can put just about anything that R can interpret. <code>...</code> means something along the lines of “put in any additional arguments that make sense in context or might be passed on to other functions.”</p>
<p>So what can go in there?</p>
<details>
<summary>
An exhaustive list of ways to select variables in <code>dplyr</code>
</summary>
<p>First, dplyr aims to work with standard R syntax, making it intuitive (and also, making it work with variable names instead of just variable indices).<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a> Most <code>dplyr</code> commands work with “bare” variable names - you don’t need to put the variable name in quotes to reference it. There are a few exceptions to this rule, but they’re very explicitly exceptions.</p>
<ul>
<li><p><code>var3:var5</code>: <code>select(df, var3:var5)</code> will give you a data frame with columns var3, anything between var3 and var 5, and var5</p></li>
<li><p><code>!(&lt;set of variables&gt;)</code> will give you any columns that aren’t in the set of variables in parentheses</p>
<ul>
<li><code>(&lt;set of vars 1&gt;) &amp; (&lt;set of vars 2&gt;)</code> will give you any variables that are in both set 1 and set 2. <code>(&lt;set of vars 1&gt;) | (&lt;set of vars 2&gt;)</code> will give you any variables that are in either set 1 or set 2.</li>
<li><code>c()</code> combines sets of variables.</li>
</ul></li>
</ul>
<p><code>dplyr</code> also defines a lot of variable selection “helpers” that can be used inside <code>select()</code> statements. These statements work with bare column names (so you don’t have to put quotes around the column names when you use them).</p>
<ul>
<li><code>everything()</code> matches all variables</li>
<li><code>last_col()</code> matches the last variable. <code>last_col(offset = n)</code> selects the n-th to last variable.</li>
<li><code>starts_with("xyz")</code> will match any columns with names that start with xyz. Similarly, <code>ends_with()</code> does exactly what you’d expect as well.</li>
<li><code>contains("xyz")</code> will match any columns with names containing the literal string “xyz.” Note, <code>contains</code> does not work with regular expressions (you don’t need to know what that means right now).</li>
<li><code>matches(regex)</code> takes a regular expression as an argument and returns all columns matching that expression.</li>
<li><code>num_range(prefix, range)</code> selects any columns that start with prefix and have numbers matching the provided numerical range.</li>
</ul>
<p>There are also selectors that deal with character vectors. These can be useful if you have a list of important variables and want to just keep those variables.</p>
<ul>
<li><code>all_of(char)</code> matches all variable names in the character vector <code>char</code>. If one of the variables doesn’t exist, this will return an error.</li>
<li><code>any_of(char)</code> matches the contents of the character vector <code>char</code>, but does not throw an error if the variable doesn’t exist in the data set.</li>
</ul>
<p>There’s one final selector -</p>
<ul>
<li><code>where()</code> applies a function to each variable and selects those for which the function returns TRUE. This provides a lot of flexibility and opportunity to be creative (but I’ve never actually needed to use it).</li>
</ul>
</details>
<details>
<summary>
Let’s try these selector functions out and see what we can accomplish!
</summary>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="manipulating-data.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;nycflights13&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(<span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb200-2"><a href="manipulating-data.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb200-3"><a href="manipulating-data.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(flights)</span>
<span id="cb200-4"><a href="manipulating-data.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(flights)</span>
<span id="cb200-5"><a href="manipulating-data.html#cb200-5" aria-hidden="true" tabindex="-1"></a>tibble[,<span class="dv">19</span>] [<span class="dv">336</span>,<span class="dv">776</span> × <span class="dv">19</span>] (S3<span class="sc">:</span> tbl_df<span class="sc">/</span>tbl<span class="sc">/</span>data.frame)</span>
<span id="cb200-6"><a href="manipulating-data.html#cb200-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> year          <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> <span class="dv">2013</span> ...</span>
<span id="cb200-7"><a href="manipulating-data.html#cb200-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> month         <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb200-8"><a href="manipulating-data.html#cb200-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> day           <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb200-9"><a href="manipulating-data.html#cb200-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> dep_time      <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">517</span> <span class="dv">533</span> <span class="dv">542</span> <span class="dv">544</span> <span class="dv">554</span> <span class="dv">554</span> <span class="dv">555</span> <span class="dv">557</span> <span class="dv">557</span> <span class="dv">558</span> ...</span>
<span id="cb200-10"><a href="manipulating-data.html#cb200-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> sched_dep_time<span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">515</span> <span class="dv">529</span> <span class="dv">540</span> <span class="dv">545</span> <span class="dv">600</span> <span class="dv">558</span> <span class="dv">600</span> <span class="dv">600</span> <span class="dv">600</span> <span class="dv">600</span> ...</span>
<span id="cb200-11"><a href="manipulating-data.html#cb200-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> dep_delay     <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">2</span> <span class="dv">4</span> <span class="dv">2</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span><span class="dv">6</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">-</span><span class="dv">2</span> ...</span>
<span id="cb200-12"><a href="manipulating-data.html#cb200-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> arr_time      <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">830</span> <span class="dv">850</span> <span class="dv">923</span> <span class="dv">1004</span> <span class="dv">812</span> <span class="dv">740</span> <span class="dv">913</span> <span class="dv">709</span> <span class="dv">838</span> <span class="dv">753</span> ...</span>
<span id="cb200-13"><a href="manipulating-data.html#cb200-13" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> sched_arr_time<span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">819</span> <span class="dv">830</span> <span class="dv">850</span> <span class="dv">1022</span> <span class="dv">837</span> <span class="dv">728</span> <span class="dv">854</span> <span class="dv">723</span> <span class="dv">846</span> <span class="dv">745</span> ...</span>
<span id="cb200-14"><a href="manipulating-data.html#cb200-14" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> arr_delay     <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">11</span> <span class="dv">20</span> <span class="dv">33</span> <span class="sc">-</span><span class="dv">18</span> <span class="sc">-</span><span class="dv">25</span> <span class="dv">12</span> <span class="dv">19</span> <span class="sc">-</span><span class="dv">14</span> <span class="sc">-</span><span class="dv">8</span> <span class="dv">8</span> ...</span>
<span id="cb200-15"><a href="manipulating-data.html#cb200-15" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> carrier       <span class="sc">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="st">&quot;UA&quot;</span> <span class="st">&quot;UA&quot;</span> <span class="st">&quot;AA&quot;</span> <span class="st">&quot;B6&quot;</span> ...</span>
<span id="cb200-16"><a href="manipulating-data.html#cb200-16" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> flight        <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">1545</span> <span class="dv">1714</span> <span class="dv">1141</span> <span class="dv">725</span> <span class="dv">461</span> <span class="dv">1696</span> <span class="dv">507</span> <span class="dv">5708</span> <span class="dv">79</span> <span class="dv">301</span> ...</span>
<span id="cb200-17"><a href="manipulating-data.html#cb200-17" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tailnum       <span class="sc">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="st">&quot;N14228&quot;</span> <span class="st">&quot;N24211&quot;</span> <span class="st">&quot;N619AA&quot;</span> <span class="st">&quot;N804JB&quot;</span> ...</span>
<span id="cb200-18"><a href="manipulating-data.html#cb200-18" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> origin        <span class="sc">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="st">&quot;EWR&quot;</span> <span class="st">&quot;LGA&quot;</span> <span class="st">&quot;JFK&quot;</span> <span class="st">&quot;JFK&quot;</span> ...</span>
<span id="cb200-19"><a href="manipulating-data.html#cb200-19" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> dest          <span class="sc">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="st">&quot;IAH&quot;</span> <span class="st">&quot;IAH&quot;</span> <span class="st">&quot;MIA&quot;</span> <span class="st">&quot;BQN&quot;</span> ...</span>
<span id="cb200-20"><a href="manipulating-data.html#cb200-20" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> air_time      <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">227</span> <span class="dv">227</span> <span class="dv">160</span> <span class="dv">183</span> <span class="dv">116</span> <span class="dv">150</span> <span class="dv">158</span> <span class="dv">53</span> <span class="dv">140</span> <span class="dv">138</span> ...</span>
<span id="cb200-21"><a href="manipulating-data.html#cb200-21" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> distance      <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">1400</span> <span class="dv">1416</span> <span class="dv">1089</span> <span class="dv">1576</span> <span class="dv">762</span> ...</span>
<span id="cb200-22"><a href="manipulating-data.html#cb200-22" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> hour          <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">6</span> ...</span>
<span id="cb200-23"><a href="manipulating-data.html#cb200-23" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> minute        <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>] <span class="dv">15</span> <span class="dv">29</span> <span class="dv">40</span> <span class="dv">45</span> <span class="dv">0</span> <span class="dv">58</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb200-24"><a href="manipulating-data.html#cb200-24" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> time_hour     <span class="sc">:</span> POSIXct[<span class="dv">1</span><span class="sc">:</span><span class="dv">336776</span>], format<span class="sc">:</span> <span class="st">&quot;2013-01-01 05:00:00&quot;</span> <span class="st">&quot;2013-01-01 05:00:00&quot;</span> ...</span></code></pre></div>
<p>We’ll start out with the <code>nycflights13</code> package, which contains information on all flights that left a NYC airport to destinations in the US, Puerto Rico, and the US Virgin Islands.</p>
<div class="tryitout">
<p>You might want to try out your EDA skills from the previous module to see what you can find out about the dataset, before seeing how <code>select()</code> works.</p>
</div>
<p>We could get a data frame of departure information for each flight:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="manipulating-data.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, flight, year<span class="sc">:</span>day, tailnum, origin, <span class="fu">matches</span>(<span class="st">&quot;dep&quot;</span>))</span>
<span id="cb201-2"><a href="manipulating-data.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 336,776 x 9</span></span>
<span id="cb201-3"><a href="manipulating-data.html#cb201-3" aria-hidden="true" tabindex="-1"></a>   flight  year month   day tailnum origin dep_time sched_dep_time dep_delay</span>
<span id="cb201-4"><a href="manipulating-data.html#cb201-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb201-5"><a href="manipulating-data.html#cb201-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>   <span class="dv">1545</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N14228  EWR         <span class="dv">517</span>            <span class="dv">515</span>         <span class="dv">2</span></span>
<span id="cb201-6"><a href="manipulating-data.html#cb201-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>   <span class="dv">1714</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N24211  LGA         <span class="dv">533</span>            <span class="dv">529</span>         <span class="dv">4</span></span>
<span id="cb201-7"><a href="manipulating-data.html#cb201-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>   <span class="dv">1141</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N619AA  JFK         <span class="dv">542</span>            <span class="dv">540</span>         <span class="dv">2</span></span>
<span id="cb201-8"><a href="manipulating-data.html#cb201-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>    <span class="dv">725</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N804JB  JFK         <span class="dv">544</span>            <span class="dv">545</span>        <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb201-9"><a href="manipulating-data.html#cb201-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>    <span class="dv">461</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N668DN  LGA         <span class="dv">554</span>            <span class="dv">600</span>        <span class="sc">-</span><span class="dv">6</span></span>
<span id="cb201-10"><a href="manipulating-data.html#cb201-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>   <span class="dv">1696</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N39463  EWR         <span class="dv">554</span>            <span class="dv">558</span>        <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb201-11"><a href="manipulating-data.html#cb201-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>    <span class="dv">507</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N516JB  EWR         <span class="dv">555</span>            <span class="dv">600</span>        <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb201-12"><a href="manipulating-data.html#cb201-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>   <span class="dv">5708</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N829AS  LGA         <span class="dv">557</span>            <span class="dv">600</span>        <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb201-13"><a href="manipulating-data.html#cb201-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>     <span class="dv">79</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N593JB  JFK         <span class="dv">557</span>            <span class="dv">600</span>        <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb201-14"><a href="manipulating-data.html#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">301</span>  <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span> N3ALAA  LGA         <span class="dv">558</span>            <span class="dv">600</span>        <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb201-15"><a href="manipulating-data.html#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 336,766 more rows</span></span></code></pre></div>
<p>Perhaps we want the plane and flight ID information to be the first columns:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="manipulating-data.html#cb202-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="manipulating-data.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carrier<span class="sc">:</span>dest, <span class="fu">everything</span>())</span>
<span id="cb202-3"><a href="manipulating-data.html#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 336,776 x 19</span></span>
<span id="cb202-4"><a href="manipulating-data.html#cb202-4" aria-hidden="true" tabindex="-1"></a>   carrier flight tailnum origin dest   year month   day dep_time sched_dep_time</span>
<span id="cb202-5"><a href="manipulating-data.html#cb202-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb202-6"><a href="manipulating-data.html#cb202-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> UA        <span class="dv">1545</span> N14228  EWR    IAH    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">517</span>            <span class="dv">515</span></span>
<span id="cb202-7"><a href="manipulating-data.html#cb202-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> UA        <span class="dv">1714</span> N24211  LGA    IAH    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">533</span>            <span class="dv">529</span></span>
<span id="cb202-8"><a href="manipulating-data.html#cb202-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> AA        <span class="dv">1141</span> N619AA  JFK    MIA    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">542</span>            <span class="dv">540</span></span>
<span id="cb202-9"><a href="manipulating-data.html#cb202-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> B6         <span class="dv">725</span> N804JB  JFK    BQN    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">544</span>            <span class="dv">545</span></span>
<span id="cb202-10"><a href="manipulating-data.html#cb202-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> DL         <span class="dv">461</span> N668DN  LGA    ATL    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">554</span>            <span class="dv">600</span></span>
<span id="cb202-11"><a href="manipulating-data.html#cb202-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> UA        <span class="dv">1696</span> N39463  EWR    ORD    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">554</span>            <span class="dv">558</span></span>
<span id="cb202-12"><a href="manipulating-data.html#cb202-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> B6         <span class="dv">507</span> N516JB  EWR    FLL    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">555</span>            <span class="dv">600</span></span>
<span id="cb202-13"><a href="manipulating-data.html#cb202-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> EV        <span class="dv">5708</span> N829AS  LGA    IAD    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">557</span>            <span class="dv">600</span></span>
<span id="cb202-14"><a href="manipulating-data.html#cb202-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> B6          <span class="dv">79</span> N593JB  JFK    MCO    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">557</span>            <span class="dv">600</span></span>
<span id="cb202-15"><a href="manipulating-data.html#cb202-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> AA         <span class="dv">301</span> N3ALAA  LGA    ORD    <span class="dv">2013</span>     <span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">558</span>            <span class="dv">600</span></span>
<span id="cb202-16"><a href="manipulating-data.html#cb202-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 336,766 more rows, and 9 more variables: dep_delay &lt;dbl&gt;,</span></span>
<span id="cb202-17"><a href="manipulating-data.html#cb202-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   arr_time &lt;int&gt;, sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, air_time &lt;dbl&gt;,</span></span>
<span id="cb202-18"><a href="manipulating-data.html#cb202-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>Note that <code>everything()</code> won’t duplicate columns you’ve already added.</p>
<p>Exploring the difference between bare name selection and <code>all_of()</code>/<code>any_of()</code></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="manipulating-data.html#cb203-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb203-2"><a href="manipulating-data.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carrier, flight, tailnum, <span class="fu">matches</span>(<span class="st">&quot;time&quot;</span>))</span>
<span id="cb203-3"><a href="manipulating-data.html#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 336,776 x 9</span></span>
<span id="cb203-4"><a href="manipulating-data.html#cb203-4" aria-hidden="true" tabindex="-1"></a>   carrier flight tailnum dep_time sched_dep_time arr_time sched_arr_time</span>
<span id="cb203-5"><a href="manipulating-data.html#cb203-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb203-6"><a href="manipulating-data.html#cb203-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> UA        <span class="dv">1545</span> N14228       <span class="dv">517</span>            <span class="dv">515</span>      <span class="dv">830</span>            <span class="dv">819</span></span>
<span id="cb203-7"><a href="manipulating-data.html#cb203-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> UA        <span class="dv">1714</span> N24211       <span class="dv">533</span>            <span class="dv">529</span>      <span class="dv">850</span>            <span class="dv">830</span></span>
<span id="cb203-8"><a href="manipulating-data.html#cb203-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> AA        <span class="dv">1141</span> N619AA       <span class="dv">542</span>            <span class="dv">540</span>      <span class="dv">923</span>            <span class="dv">850</span></span>
<span id="cb203-9"><a href="manipulating-data.html#cb203-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> B6         <span class="dv">725</span> N804JB       <span class="dv">544</span>            <span class="dv">545</span>     <span class="dv">1004</span>           <span class="dv">1022</span></span>
<span id="cb203-10"><a href="manipulating-data.html#cb203-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> DL         <span class="dv">461</span> N668DN       <span class="dv">554</span>            <span class="dv">600</span>      <span class="dv">812</span>            <span class="dv">837</span></span>
<span id="cb203-11"><a href="manipulating-data.html#cb203-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> UA        <span class="dv">1696</span> N39463       <span class="dv">554</span>            <span class="dv">558</span>      <span class="dv">740</span>            <span class="dv">728</span></span>
<span id="cb203-12"><a href="manipulating-data.html#cb203-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> B6         <span class="dv">507</span> N516JB       <span class="dv">555</span>            <span class="dv">600</span>      <span class="dv">913</span>            <span class="dv">854</span></span>
<span id="cb203-13"><a href="manipulating-data.html#cb203-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> EV        <span class="dv">5708</span> N829AS       <span class="dv">557</span>            <span class="dv">600</span>      <span class="dv">709</span>            <span class="dv">723</span></span>
<span id="cb203-14"><a href="manipulating-data.html#cb203-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> B6          <span class="dv">79</span> N593JB       <span class="dv">557</span>            <span class="dv">600</span>      <span class="dv">838</span>            <span class="dv">846</span></span>
<span id="cb203-15"><a href="manipulating-data.html#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> AA         <span class="dv">301</span> N3ALAA       <span class="dv">558</span>            <span class="dv">600</span>      <span class="dv">753</span>            <span class="dv">745</span></span>
<span id="cb203-16"><a href="manipulating-data.html#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 336,766 more rows, and 2 more variables: air_time &lt;dbl&gt;,</span></span>
<span id="cb203-17"><a href="manipulating-data.html#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   time_hour &lt;dttm&gt;</span></span>
<span id="cb203-18"><a href="manipulating-data.html#cb203-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-19"><a href="manipulating-data.html#cb203-19" aria-hidden="true" tabindex="-1"></a>varlist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;carrier&quot;</span>, <span class="st">&quot;flight&quot;</span>, <span class="st">&quot;tailnum&quot;</span>,</span>
<span id="cb203-20"><a href="manipulating-data.html#cb203-20" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;sched_dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>, <span class="st">&quot;sched_arr_time&quot;</span>,</span>
<span id="cb203-21"><a href="manipulating-data.html#cb203-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;air_time&quot;</span>)</span>
<span id="cb203-22"><a href="manipulating-data.html#cb203-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-23"><a href="manipulating-data.html#cb203-23" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb203-24"><a href="manipulating-data.html#cb203-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(varlist))</span>
<span id="cb203-25"><a href="manipulating-data.html#cb203-25" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 336,776 x 8</span></span>
<span id="cb203-26"><a href="manipulating-data.html#cb203-26" aria-hidden="true" tabindex="-1"></a>   carrier flight tailnum dep_time sched_dep_time arr_time sched_arr_time</span>
<span id="cb203-27"><a href="manipulating-data.html#cb203-27" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb203-28"><a href="manipulating-data.html#cb203-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> UA        <span class="dv">1545</span> N14228       <span class="dv">517</span>            <span class="dv">515</span>      <span class="dv">830</span>            <span class="dv">819</span></span>
<span id="cb203-29"><a href="manipulating-data.html#cb203-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> UA        <span class="dv">1714</span> N24211       <span class="dv">533</span>            <span class="dv">529</span>      <span class="dv">850</span>            <span class="dv">830</span></span>
<span id="cb203-30"><a href="manipulating-data.html#cb203-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> AA        <span class="dv">1141</span> N619AA       <span class="dv">542</span>            <span class="dv">540</span>      <span class="dv">923</span>            <span class="dv">850</span></span>
<span id="cb203-31"><a href="manipulating-data.html#cb203-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> B6         <span class="dv">725</span> N804JB       <span class="dv">544</span>            <span class="dv">545</span>     <span class="dv">1004</span>           <span class="dv">1022</span></span>
<span id="cb203-32"><a href="manipulating-data.html#cb203-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> DL         <span class="dv">461</span> N668DN       <span class="dv">554</span>            <span class="dv">600</span>      <span class="dv">812</span>            <span class="dv">837</span></span>
<span id="cb203-33"><a href="manipulating-data.html#cb203-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> UA        <span class="dv">1696</span> N39463       <span class="dv">554</span>            <span class="dv">558</span>      <span class="dv">740</span>            <span class="dv">728</span></span>
<span id="cb203-34"><a href="manipulating-data.html#cb203-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> B6         <span class="dv">507</span> N516JB       <span class="dv">555</span>            <span class="dv">600</span>      <span class="dv">913</span>            <span class="dv">854</span></span>
<span id="cb203-35"><a href="manipulating-data.html#cb203-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> EV        <span class="dv">5708</span> N829AS       <span class="dv">557</span>            <span class="dv">600</span>      <span class="dv">709</span>            <span class="dv">723</span></span>
<span id="cb203-36"><a href="manipulating-data.html#cb203-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> B6          <span class="dv">79</span> N593JB       <span class="dv">557</span>            <span class="dv">600</span>      <span class="dv">838</span>            <span class="dv">846</span></span>
<span id="cb203-37"><a href="manipulating-data.html#cb203-37" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> AA         <span class="dv">301</span> N3ALAA       <span class="dv">558</span>            <span class="dv">600</span>      <span class="dv">753</span>            <span class="dv">745</span></span>
<span id="cb203-38"><a href="manipulating-data.html#cb203-38" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 336,766 more rows, and 1 more variable: air_time &lt;dbl&gt;</span></span>
<span id="cb203-39"><a href="manipulating-data.html#cb203-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-40"><a href="manipulating-data.html#cb203-40" aria-hidden="true" tabindex="-1"></a>varlist <span class="ot">&lt;-</span> <span class="fu">c</span>(varlist, <span class="st">&quot;whoops&quot;</span>)</span>
<span id="cb203-41"><a href="manipulating-data.html#cb203-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-42"><a href="manipulating-data.html#cb203-42" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb203-43"><a href="manipulating-data.html#cb203-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(varlist)) <span class="co"># this errors out b/c whoops doesn&#39;t exist</span></span>
<span id="cb203-44"><a href="manipulating-data.html#cb203-44" aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> Can<span class="st">&#39;t subset columns that don&#39;</span>t exist.</span>
<span id="cb203-45"><a href="manipulating-data.html#cb203-45" aria-hidden="true" tabindex="-1"></a>x Column <span class="st">`</span><span class="at">whoops</span><span class="st">`</span> doesn<span class="st">&#39;t exist.</span></span>
<span id="cb203-46"><a href="manipulating-data.html#cb203-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-47"><a href="manipulating-data.html#cb203-47" aria-hidden="true" tabindex="-1"></a><span class="st">flights %&gt;%</span></span>
<span id="cb203-48"><a href="manipulating-data.html#cb203-48" aria-hidden="true" tabindex="-1"></a><span class="st">select(any_of(varlist)) # this runs just fine</span></span>
<span id="cb203-49"><a href="manipulating-data.html#cb203-49" aria-hidden="true" tabindex="-1"></a><span class="st"># A tibble: 336,776 x 8</span></span>
<span id="cb203-50"><a href="manipulating-data.html#cb203-50" aria-hidden="true" tabindex="-1"></a><span class="st">   carrier flight tailnum dep_time sched_dep_time arr_time sched_arr_time</span></span>
<span id="cb203-51"><a href="manipulating-data.html#cb203-51" aria-hidden="true" tabindex="-1"></a><span class="st">   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;      &lt;int&gt;          &lt;int&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb203-52"><a href="manipulating-data.html#cb203-52" aria-hidden="true" tabindex="-1"></a><span class="st"> 1 UA        1545 N14228       517            515      830            819</span></span>
<span id="cb203-53"><a href="manipulating-data.html#cb203-53" aria-hidden="true" tabindex="-1"></a><span class="st"> 2 UA        1714 N24211       533            529      850            830</span></span>
<span id="cb203-54"><a href="manipulating-data.html#cb203-54" aria-hidden="true" tabindex="-1"></a><span class="st"> 3 AA        1141 N619AA       542            540      923            850</span></span>
<span id="cb203-55"><a href="manipulating-data.html#cb203-55" aria-hidden="true" tabindex="-1"></a><span class="st"> 4 B6         725 N804JB       544            545     1004           1022</span></span>
<span id="cb203-56"><a href="manipulating-data.html#cb203-56" aria-hidden="true" tabindex="-1"></a><span class="st"> 5 DL         461 N668DN       554            600      812            837</span></span>
<span id="cb203-57"><a href="manipulating-data.html#cb203-57" aria-hidden="true" tabindex="-1"></a><span class="st"> 6 UA        1696 N39463       554            558      740            728</span></span>
<span id="cb203-58"><a href="manipulating-data.html#cb203-58" aria-hidden="true" tabindex="-1"></a><span class="st"> 7 B6         507 N516JB       555            600      913            854</span></span>
<span id="cb203-59"><a href="manipulating-data.html#cb203-59" aria-hidden="true" tabindex="-1"></a><span class="st"> 8 EV        5708 N829AS       557            600      709            723</span></span>
<span id="cb203-60"><a href="manipulating-data.html#cb203-60" aria-hidden="true" tabindex="-1"></a><span class="st"> 9 B6          79 N593JB       557            600      838            846</span></span>
<span id="cb203-61"><a href="manipulating-data.html#cb203-61" aria-hidden="true" tabindex="-1"></a><span class="st">10 AA         301 N3ALAA       558            600      753            745</span></span>
<span id="cb203-62"><a href="manipulating-data.html#cb203-62" aria-hidden="true" tabindex="-1"></a><span class="st"># … with 336,766 more rows, and 1 more variable: air_time &lt;dbl&gt;</span></span></code></pre></div>
</details>
<p>So for now, at least in R, you know how to cut your data down to size rowwise (with <code>filter</code>) and column-wise (with <code>select</code>).</p>
<p>Unfortunately, SAS doesn’t make column selection <em>quite</em> as easy. It’s still not hard, but it can be tedious. In SAS, there are two primary methods to select variables: KEEP selects variables, DROP removes variables.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="manipulating-data.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export flights data for SAS</span></span>
<span id="cb204-2"><a href="manipulating-data.html#cb204-2" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb204-3"><a href="manipulating-data.html#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_frac</span>(<span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">%&gt;%</span> <span class="co"># Keep file from being too big</span></span>
<span id="cb204-4"><a href="manipulating-data.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(<span class="st">&quot;data/flights.csv&quot;</span>, <span class="at">na =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre class="sashtmllog"><code>6          /* Read in data */
7          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
8          filename fileloc
8        ! &#39;~/Projects/Class/unl-stat850/2020-stat850/data/flights.csv&#39;;
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: The SAS System stopped processing this step because of errors.
9          PROC IMPORT  datafile = fileloc out=classdat.flights
10         DBMS = csv; /* comma delimited file */
11         GETNAMES = YES;
12         RUN;


ERROR: Errors printed on pages 5,7,12,13.</code></pre>
In SAS, a partial variable name either preceded or followed by <code>:</code> serves as a wildcard.
Ranges of variables can be specified with two dashes, e.g. <code>var3 -- var5</code>.
<details>
<summary>
SAS KEEP statement
</summary>
<p>Unfortunately, the wildcard doesn’t work on both ends, so to get the equivalent of <code>matches("dep")</code>, we have to use two different options in our KEEP statement (plus the extra variables that don’t have dep in them).</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          DATA tmpfly;
9            KEEP flight year--day tailnum origin dep: sched_dep:;
10           SET classdat.flights;
11         RUN;

NOTE: The data set WORK.TMPFLY has 0 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12         
13         PROC PRINT DATA = tmpfly (obs=10);
14         RUN;

NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
Note also that SAS doesn’t reorder the columns for us like <code>select()</code> does.
</details>
<p>If we’d prefer to carve out columns (rather than assembling a new dataset with the columns we want to keep), we can use a DROP statement, which works exactly the same way. Let’s see what columns we removed implicitly last time by dropping everything we’d previously kept:</p>
<details>
<summary>
SAS DROP statement
</summary>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          DATA tmpfly;
9            DROP flight year--day tailnum origin dep: sched_dep:;
10           SET classdat.flights;
11         RUN;

NOTE: The data set WORK.TMPFLY has 0 observations and 10 variables.
WARNING: Data set WORK.TMPFLY was not replaced because this step was 
         stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12         
13         PROC PRINT DATA = tmpfly (obs=10);
14         RUN;

NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
</details>
<p>As with the filter statements, we can also use PROC SQL instead of a SAS DATA step. There are even ways to (sort-of) use elements of both.</p>
<details>
<summary>
SAS PROC SQL SELECT statement
</summary>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE tmpfly
10         AS
11         SELECT flight, year, month, day, tailnum, origin
12         FROM classdat.flights;
NOTE: Statement not executed due to NOEXEC option.
13         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


14         PROC PRINT DATA = tmpfly(obs=10);
15         RUN;

NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
<p>Note that PROC SQL doesn’t have a RUN statement - it is executed immediately. But, using the PROC SQL syntax, we still have to list out all of the variables, and that’s a drag.</p>
<p>Luckily, PROC SQL will also let us use some of the DATA step options, if we’re careful about it:</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE tmpfly
10         AS
11         SELECT *
12         FROM classdat.flights(drop=year--day flight tailnum origin dep:
12       ! sched_dep:);
NOTE: Statement not executed due to NOEXEC option.
13         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


14         PROC PRINT DATA = tmpfly(obs=10);
15         RUN;

NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
Note the difference - we’re selecting everything (in SQL) but dropping columns when we tell SQL where to look for the data.
</details>
<p>For the most part, that is what you need to functionally replicate <code>select()</code> syntax. It may be a bit more work because there aren’t the same convenience functions, but it’ll do and you don’t have to remember as many keywords, so that’s a plus.</p>
</div>
<div id="mutate-add-and-transform-variables" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Mutate: Add and transform variables</h2>
<p>Up to this point, we’ve been primarily focusing on how to decrease the dimensionality of our dataset in various ways. But frequently, we also need to add columns for derived measures (e.g. BMI from weight and height information), change units, and replace missing or erroneous observations. The tidyverse verb for this is <code>mutate</code>. However, it’s probably best to start this section out with a very short demonstration of how this process worked in R before the tidyverse came around.</p>
<details>
<summary>
Pre-tidyverse base R “mutating” a data frame
</summary>
<p>Lets use the police violence data to demonstrate. Remember the issues you identified with the data during EDA in Module 4 (<a href="reading-data.html#police-violence-eda-sas">in SAS</a>)(<a href="reading-data.html#police-violence-eda-r">in R</a>)?</p>
<p>The <code>gsub</code> function is basically R’s version of “find and replace.”</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="manipulating-data.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb210-2"><a href="manipulating-data.html#cb210-2" aria-hidden="true" tabindex="-1"></a>police_violence <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data/police_violence.xlsx&quot;</span>, <span class="at">guess_max =</span> <span class="dv">7000</span>)</span>
<span id="cb210-3"><a href="manipulating-data.html#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="manipulating-data.html#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># There are two categories for &quot;unknown race&quot;</span></span>
<span id="cb210-5"><a href="manipulating-data.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(police_violence<span class="sc">$</span><span class="st">`</span><span class="at">Victim&#39;s race</span><span class="st">`</span>, <span class="at">useNA =</span> <span class="st">&#39;ifany&#39;</span>)</span>
<span id="cb210-6"><a href="manipulating-data.html#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="manipulating-data.html#cb210-7" aria-hidden="true" tabindex="-1"></a>           Asian            Black         Hispanic  Native American </span>
<span id="cb210-8"><a href="manipulating-data.html#cb210-8" aria-hidden="true" tabindex="-1"></a>             <span class="dv">118</span>             <span class="dv">1944</span>             <span class="dv">1335</span>              <span class="dv">112</span> </span>
<span id="cb210-9"><a href="manipulating-data.html#cb210-9" aria-hidden="true" tabindex="-1"></a>Pacific Islander     Unknown race     Unknown Race            White </span>
<span id="cb210-10"><a href="manipulating-data.html#cb210-10" aria-hidden="true" tabindex="-1"></a>              <span class="dv">42</span>              <span class="dv">670</span>               <span class="dv">64</span>             <span class="dv">3378</span> </span>
<span id="cb210-11"><a href="manipulating-data.html#cb210-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-12"><a href="manipulating-data.html#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This line substitutes &quot;race&quot; for &quot;Race&quot; so that there&#39;s consistent capitalization</span></span>
<span id="cb210-13"><a href="manipulating-data.html#cb210-13" aria-hidden="true" tabindex="-1"></a>police_violence<span class="sc">$</span>race <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;Race&quot;</span>, <span class="st">&quot;race&quot;</span>, police_violence<span class="sc">$</span><span class="st">`</span><span class="at">Victim&#39;s race</span><span class="st">`</span>)</span>
<span id="cb210-14"><a href="manipulating-data.html#cb210-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-15"><a href="manipulating-data.html#cb210-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed!</span></span>
<span id="cb210-16"><a href="manipulating-data.html#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(police_violence<span class="sc">$</span>race)</span>
<span id="cb210-17"><a href="manipulating-data.html#cb210-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-18"><a href="manipulating-data.html#cb210-18" aria-hidden="true" tabindex="-1"></a>           Asian            Black         Hispanic  Native American </span>
<span id="cb210-19"><a href="manipulating-data.html#cb210-19" aria-hidden="true" tabindex="-1"></a>             <span class="dv">118</span>             <span class="dv">1944</span>             <span class="dv">1335</span>              <span class="dv">112</span> </span>
<span id="cb210-20"><a href="manipulating-data.html#cb210-20" aria-hidden="true" tabindex="-1"></a>Pacific Islander     Unknown race            White </span>
<span id="cb210-21"><a href="manipulating-data.html#cb210-21" aria-hidden="true" tabindex="-1"></a>              <span class="dv">42</span>              <span class="dv">734</span>             <span class="dv">3378</span> </span></code></pre></div>
You could do a simple operation like that in a single line, but you had to use the name of the data multiple times, and it very quickly becomes a complicated operation.
</details>
<p>The process in SAS is very similar. It’s recommended that you use one data step to read in your data, and then a separate data step to clean the data, so that you are separating the two operations.</p>
<details>
<summary>
SAS DATA STEP - create a new variable
</summary>
<p>We can create our variable a couple of different ways in SAS:
- Use the <a href="https://v8doc.sas.com/sashtml/lgref/z0215027.htm">TRANWRD function</a> for find and replace.
- Use an if statement and define the replacement ourselves</p>
<p>Both are demonstrated below:</p>
<pre class="saslog"><code>2          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
3          
4          DATA pvtmp;
5            SET classdat.police;
6            race = tranwrd(victim_s_race, &quot;Race&quot;, &quot;race&quot;);
7            race2 = victim_s_race; /* initialize it to current value */
8            IF victim_s_race=&#39;Unknown Race&#39; THEN race2 = &#39;Unknown race&#39;;
9          RUN;

NOTE: The data set WORK.PVTMP has 0 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

10         
11         PROC FREQ DATA = pvtmp ORDER=FREQ; /* Combinations of vars */
12         TABLES victim_s_race * race victim_s_race * race2 /
13           NOCUM NOPERCENT NOCOL NOROW MAXLEVELS=10;
14         RUN;

NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.
                              The SAS System                              1
                                             09:05 Thursday, April 22, 2021

                       --------- List = ick---------

                                  Item 1

                                  olives

                                  Item 2

                                  sausage

                                  Item 3

                                 anchovies

                      --------- List = crust---------

                                  Item 1

                                  flour 

                                  Item 2

                                  yeast 

                                  Item 3

                                  salt  

                                  Item 4

                                  water 

                 --------- List = yummy_toppings---------

                                  Item 1

                                  asiago

                                  Item 2

                                  fontina


                              The SAS System                              2
                                             09:05 Thursday, April 22, 2021

                                  Item 3

                                blue cheese

                                  Item 4

                                  bacon 

                                  Item 5

                                 scallions
            Average math test scores under the influence of LSD           3
                                             09:05 Thursday, April 22, 2021

                          The DATASETS Procedure

Data Set Name        WORK.MATHLSD                  Observations          7 
Member Type          DATA                          Variables             2 
Engine               V9                            Indexes               0 
Created              04/22/2021 09:05:47           Observation Length    16
Last Modified        04/22/2021 09:05:47           Deleted Observations  0 
Protection                                         Compressed            NO
Data Set Type                                      Sorted                NO
Label                                                                      
Data Representation  SOLARIS_X86_64,                                       
                     LINUX_X86_64, ALPHA_TRU64,                            
                     LINUX_IA64                                            
Encoding             latin1  Western (ISO)                                 

                     Engine/Host Dependent Information

Data Set Page Size          65536                                          
Number of Data Set Pages    1                                              
First Data Page             1                                              
Max Obs per Page            4061                                           
Obs in First Data Page      7                                              
Number of Data Set Repairs  0                                              
Filename                    /tmp/SAS_workDC6C0004C1D0_                     
                            silicon/mathlsd.sas7bdat                       
Release Created             9.0401M6                                       
Host Created                Linux                                          
Inode Number                11278124                                       
Access Permission           rw-rw-r--                                      
Owner Name                  susan                                          
File Size                   128KB                                          
File Size (bytes)           131072                                         

                Alphabetic List of Variables and Attributes
 
                       #    Variable    Type    Len

                       1    Drugs       Num       8
                       2    Score       Num       8
            Average math test scores under the influence of LSD           4
                                             09:05 Thursday, April 22, 2021

                           Obs    Drugs    Score

                            1      1.17    78.93
                            2      2.97    58.20
                            3      3.26    67.47
                            4      4.69    37.47
                            5      5.83    45.65
                            6      6.00    32.92
                            7      6.41    29.97
            Average math test scores under the influence of LSD           5
                                             09:05 Thursday, April 22, 2021

                                     x

                     1         2         3         4         5
                     6         7         8         9        10
                    11        12        13        14        15
                    16        17        18        19        20

                                     y

                                   11        12
                                   16        17
            Average math test scores under the influence of LSD           6
                                             09:05 Thursday, April 22, 2021

                     Obs    _TYPE_    _FREQ_       x

                      1        0        466     233168
            Average math test scores under the influence of LSD           7
                                             09:05 Thursday, April 22, 2021

                    Obs     name     status     present

                     1     Edison    nice        toy   
                     2     Alex      naughty     coal  
                     3     Susan                 toy   
                     4     Ryan      neutral     toy   </code></pre>
In both cases we can see that the recode worked the way we wanted and we’ve now gotten rid of the extra “unknown” category".
</details>
<p>We can also use PROC SQL to create new variables using relatively complex logic if necessary.</p>
<details>
<summary>
SAS PROC SQL - create a new variable
</summary>
<p>In SQL, you define new variables using AS. In SELECT statements, this definition has the computation on the left and the variable on the right<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a>.</p>
<p>CASE WHEN is the if-else statement in SQL. When (<code>victim_s_race</code> = ‘Unknown Race’), our variable value will be “Unknown race,” otherwise it will be what ever value is in <code>victim_s_race</code>.</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE WORK.pvtmp AS
10         SELECT * ,
11         CASE WHEN victim_s_race=&#39;Unknown Race&#39; THEN &#39;Unknown race&#39; ELSE
11       ! victim_s_race END AS race
12         FROM classdat.police;
NOTE: Statement not executed due to NOEXEC option.
13         
14         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


15         PROC FREQ DATA = pvtmp ORDER=FREQ; /* Combinations of vars */
16         TABLES victim_s_race * race /
17           NOCUM NOPERCENT NOCOL NOROW MAXLEVELS=10;
18         RUN;

NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
</details>
<p>The choice of which method to use (DATA step or PROC SQL) involves weighing these competing factors:</p>
<ul>
<li>computational time</li>
<li>code readability</li>
<li>programmer time</li>
</ul>
<div class="my-opinion">
<p>Personally, I find PROC SQL easier to work with, but I think the code is ugly. There are similar sql-syntax packages in R, but I don’t feel the need to use them, because (for me) dplyr code is much easier to read (and thus, easier to maintain). dplyr code is not as efficient as SQL (or other packages, like <code>data.table</code>) on big datasets, but there are variants such as <code>dbplyr</code> to handle some of those cases, and I find that they don’t come up very often in my work or research. If I were working at Google or Amazon, my opinion might be very different</p>
</div>
<p>The fundamentals of <code>mutate</code> are very similar to the approaches above; the power of the dplyr approach is only really evident when you are doing multiple operations in the same step. Once you’re working at that level, the <code>dplyr</code> approach produces much more readable code.</p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/raw/master/rstats-artwork/dplyr_mutate.png" alt="" />
<p class="caption">Mutate (by Allison Horst)</p>
</div>
<details>
<summary>
<code>mutate()</code> a new variable
</summary>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="manipulating-data.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The data was read in above...</span></span>
<span id="cb213-2"><a href="manipulating-data.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb213-3"><a href="manipulating-data.html#cb213-3" aria-hidden="true" tabindex="-1"></a>police_violence <span class="sc">%&gt;%</span></span>
<span id="cb213-4"><a href="manipulating-data.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">gsub</span>(<span class="st">&quot;Race&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">`</span><span class="at">Victim&#39;s race</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb213-5"><a href="manipulating-data.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Victim&#39;s race</span><span class="st">`</span>, race) <span class="sc">%&gt;%</span></span>
<span id="cb213-6"><a href="manipulating-data.html#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>()</span>
<span id="cb213-7"><a href="manipulating-data.html#cb213-7" aria-hidden="true" tabindex="-1"></a>                  race</span>
<span id="cb213-8"><a href="manipulating-data.html#cb213-8" aria-hidden="true" tabindex="-1"></a>Victim<span class="st">&#39;s race      Asian Black Hispanic Native American Pacific Islander</span></span>
<span id="cb213-9"><a href="manipulating-data.html#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Asian              118     0        0               0                0</span></span>
<span id="cb213-10"><a href="manipulating-data.html#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Black                0  1944        0               0                0</span></span>
<span id="cb213-11"><a href="manipulating-data.html#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="st">  Hispanic             0     0     1335               0                0</span></span>
<span id="cb213-12"><a href="manipulating-data.html#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Native American      0     0        0             112                0</span></span>
<span id="cb213-13"><a href="manipulating-data.html#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="st">  Pacific Islander     0     0        0               0               42</span></span>
<span id="cb213-14"><a href="manipulating-data.html#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="st">  Unknown race         0     0        0               0                0</span></span>
<span id="cb213-15"><a href="manipulating-data.html#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Unknown Race         0     0        0               0                0</span></span>
<span id="cb213-16"><a href="manipulating-data.html#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="st">  White                0     0        0               0                0</span></span>
<span id="cb213-17"><a href="manipulating-data.html#cb213-17" aria-hidden="true" tabindex="-1"></a><span class="st">                  race</span></span>
<span id="cb213-18"><a href="manipulating-data.html#cb213-18" aria-hidden="true" tabindex="-1"></a><span class="st">Victim&#39;</span>s race      Unknown race White</span>
<span id="cb213-19"><a href="manipulating-data.html#cb213-19" aria-hidden="true" tabindex="-1"></a>  Asian                       <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb213-20"><a href="manipulating-data.html#cb213-20" aria-hidden="true" tabindex="-1"></a>  Black                       <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb213-21"><a href="manipulating-data.html#cb213-21" aria-hidden="true" tabindex="-1"></a>  Hispanic                    <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb213-22"><a href="manipulating-data.html#cb213-22" aria-hidden="true" tabindex="-1"></a>  Native American             <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb213-23"><a href="manipulating-data.html#cb213-23" aria-hidden="true" tabindex="-1"></a>  Pacific Islander            <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb213-24"><a href="manipulating-data.html#cb213-24" aria-hidden="true" tabindex="-1"></a>  Unknown race              <span class="dv">670</span>     <span class="dv">0</span></span>
<span id="cb213-25"><a href="manipulating-data.html#cb213-25" aria-hidden="true" tabindex="-1"></a>  Unknown Race               <span class="dv">64</span>     <span class="dv">0</span></span>
<span id="cb213-26"><a href="manipulating-data.html#cb213-26" aria-hidden="true" tabindex="-1"></a>  White                       <span class="dv">0</span>  <span class="dv">3378</span></span></code></pre></div>
The last 2 rows are just to organize the output - we keep only the two variables we’re working with, and get a crosstab like PROC FREQ gave us in SAS.
</details>
<p>The learning curve here isn’t actually knowing how to use mutate (though that’s important). The challenge comes when you want to do something <em>new</em> and have to figure out how to e.g. use find and replace in a string, or work with dates and times, or recode variables.</p>
<p>I’m not going to be able to teach you how to handle every task you’ll come across (people invent new ways to screw up data all the time!) but my goal is instead to teach you how to read documentation and google things intelligently, and to <em>understand what you’re reading</em> enough to actually implement it. This is something that comes with practice (and lots of googling, stack overflow searches, etc.).</p>
<details>
<summary>
It’s actually something of a common meme…
</summary>
<img src="image/tweets-ch5-1.png" width="2100" /><img src="image/tweets-ch5-2.png" width="2100" />
</details>
<p>In this class, my goal is to expose you to solutions to common problems; unfortunately, there are too many common problems for us to work through line-by-line.
Part of the goal of this class is for you to learn how to read through a package description and evaluate whether the package will do what you want; we’re going to try to build some of those skills starting now.
It would be relatively easy to teach you how to do a set list of tasks, but you’ll be better statisticians and programmers if you learn the skills to solve niche problems on your own.</p>
<div class="figure"><span id="fig:tweets-more-ch5"></span>
<img src="image/tweets-more-ch5-1.png" alt="Apologies for the noninclusive language, but the sentiment is real." width="2100" />
<p class="caption">
Figure 5.1: Apologies for the noninclusive language, but the sentiment is real.
</p>
</div>
<p>Here is a quick list of packages in R which will solve some of the more common problems. Between that and the R cheatsheet, you should be set. In SAS, there are fewer options, so it’s less bewildering to google solutions (but I’ll link you to relevant pieces for the common SAS stuff too).</p>
<div class="learn-more">
<ul>
<li>Dates and times: <code>lubridate</code> package in R (esp. <code>ymd_hms()</code> and variants, <code>decimal_date()</code>, and other convenience functions). <a href="https://documentation.sas.com/?docsetId=lrcon&amp;docsetTarget=p1wj0wt2ebe2a0n1lv4lem9hdc0v.htm&amp;docsetVersion=9.4&amp;locale=en">SAS Dates and Times</a>.</li>
<li>String manipulation:
<ul>
<li><code>stringr</code> package in R (<code>str_replace()</code>, <code>str_remove()</code>, <code>str_detect()</code>, <code>str_split()</code>)</li>
<li><a href="https://rstudio.com/wp-content/uploads/2016/09/RegExCheatsheet.pdf">Regular Expression Cheatsheet (R)</a></li>
<li><a href="https://www.listendata.com/2014/12/sas-character-functions.html">Common String operations in SAS</a></li>
<li><a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi29/265-29.pdf">Regular Expressions in SAS</a></li>
<li>We’ll talk more about strings in the next module…</li>
</ul></li>
</ul>
</div>
</div>
<div id="summarize" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Summarize</h2>
<p>The next verb is one that we’ve already implicitly seen in action: <code>summarize</code> takes a data frame with potentially many rows of data and reduces it down to one row of data using some function. You have used it to get single-row summaries of vectorized data in R, and in SAS, PROC MEANS is essentially the same thing.</p>
<p>Here (in a trivial example), I compute the overall average age of a victim of police violence, and then also compute the average number of characters in their name. Admittedly, that last computation is a bit silly, but it’s mostly for demonstration purposes.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="manipulating-data.html#cb214-1" aria-hidden="true" tabindex="-1"></a>police_violence <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data/police_violence.xlsx&quot;</span>, <span class="at">guess_max =</span> <span class="dv">7000</span>)</span>
<span id="cb214-2"><a href="manipulating-data.html#cb214-2" aria-hidden="true" tabindex="-1"></a>police_violence <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="manipulating-data.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Victim&#39;s age</span><span class="st">`</span>),</span>
<span id="cb214-4"><a href="manipulating-data.html#cb214-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">name_length =</span> <span class="fu">nchar</span>(<span class="st">`</span><span class="at">Victim&#39;s name</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb214-5"><a href="manipulating-data.html#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> T), <span class="at">name_length =</span> <span class="fu">mean</span>(name_length))</span>
<span id="cb214-6"><a href="manipulating-data.html#cb214-6" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> mask<span class="sc">$</span><span class="fu">eval_all_mutate</span>(quo)<span class="sc">:</span> NAs introduced by coercion</span>
<span id="cb214-7"><a href="manipulating-data.html#cb214-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 1 x 2</span></span>
<span id="cb214-8"><a href="manipulating-data.html#cb214-8" aria-hidden="true" tabindex="-1"></a>    age name_length</span>
<span id="cb214-9"><a href="manipulating-data.html#cb214-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb214-10"><a href="manipulating-data.html#cb214-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="fl">36.8</span>        <span class="fl">16.6</span></span></code></pre></div>
<p>In SAS, we can do something similar:</p>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          DATA pv;
9            SET classdat.police;
10           age = INPUT(victim_s_age, 3.);
11           name_len = LENGTH(victim_s_name);
12         RUN;

NOTE: The data set WORK.PV has 0 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13         
14         PROC MEANS DATA=pv;
15         VAR age name_len;
16         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
<p>By default, with SAS, we get a bit more than we bargained for; we can turn the extra output off with options.</p>
<p>Another option is to use PROC SQL in SAS, which will have a logical flow similar to <code>dplyr</code>.</p>
<pre class="sashtmllog"><code>6          
7          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
8          


9          DATA pv;
10           SET classdat.police;
11           age = INPUT(victim_s_age, 3.);
12           name_len = LENGTH(victim_s_name);
13         RUN;

NOTE: The data set WORK.PV has 0 observations and 27 variables.
WARNING: Data set WORK.PV was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

14         
15         PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
16         SELECT AVG(age) as age, AVG(name_len) as name_len
17         FROM pv;
NOTE: Statement not executed due to NOEXEC option.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13.</code></pre>
<p>The real power of summarize, though, is in combination with Group By. We’ll see more summarize examples, but it’s easier to make good examples when you have all the tools - it’s hard to demonstrate how to use a hammer if you don’t also have a nail.</p>
</div>
<div id="group-by-power" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Group By + (?) = Power!</h2>
<p>Frequently, we have data that is more specific than the data we need - for instance, I may have observations of the temperature at 15-minute intervals, but I might want to record the daily high and low value. To do this, I need to</p>
<ol style="list-style-type: decimal">
<li>split my dataset into smaller datasets - one for each day</li>
<li>compute summary values for each smaller dataset</li>
<li>put my summarized data back together into a single dataset</li>
</ol>
<p><code>group_by</code> is the verb that accomplishes the first task. <code>summarize</code> accomplishes the second task and implicitly accomplishes the third as well.</p>
<details>
<summary>
Replicating frequency tables using <code>dplyr</code>
</summary>
<p>Let’s start with a trivial example: Suppose we want to count up every occurrence of a variable in a dataset. We can already do this with e.g. <code>table()</code>, but work with me for a moment.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="manipulating-data.html#cb217-1" aria-hidden="true" tabindex="-1"></a>pv <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data/police_violence.xlsx&quot;</span>, <span class="at">guess_max =</span> <span class="dv">7000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb217-2"><a href="manipulating-data.html#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">gsub</span>(<span class="st">&quot;Race&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">`</span><span class="at">Victim&#39;s race</span><span class="st">`</span>),</span>
<span id="cb217-3"><a href="manipulating-data.html#cb217-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Victim&#39;s age</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb217-4"><a href="manipulating-data.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">name =</span> <span class="st">`</span><span class="at">Victim&#39;s name</span><span class="st">`</span>, age,  </span>
<span id="cb217-5"><a href="manipulating-data.html#cb217-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="st">`</span><span class="at">Victim&#39;s gender</span><span class="st">`</span>, race) </span>
<span id="cb217-6"><a href="manipulating-data.html#cb217-6" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> mask<span class="sc">$</span><span class="fu">eval_all_mutate</span>(quo)<span class="sc">:</span> NAs introduced by coercion</span>
<span id="cb217-7"><a href="manipulating-data.html#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="co"># You can rename variables with a select statement</span></span>
<span id="cb217-8"><a href="manipulating-data.html#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="co"># I&#39;m doing this b/c I don&#39;t like to use backticks if I can help it. </span></span>
<span id="cb217-9"><a href="manipulating-data.html#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lazy coding = best coding. </span></span>
<span id="cb217-10"><a href="manipulating-data.html#cb217-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-11"><a href="manipulating-data.html#cb217-11" aria-hidden="true" tabindex="-1"></a>grouped_pv <span class="ot">&lt;-</span> pv  <span class="sc">%&gt;%</span></span>
<span id="cb217-12"><a href="manipulating-data.html#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race) </span>
<span id="cb217-13"><a href="manipulating-data.html#cb217-13" aria-hidden="true" tabindex="-1"></a>grouped_pv</span>
<span id="cb217-14"><a href="manipulating-data.html#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 7,663 x 4</span></span>
<span id="cb217-15"><a href="manipulating-data.html#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   race [7]</span></span>
<span id="cb217-16"><a href="manipulating-data.html#cb217-16" aria-hidden="true" tabindex="-1"></a>   name                      age gender race        </span>
<span id="cb217-17"><a href="manipulating-data.html#cb217-17" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>                   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       </span>
<span id="cb217-18"><a href="manipulating-data.html#cb217-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Eric M. Tellez             <span class="dv">28</span> Male   White       </span>
<span id="cb217-19"><a href="manipulating-data.html#cb217-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Name withheld by police    <span class="cn">NA</span> Male   Unknown race</span>
<span id="cb217-20"><a href="manipulating-data.html#cb217-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Terry Hudson               <span class="dv">57</span> Male   Black       </span>
<span id="cb217-21"><a href="manipulating-data.html#cb217-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Malik Williams             <span class="dv">23</span> Male   Black       </span>
<span id="cb217-22"><a href="manipulating-data.html#cb217-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Frederick Perkins          <span class="dv">37</span> Male   Black       </span>
<span id="cb217-23"><a href="manipulating-data.html#cb217-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Michael Vincent Davis      <span class="dv">49</span> Male   White       </span>
<span id="cb217-24"><a href="manipulating-data.html#cb217-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Brian Elkins               <span class="dv">47</span> Male   Unknown race</span>
<span id="cb217-25"><a href="manipulating-data.html#cb217-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Debra D. Arbuckle          <span class="dv">51</span> Female White       </span>
<span id="cb217-26"><a href="manipulating-data.html#cb217-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Name withheld by police    <span class="cn">NA</span> Male   Unknown race</span>
<span id="cb217-27"><a href="manipulating-data.html#cb217-27" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Cody McCaulou              <span class="dv">27</span> Male   White       </span>
<span id="cb217-28"><a href="manipulating-data.html#cb217-28" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 7,653 more rows</span></span></code></pre></div>
<p>So we can see that the object has been somehow grouped by the categorical variable race, in that the grouping is attached to the stored object (strictly speaking, group_by adds an attribute to the table). What matters for our purposes, though, is that each sub-table is treated as a separate entity for calculation purposes.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="manipulating-data.html#cb218-1" aria-hidden="true" tabindex="-1"></a>pv_race_sum <span class="ot">&lt;-</span> grouped_pv <span class="sc">%&gt;%</span></span>
<span id="cb218-2"><a href="manipulating-data.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="co"># This counts the number of rows in each group</span></span>
<span id="cb218-3"><a href="manipulating-data.html#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="manipulating-data.html#cb218-4" aria-hidden="true" tabindex="-1"></a>pv_race_sum</span>
<span id="cb218-5"><a href="manipulating-data.html#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 7 x 2</span></span>
<span id="cb218-6"><a href="manipulating-data.html#cb218-6" aria-hidden="true" tabindex="-1"></a>  race                 n</span>
<span id="cb218-7"><a href="manipulating-data.html#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>            <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb218-8"><a href="manipulating-data.html#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Asian              <span class="dv">118</span></span>
<span id="cb218-9"><a href="manipulating-data.html#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Black             <span class="dv">1944</span></span>
<span id="cb218-10"><a href="manipulating-data.html#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Hispanic          <span class="dv">1335</span></span>
<span id="cb218-11"><a href="manipulating-data.html#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Native American    <span class="dv">112</span></span>
<span id="cb218-12"><a href="manipulating-data.html#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> Pacific Islander    <span class="dv">42</span></span>
<span id="cb218-13"><a href="manipulating-data.html#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Unknown race       <span class="dv">734</span></span>
<span id="cb218-14"><a href="manipulating-data.html#cb218-14" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> White             <span class="dv">3378</span></span></code></pre></div>
<p>When we run summarize, we get back a data frame that is not grouped, with one line for each of the previously existing groups. <code>summarize</code> removes one “layer” of grouping with each run.</p>
<p>One layer of grouping? What does that mean?</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="manipulating-data.html#cb219-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> pv <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="manipulating-data.html#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, race) </span>
<span id="cb219-3"><a href="manipulating-data.html#cb219-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-4"><a href="manipulating-data.html#cb219-4" aria-hidden="true" tabindex="-1"></a>tmp</span>
<span id="cb219-5"><a href="manipulating-data.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 7,663 x 4</span></span>
<span id="cb219-6"><a href="manipulating-data.html#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   gender, race [26]</span></span>
<span id="cb219-7"><a href="manipulating-data.html#cb219-7" aria-hidden="true" tabindex="-1"></a>   name                      age gender race        </span>
<span id="cb219-8"><a href="manipulating-data.html#cb219-8" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>                   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       </span>
<span id="cb219-9"><a href="manipulating-data.html#cb219-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Eric M. Tellez             <span class="dv">28</span> Male   White       </span>
<span id="cb219-10"><a href="manipulating-data.html#cb219-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Name withheld by police    <span class="cn">NA</span> Male   Unknown race</span>
<span id="cb219-11"><a href="manipulating-data.html#cb219-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Terry Hudson               <span class="dv">57</span> Male   Black       </span>
<span id="cb219-12"><a href="manipulating-data.html#cb219-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Malik Williams             <span class="dv">23</span> Male   Black       </span>
<span id="cb219-13"><a href="manipulating-data.html#cb219-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Frederick Perkins          <span class="dv">37</span> Male   Black       </span>
<span id="cb219-14"><a href="manipulating-data.html#cb219-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Michael Vincent Davis      <span class="dv">49</span> Male   White       </span>
<span id="cb219-15"><a href="manipulating-data.html#cb219-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Brian Elkins               <span class="dv">47</span> Male   Unknown race</span>
<span id="cb219-16"><a href="manipulating-data.html#cb219-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Debra D. Arbuckle          <span class="dv">51</span> Female White       </span>
<span id="cb219-17"><a href="manipulating-data.html#cb219-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Name withheld by police    <span class="cn">NA</span> Male   Unknown race</span>
<span id="cb219-18"><a href="manipulating-data.html#cb219-18" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Cody McCaulou              <span class="dv">27</span> Male   White       </span>
<span id="cb219-19"><a href="manipulating-data.html#cb219-19" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 7,653 more rows</span></span>
<span id="cb219-20"><a href="manipulating-data.html#cb219-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-21"><a href="manipulating-data.html#cb219-21" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb219-22"><a href="manipulating-data.html#cb219-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min_age =</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T), <span class="at">max_age =</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T))</span>
<span id="cb219-23"><a href="manipulating-data.html#cb219-23" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to min; returning <span class="cn">Inf</span></span>
<span id="cb219-24"><a href="manipulating-data.html#cb219-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-25"><a href="manipulating-data.html#cb219-25" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to min; returning <span class="cn">Inf</span></span>
<span id="cb219-26"><a href="manipulating-data.html#cb219-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-27"><a href="manipulating-data.html#cb219-27" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to min; returning <span class="cn">Inf</span></span>
<span id="cb219-28"><a href="manipulating-data.html#cb219-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-29"><a href="manipulating-data.html#cb219-29" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to min; returning <span class="cn">Inf</span></span>
<span id="cb219-30"><a href="manipulating-data.html#cb219-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-31"><a href="manipulating-data.html#cb219-31" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to min; returning <span class="cn">Inf</span></span>
<span id="cb219-32"><a href="manipulating-data.html#cb219-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-33"><a href="manipulating-data.html#cb219-33" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to min; returning <span class="cn">Inf</span></span>
<span id="cb219-34"><a href="manipulating-data.html#cb219-34" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to max; returning <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb219-35"><a href="manipulating-data.html#cb219-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-36"><a href="manipulating-data.html#cb219-36" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to max; returning <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb219-37"><a href="manipulating-data.html#cb219-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-38"><a href="manipulating-data.html#cb219-38" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to max; returning <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb219-39"><a href="manipulating-data.html#cb219-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-40"><a href="manipulating-data.html#cb219-40" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to max; returning <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb219-41"><a href="manipulating-data.html#cb219-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-42"><a href="manipulating-data.html#cb219-42" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to max; returning <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb219-43"><a href="manipulating-data.html#cb219-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-44"><a href="manipulating-data.html#cb219-44" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> T)<span class="sc">:</span> no non<span class="sc">-</span>missing arguments to max; returning <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb219-45"><a href="manipulating-data.html#cb219-45" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">summarise()</span><span class="st">`</span> has grouped output by <span class="st">&#39;gender&#39;</span>. You can override using the <span class="st">`</span><span class="at">.groups</span><span class="st">`</span> argument.</span>
<span id="cb219-46"><a href="manipulating-data.html#cb219-46" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 26 x 4</span></span>
<span id="cb219-47"><a href="manipulating-data.html#cb219-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   gender [5]</span></span>
<span id="cb219-48"><a href="manipulating-data.html#cb219-48" aria-hidden="true" tabindex="-1"></a>   gender race             min_age max_age</span>
<span id="cb219-49"><a href="manipulating-data.html#cb219-49" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>              <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb219-50"><a href="manipulating-data.html#cb219-50" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Female Asian                 <span class="dv">27</span>      <span class="dv">49</span></span>
<span id="cb219-51"><a href="manipulating-data.html#cb219-51" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Female Black                 <span class="dv">20</span>      <span class="dv">93</span></span>
<span id="cb219-52"><a href="manipulating-data.html#cb219-52" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Female Hispanic              <span class="dv">16</span>      <span class="dv">57</span></span>
<span id="cb219-53"><a href="manipulating-data.html#cb219-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Female Native American       <span class="dv">23</span>      <span class="dv">52</span></span>
<span id="cb219-54"><a href="manipulating-data.html#cb219-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Female Pacific Islander      <span class="dv">26</span>      <span class="dv">50</span></span>
<span id="cb219-55"><a href="manipulating-data.html#cb219-55" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Female Unknown race          <span class="dv">23</span>      <span class="dv">74</span></span>
<span id="cb219-56"><a href="manipulating-data.html#cb219-56" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Female White                  <span class="dv">5</span>      <span class="dv">89</span></span>
<span id="cb219-57"><a href="manipulating-data.html#cb219-57" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Male   Asian                 <span class="dv">16</span>      <span class="dv">76</span></span>
<span id="cb219-58"><a href="manipulating-data.html#cb219-58" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Male   Black                  <span class="dv">1</span>     <span class="dv">107</span></span>
<span id="cb219-59"><a href="manipulating-data.html#cb219-59" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Male   Hispanic               <span class="dv">1</span>      <span class="dv">80</span></span>
<span id="cb219-60"><a href="manipulating-data.html#cb219-60" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 16 more rows</span></span></code></pre></div>
<p>Apart from some warnings about how it’s hard to take the minimum or maximum of a bunch of missing data (which is fair), we can see a message:
<code>summarise()</code> regrouping output by ‘gender’ (override with ‘.groups’ argument)</p>
<p>What this message is saying is that it is essentially dropping one layer of grouping (race) and grouping only by gender – but it’s also nice enough to tell you that you can override the default option if you want to do so by using the <code>.groups</code> argument. <code>?summarize</code><a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> gives you several options for how to handle the grouping of the result.</p>
We grouped pv by gender and race, then ran summarize, which created one row for each combination of gender and race and “glued” them together. The resulting data frame is still grouped by gender, but because there’s only one row for each race (for each level/group of gender), there’s no reason to have that level of grouping anymore. So it’s dropped by default.
</details>
<details>
<summary>
Replicating PROC FREQ using PROC SQL
</summary>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


8          DATA pv;
9            SET classdat.police;
10           age = INPUT(victim_s_age, 3.);
11           IF victim_s_gender=&#39; &#39; THEN victim_s_gender=&#39;Unknown&#39;;
12           race = victim_s_race; /* initialize it to current value */
13           IF victim_s_race=&#39;Unknown Race&#39; THEN race = &#39;Unknown race&#39;;
14         RUN;

NOTE: The data set WORK.PV has 0 observations and 27 variables.
WARNING: Data set WORK.PV was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

15         
16         PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
17           SELECT victim_s_gender AS gender, race, count(*) AS n
18           FROM pv
19           GROUP BY race;
ERROR: The following columns were not found in the contributing tables: 
       race.
20         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


21         PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
22           SELECT victim_s_gender AS gender, race, count(*) AS n,
22       ! min(age) AS min_age, max(age) AS max_age
23           FROM pv
24           GROUP BY gender, race;
ERROR: The following columns were not found in the contributing tables: 
       race.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13,16.</code></pre>
</details>
<p>Let’s try a non-trivial example, using the <code>storms</code> dataset that is part of the <code>dplyr</code> package:</p>
<details>
<summary>
Reading in the data (R and SAS)
</summary>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="manipulating-data.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb221-2"><a href="manipulating-data.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># for the make_datetime() function</span></span>
<span id="cb221-3"><a href="manipulating-data.html#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="manipulating-data.html#cb221-4" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">&#39;lubridate&#39;</span></span>
<span id="cb221-5"><a href="manipulating-data.html#cb221-5" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:base&#39;</span><span class="sc">:</span></span>
<span id="cb221-6"><a href="manipulating-data.html#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="manipulating-data.html#cb221-7" aria-hidden="true" tabindex="-1"></a>    date, intersect, setdiff, union</span>
<span id="cb221-8"><a href="manipulating-data.html#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(storms)</span>
<span id="cb221-9"><a href="manipulating-data.html#cb221-9" aria-hidden="true" tabindex="-1"></a>storms</span>
<span id="cb221-10"><a href="manipulating-data.html#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10,010 x 13</span></span>
<span id="cb221-11"><a href="manipulating-data.html#cb221-11" aria-hidden="true" tabindex="-1"></a>   name   year month   day  hour   lat  long status      category  wind pressure</span>
<span id="cb221-12"><a href="manipulating-data.html#cb221-12" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>ord<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb221-13"><a href="manipulating-data.html#cb221-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">27</span>     <span class="dv">0</span>  <span class="fl">27.5</span> <span class="sc">-</span><span class="dv">79</span>   tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1013</span></span>
<span id="cb221-14"><a href="manipulating-data.html#cb221-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">27</span>     <span class="dv">6</span>  <span class="fl">28.5</span> <span class="sc">-</span><span class="dv">79</span>   tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1013</span></span>
<span id="cb221-15"><a href="manipulating-data.html#cb221-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">27</span>    <span class="dv">12</span>  <span class="fl">29.5</span> <span class="sc">-</span><span class="dv">79</span>   tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1013</span></span>
<span id="cb221-16"><a href="manipulating-data.html#cb221-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">27</span>    <span class="dv">18</span>  <span class="fl">30.5</span> <span class="sc">-</span><span class="dv">79</span>   tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1013</span></span>
<span id="cb221-17"><a href="manipulating-data.html#cb221-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">28</span>     <span class="dv">0</span>  <span class="fl">31.5</span> <span class="sc">-</span><span class="fl">78.8</span> tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1012</span></span>
<span id="cb221-18"><a href="manipulating-data.html#cb221-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">28</span>     <span class="dv">6</span>  <span class="fl">32.4</span> <span class="sc">-</span><span class="fl">78.7</span> tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1012</span></span>
<span id="cb221-19"><a href="manipulating-data.html#cb221-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">28</span>    <span class="dv">12</span>  <span class="fl">33.3</span> <span class="sc">-</span><span class="dv">78</span>   tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">25</span>     <span class="dv">1011</span></span>
<span id="cb221-20"><a href="manipulating-data.html#cb221-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">28</span>    <span class="dv">18</span>  <span class="dv">34</span>   <span class="sc">-</span><span class="dv">77</span>   tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">30</span>     <span class="dv">1006</span></span>
<span id="cb221-21"><a href="manipulating-data.html#cb221-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">29</span>     <span class="dv">0</span>  <span class="fl">34.4</span> <span class="sc">-</span><span class="fl">75.8</span> tropical s… <span class="dv">0</span>           <span class="dv">35</span>     <span class="dv">1004</span></span>
<span id="cb221-22"><a href="manipulating-data.html#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Amy    <span class="dv">1975</span>     <span class="dv">6</span>    <span class="dv">29</span>     <span class="dv">6</span>  <span class="dv">34</span>   <span class="sc">-</span><span class="fl">74.8</span> tropical s… <span class="dv">0</span>           <span class="dv">40</span>     <span class="dv">1002</span></span>
<span id="cb221-23"><a href="manipulating-data.html#cb221-23" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 10,000 more rows, and 2 more variables: ts_diameter &lt;dbl&gt;,</span></span>
<span id="cb221-24"><a href="manipulating-data.html#cb221-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   hu_diameter &lt;dbl&gt;</span></span>
<span id="cb221-25"><a href="manipulating-data.html#cb221-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-26"><a href="manipulating-data.html#cb221-26" aria-hidden="true" tabindex="-1"></a>storms <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span></span>
<span id="cb221-27"><a href="manipulating-data.html#cb221-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct a time variable that behaves like a number but is formatted as a date</span></span>
<span id="cb221-28"><a href="manipulating-data.html#cb221-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">make_datetime</span>(year, month, day, hour))</span></code></pre></div>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          filename fileloc &#39;data/storms.csv&#39;;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      


NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: The SAS System stopped processing this step because of errors.
8          PROC IMPORT  datafile = fileloc out=classdat.storms REPLACE
9          DBMS = csv; /* comma delimited file */
10         GUESSINGROWS=500;
11         GETNAMES = YES;
12         RUN;
13         


14         DATA classdat.storms;
15         SET classdat.storms;
16         date = MDY(month, day, year);
17         time = DHMS(date, hour, 0, 0);
18         FORMAT time DATETIME.;
19         RUN;

NOTE: The data set CLASSDAT.STORMS has 0 observations and 15 variables.
WARNING: Data set CLASSDAT.STORMS was not replaced because this step was 
         stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13,16,17.</code></pre>
We have named storms, observation time, storm location, status, wind, pressure, and diameter (for tropical storms and hurricanes).
</details>
<p>One thing we might want to know is at what point each storm was the strongest. Let’s define strongest in the following way:</p>
<ol style="list-style-type: decimal">
<li>The points where the storm is at its lowest atmospheric pressure (generally, the lower the atmospheric pressure, the more trouble a tropical disturbance will cause).</li>
<li>If there’s a tie, we might want to know when the maximum wind speed occurred.</li>
<li>If that still doesn’t get us a single row for each observation, lets just pick out the status and category (these are determined by wind speed, so they should be the same if maximum wind speed is the same) and compute the average time where this occurred.</li>
</ol>
<details>
<summary>
group_by + filter + summary in R
</summary>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="manipulating-data.html#cb223-1" aria-hidden="true" tabindex="-1"></a>max_power_storm <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span></span>
<span id="cb223-2"><a href="manipulating-data.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Storm names can be reused, so we need to have year to be sure it&#39;s the same instance</span></span>
<span id="cb223-3"><a href="manipulating-data.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb223-4"><a href="manipulating-data.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="fu">min</span>(pressure, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb223-5"><a href="manipulating-data.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind <span class="sc">==</span> <span class="fu">max</span>(wind, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb223-6"><a href="manipulating-data.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pressure =</span> <span class="fu">mean</span>(pressure), </span>
<span id="cb223-7"><a href="manipulating-data.html#cb223-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">wind =</span> <span class="fu">mean</span>(wind), </span>
<span id="cb223-8"><a href="manipulating-data.html#cb223-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">category =</span> <span class="fu">unique</span>(category), </span>
<span id="cb223-9"><a href="manipulating-data.html#cb223-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">status =</span> <span class="fu">unique</span>(status), </span>
<span id="cb223-10"><a href="manipulating-data.html#cb223-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">time =</span> <span class="fu">mean</span>(time)) <span class="sc">%&gt;%</span></span>
<span id="cb223-11"><a href="manipulating-data.html#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb223-12"><a href="manipulating-data.html#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb223-13"><a href="manipulating-data.html#cb223-13" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">summarise()</span><span class="st">`</span> has grouped output by <span class="st">&#39;name&#39;</span>. You can override using the <span class="st">`</span><span class="at">.groups</span><span class="st">`</span> argument.</span>
<span id="cb223-14"><a href="manipulating-data.html#cb223-14" aria-hidden="true" tabindex="-1"></a>max_power_storm</span>
<span id="cb223-15"><a href="manipulating-data.html#cb223-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 426 x 7</span></span>
<span id="cb223-16"><a href="manipulating-data.html#cb223-16" aria-hidden="true" tabindex="-1"></a>   name      year pressure  wind category status         time               </span>
<span id="cb223-17"><a href="manipulating-data.html#cb223-17" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>ord<span class="sc">&gt;</span>    <span class="er">&lt;</span>chr<span class="sc">&gt;</span>          <span class="er">&lt;</span>dttm<span class="sc">&gt;</span>             </span>
<span id="cb223-18"><a href="manipulating-data.html#cb223-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Amy       <span class="dv">1975</span>      <span class="dv">981</span>    <span class="dv">60</span> <span class="dv">0</span>        tropical storm <span class="dv">1975-07-02</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-19"><a href="manipulating-data.html#cb223-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Caroline  <span class="dv">1975</span>      <span class="dv">963</span>   <span class="dv">100</span> <span class="dv">3</span>        hurricane      <span class="dv">1975-08-31</span> <span class="dv">06</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-20"><a href="manipulating-data.html#cb223-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Doris     <span class="dv">1975</span>      <span class="dv">965</span>    <span class="dv">95</span> <span class="dv">2</span>        hurricane      <span class="dv">1975-09-02</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-21"><a href="manipulating-data.html#cb223-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Belle     <span class="dv">1976</span>      <span class="dv">957</span>   <span class="dv">105</span> <span class="dv">3</span>        hurricane      <span class="dv">1976-08-09</span> <span class="dv">00</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-22"><a href="manipulating-data.html#cb223-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Gloria    <span class="dv">1976</span>      <span class="dv">970</span>    <span class="dv">80</span> <span class="dv">1</span>        hurricane      <span class="dv">1976-09-30</span> <span class="dv">00</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-23"><a href="manipulating-data.html#cb223-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Anita     <span class="dv">1977</span>      <span class="dv">926</span>   <span class="dv">150</span> <span class="dv">5</span>        hurricane      <span class="dv">1977-09-02</span> <span class="dv">06</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-24"><a href="manipulating-data.html#cb223-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Clara     <span class="dv">1977</span>      <span class="dv">993</span>    <span class="dv">65</span> <span class="dv">1</span>        hurricane      <span class="dv">1977-09-08</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-25"><a href="manipulating-data.html#cb223-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Evelyn    <span class="dv">1977</span>      <span class="dv">994</span>    <span class="dv">65</span> <span class="dv">1</span>        hurricane      <span class="dv">1977-10-15</span> <span class="dv">00</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-26"><a href="manipulating-data.html#cb223-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Amelia    <span class="dv">1978</span>     <span class="dv">1005</span>    <span class="dv">45</span> <span class="dv">0</span>        tropical storm <span class="dv">1978-07-31</span> <span class="dv">00</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-27"><a href="manipulating-data.html#cb223-27" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Bess      <span class="dv">1978</span>     <span class="dv">1005</span>    <span class="dv">40</span> <span class="dv">0</span>        tropical storm <span class="dv">1978-08-07</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">00</span></span>
<span id="cb223-28"><a href="manipulating-data.html#cb223-28" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 416 more rows</span></span></code></pre></div>
<p>If we want to see a visual summary, we could plot a histogram of the minimum pressure of each storm.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="manipulating-data.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb224-2"><a href="manipulating-data.html#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(max_power_storm, <span class="fu">aes</span>(<span class="at">x =</span> pressure)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span>
<span id="cb224-3"><a href="manipulating-data.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">stat_bin()</span><span class="st">`</span> using <span class="st">`</span><span class="at">bins = 30</span><span class="st">`</span>. Pick better value with <span class="st">`</span><span class="at">binwidth</span><span class="st">`</span>.</span></code></pre></div>
<p><img src="image/ggplot-storms-1.png" width="2100" /></p>
<p>We could also look to see whether there has been any change over time in pressure.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="manipulating-data.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(max_power_storm, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> pressure)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="image/ggplot-power-pressure-1.png" width="2100" /></p>
It seems to me that there are fewer high-pressure storms before 1990 or so, which may be due to the fact that some weak storms may not have been observed or recorded prior to widespread radar coverage in the Atlantic (see <a href="image/weather_radar_graph_1995.gif">this coverage map from 1995</a>).
</details>
<details>
<summary>
Proc SQL in SAS
</summary>
<p>In SAS, this is going to require some work. Specifically, while dplyr commands are stated in recipe order (do this, then this), SQL statements… aren’t. WHERE comes after SELECT xxx FROM yyy, and GROUP BY comes after that again.</p>
<p>There are a couple of ways to handle that: sub-queries, and creating temporary tables. I think the temporary tables approach will be easier to demonstrate, read, and understand, so lets go with that.</p>
<p>Another challenge will be the fact that SAS PROC SQL doesn’t handle missing data quite as easily as dplyr does (na.rm is a very nice function, all things considered).
We can think through the steps we need to take:
1. Create a table where wind and pressure observations aren’t missing. We’ll call that tmp1.
2. Filter tmp1, keeping only rows with minimum pressure and maximum wind for each storm/year combination (HAVING is like WHERE, but after the GROUP BY clause has been applied). We’ll call that tmp2. We can also select the variables we care about in this step.
3. Summarize tmp2, keeping columns name, year, pressure, wind, category, status, and time, where time is the mean of all maximum-power observations. The other variables should have only one value each. We can accomplish this task using the combination of SELECT and DISTINCT. DISTINCT says “keep only rows with new combinations of these values.”</p>
<p>(Note also that we can format values inline in proc SQL Select statements. That forces SAS to treat time as a date-time variable, which will force it to format correctly in e.g. plots.)</p>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          
9          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
10           CREATE TABLE tmp1 AS
11           SELECT *
12           FROM classdat.storms
13           WHERE (NOT missing(pressure)) AND (NOT missing(wind));
NOTE: Statement not executed due to NOEXEC option.
14         
15           CREATE TABLE tmp2 AS
16           SELECT name, year, pressure, wind, category, status, time,
17                  min(pressure) AS minpressure, max(wind) AS maxwind
18           FROM tmp1
19           GROUP BY year, name
20           HAVING pressure = minpressure AND wind = maxwind;
NOTE: Statement not executed due to NOEXEC option.
21         
22           CREATE TABLE maxpwr AS
23           SELECT DISTINCT name, year, pressure, wind, category, status,
24                           mean(time) AS time format=DATETIME.
25           FROM tmp2
26           GROUP BY year, name;
NOTE: Statement not executed due to NOEXEC option.
27         
28         QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
29         


30         PROC PRINT DATA=maxpwr (obs=5);
ERROR: File WORK.MAXPWR.DATA does not exist.
31           RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
32         
33         ODS GRAPHICS ON;
34         ODS TRACE ON; /* this allows us to select only the plot and not
34       ! tables */
35         ODS SELECT HISTOGRAM;


36         PROC UNIVARIATE DATA=maxpwr;
ERROR: File WORK.MAXPWR.DATA does not exist.
37           VAR pressure;
ERROR: No data set open to look up variables.
38           HISTOGRAM;
39           RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
WARNING: Output &#39;HISTOGRAM&#39; was not created.  Make sure that the output 
         object name, label, or path is spelled correctly.  Also, verify 
         that the appropriate procedure options are used to produce the 
         requested output object.  For example, verify that the NOPRINT 
         option is not used.
40         ODS TRACE OFF;
41         


42         PROC SGPLOT DATA=maxpwr;
ERROR: File WORK.MAXPWR.DATA does not exist.
43           scatter X = time Y = pressure;
ERROR: No data set open to look up variables.
ERROR: No data set open to look up variables.
44         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SGPLOT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
45         
46         ODS GRAPHICS OFF;
47         QUIT;


ERROR: Errors printed on pages 5,7,12,13,16,17.</code></pre>
</details>
<details>
<summary>
Another interesting way to look at this data would be to examine the duration of time a storm existed, as a function of its maximum category. Do stronger storms exist for a longer period of time?
</summary>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="manipulating-data.html#cb227-1" aria-hidden="true" tabindex="-1"></a>storm_strength_duration <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span></span>
<span id="cb227-2"><a href="manipulating-data.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb227-3"><a href="manipulating-data.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">duration =</span> <span class="fu">difftime</span>(<span class="fu">max</span>(time), <span class="fu">min</span>(time), <span class="at">units =</span> <span class="st">&quot;days&quot;</span>), </span>
<span id="cb227-4"><a href="manipulating-data.html#cb227-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_strength =</span> <span class="fu">max</span>(category)) <span class="sc">%&gt;%</span></span>
<span id="cb227-5"><a href="manipulating-data.html#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb227-6"><a href="manipulating-data.html#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(max_strength))</span>
<span id="cb227-7"><a href="manipulating-data.html#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">summarise()</span><span class="st">`</span> has grouped output by <span class="st">&#39;name&#39;</span>. You can override using the <span class="st">`</span><span class="at">.groups</span><span class="st">`</span> argument.</span>
<span id="cb227-8"><a href="manipulating-data.html#cb227-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-9"><a href="manipulating-data.html#cb227-9" aria-hidden="true" tabindex="-1"></a>storm_strength_duration <span class="sc">%&gt;%</span></span>
<span id="cb227-10"><a href="manipulating-data.html#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> max_strength, <span class="at">y =</span> duration)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb227-11"><a href="manipulating-data.html#cb227-11" aria-hidden="true" tabindex="-1"></a>Don<span class="st">&#39;t know how to automatically pick scale for object of type difftime. Defaulting to continuous.</span></span></code></pre></div>
<p><img src="image/duration-storm-1.png" width="2100" />
You don’t need to know how to create these plots yet, but I find it much easier to look at the chart and answer the question I started out with.</p>
<p>In SAS, we have to know that <a href="https://documentation.sas.com/?docsetId=ds2pg&amp;docsetTarget=n02zpqz4j5u3j9n1t0i95ncqep5g.htm&amp;docsetVersion=3.1&amp;locale=en">datetimes are stored in seconds</a>. So if we subtract two date time values, and we want our answer in days, then we need to divide by the number of seconds in a day: 24*60*60 = 86400. R has helper functions to do this for us, but it’s not that much harder to just do the computuation ourselves.</p>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas


7          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
8          CREATE TABLE stormlencat AS
9          SELECT name, year, (max(time) - min(time))/86400 AS duration,
9        ! max(category) AS max_strength
10         FROM classdat.storms
11         GROUP BY year, name
12         ORDER BY max_strength;
NOTE: Statement not executed due to NOEXEC option.
13         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


14         PROC BOXPLOT DATA=stormlencat;
ERROR: File WORK.STORMLENCAT.DATA does not exist.
15           PLOT duration * max_strength;
ERROR: No data set open to look up variables.
16         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE BOXPLOT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
17         QUIT;


ERROR: Errors printed on pages 5,7,12,13,16,17,18.</code></pre>
</details>
<details>
<summary>
We could also look to see how a storm’s diameter evolves over time, from when the storm is first identified (group_by + mutate)
</summary>
<p>Diameter measurements don’t exist for all storms, and they appear to measure the diameter of the wind field - that is, the region where the winds are hurricane or tropical storm force. (<code>?storms</code> documents the dataset and its variables).</p>
<p>Note the use of <code>as.numeric(as.character(max(category)))</code> to get the maximum (ordinal categorial) strength and convert that into something numeric that can be plotted.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="manipulating-data.html#cb229-1" aria-hidden="true" tabindex="-1"></a>storm_evolution <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="manipulating-data.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(hu_diameter)) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="manipulating-data.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb229-4"><a href="manipulating-data.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_since_start =</span> <span class="fu">difftime</span>(time, <span class="fu">min</span>(time), <span class="at">units =</span> <span class="st">&quot;days&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb229-5"><a href="manipulating-data.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb229-6"><a href="manipulating-data.html#cb229-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-7"><a href="manipulating-data.html#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storm_evolution, </span>
<span id="cb229-8"><a href="manipulating-data.html#cb229-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> time_since_start, <span class="at">y =</span> hu_diameter, </span>
<span id="cb229-9"><a href="manipulating-data.html#cb229-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> name)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb229-10"><a href="manipulating-data.html#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb229-11"><a href="manipulating-data.html#cb229-11" aria-hidden="true" tabindex="-1"></a>Don<span class="st">&#39;t know how to automatically pick scale for object of type difftime. Defaulting to continuous.</span></span></code></pre></div>
<p><img src="image/storm-evo-1.png" width="2100" /></p>
<p>For this plot, I’ve added <code>facet_wrap(~year)</code> to produce sub-plots for each year. This helps us to be able to see some individuality, because otherwise there are far too many storms.</p>
<p>We can do something similar in SAS; this time, I decided to get rid of any storm which never had hurricane-force winds - that will get rid of a lot of lines that never leave the x-axis.</p>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas


7          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
8          CREATE TABLE stormevo AS
9          SELECT name, year, (time - min(time))/86400 AS time_since_start,
9        !  category, status, hu_diameter, ts_diameter, max(hu_diameter) AS
9        !  max_hu_diameter
10         FROM classdat.storms
11         WHERE NOT MISSING(hu_diameter)
12         GROUP BY year, name
13         HAVING max_hu_diameter &gt; 0
14         ORDER BY year, name, time_since_start;
NOTE: Statement not executed due to NOEXEC option.
15         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


16         PROC SGPANEL DATA=stormevo;
ERROR: File WORK.STORMEVO.DATA does not exist.
17         PANELBY year / COLUMNS = 4 ROWS = 3;
ERROR: No data set open to look up variables.
18         SERIES X = time_since_start Y = hu_diameter / GROUP = name;
ERROR: No data set open to look up variables.
ERROR: No data set open to look up variables.
ERROR: No data set open to look up variables.
19         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SGPANEL used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      
20         QUIT;


ERROR: Errors printed on pages 5,7,12,13,16,17,18.</code></pre>
<p>PROC SGPANEL in SAS does essentially the same thing as facet_wrap() in R - it allows you to select one or more variables to create sub-plots for. We do have to manually specify how many rows and columns (or SAS will give us 3 separate plots with 4 panels each). The essential components of the graph specification are the same - instead of specifying the use of a line, we specify “series” (which means plot a line). We specify the same x, y, and group variables, though the syntax differs a bit.</p>
<p>It seems that the vast majority of storms have a single bout of hurricane force winds (which either decreases or just terminates near the peak, presumably when the storm hits land and rapidly disintegrates). However, there are a few interesting exceptions - my favorite is in 2008 - the longest-lasting storm seems to have several local peaks in wind field diameter. If we want, we can examine that further by plotting it separately.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="manipulating-data.html#cb231-1" aria-hidden="true" tabindex="-1"></a>storm_evolution <span class="sc">%&gt;%</span></span>
<span id="cb231-2"><a href="manipulating-data.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb231-3"><a href="manipulating-data.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(time_since_start))</span>
<span id="cb231-4"><a href="manipulating-data.html#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 327 x 15</span></span>
<span id="cb231-5"><a href="manipulating-data.html#cb231-5" aria-hidden="true" tabindex="-1"></a>   name   year month   day  hour   lat  long status      category  wind pressure</span>
<span id="cb231-6"><a href="manipulating-data.html#cb231-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>ord<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb231-7"><a href="manipulating-data.html#cb231-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">14</span>     <span class="dv">6</span>  <span class="fl">35.5</span> <span class="sc">-</span><span class="fl">93.7</span> tropical s… <span class="dv">0</span>           <span class="dv">35</span>      <span class="dv">985</span></span>
<span id="cb231-8"><a href="manipulating-data.html#cb231-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">14</span>     <span class="dv">0</span>  <span class="fl">33.5</span> <span class="sc">-</span><span class="fl">94.9</span> tropical s… <span class="dv">0</span>           <span class="dv">35</span>      <span class="dv">980</span></span>
<span id="cb231-9"><a href="manipulating-data.html#cb231-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">13</span>    <span class="dv">18</span>  <span class="fl">31.7</span> <span class="sc">-</span><span class="fl">95.3</span> tropical s… <span class="dv">0</span>           <span class="dv">50</span>      <span class="dv">974</span></span>
<span id="cb231-10"><a href="manipulating-data.html#cb231-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">13</span>    <span class="dv">12</span>  <span class="fl">30.3</span> <span class="sc">-</span><span class="fl">95.2</span> hurricane   <span class="dv">2</span>           <span class="dv">85</span>      <span class="dv">959</span></span>
<span id="cb231-11"><a href="manipulating-data.html#cb231-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">13</span>     <span class="dv">7</span>  <span class="fl">29.3</span> <span class="sc">-</span><span class="fl">94.7</span> hurricane   <span class="dv">2</span>           <span class="dv">95</span>      <span class="dv">950</span></span>
<span id="cb231-12"><a href="manipulating-data.html#cb231-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">13</span>     <span class="dv">6</span>  <span class="fl">29.1</span> <span class="sc">-</span><span class="fl">94.6</span> hurricane   <span class="dv">2</span>           <span class="dv">95</span>      <span class="dv">951</span></span>
<span id="cb231-13"><a href="manipulating-data.html#cb231-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">13</span>     <span class="dv">0</span>  <span class="fl">28.3</span> <span class="sc">-</span><span class="dv">94</span>   hurricane   <span class="dv">2</span>           <span class="dv">95</span>      <span class="dv">952</span></span>
<span id="cb231-14"><a href="manipulating-data.html#cb231-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Fay    <span class="dv">2008</span>     <span class="dv">8</span>    <span class="dv">27</span>     <span class="dv">0</span>  <span class="dv">35</span>   <span class="sc">-</span><span class="fl">85.8</span> tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">15</span>     <span class="dv">1005</span></span>
<span id="cb231-15"><a href="manipulating-data.html#cb231-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Ike    <span class="dv">2008</span>     <span class="dv">9</span>    <span class="dv">12</span>    <span class="dv">18</span>  <span class="fl">27.5</span> <span class="sc">-</span><span class="fl">93.2</span> hurricane   <span class="dv">2</span>           <span class="dv">95</span>      <span class="dv">954</span></span>
<span id="cb231-16"><a href="manipulating-data.html#cb231-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Fay    <span class="dv">2008</span>     <span class="dv">8</span>    <span class="dv">26</span>    <span class="dv">18</span>  <span class="fl">34.6</span> <span class="sc">-</span><span class="fl">86.5</span> tropical d… <span class="sc">-</span><span class="dv">1</span>          <span class="dv">20</span>     <span class="dv">1004</span></span>
<span id="cb231-17"><a href="manipulating-data.html#cb231-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 317 more rows, and 4 more variables: ts_diameter &lt;dbl&gt;,</span></span>
<span id="cb231-18"><a href="manipulating-data.html#cb231-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   hu_diameter &lt;dbl&gt;, time &lt;dttm&gt;, time_since_start &lt;drtn&gt;</span></span>
<span id="cb231-19"><a href="manipulating-data.html#cb231-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-20"><a href="manipulating-data.html#cb231-20" aria-hidden="true" tabindex="-1"></a>storm_evolution <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;Ike&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb231-21"><a href="manipulating-data.html#cb231-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> hu_diameter, <span class="at">color =</span> category)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="image/storm-evo-year-1.png" width="2100" /></p>
<p>The SAS code for this is fairly similar (though I’ll admit to not having the finesse with SAS to get a truly nice looking plot). At this point, we’re going for quick-and-dirty graphics that show us what we want to know - we can figure out how to customize things later.</p>
<pre class="sashtml"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE ike AS
10         SELECT * FROM classdat.storms WHERE name = &quot;Ike&quot;
11         ORDER BY time;
NOTE: Statement not executed due to NOEXEC option.
12         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


13         PROC SGPLOT DATA=ike;
ERROR: File WORK.IKE.DATA does not exist.
14         SCATTER X = time Y = hu_diameter /
ERROR: No data set open to look up variables.
15           COLORRESPONSE=category /* color by another variable */
ERROR: No data set open to look up variables.
16           MARKERATTRS=(symbol=CircleFilled) /* use circles for points */
ERROR: No data set open to look up variables.
17           DATALABEL=category; /* label the circles with the value */
ERROR: No data set open to look up variables.
18         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SGPLOT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
19         QUIT;


ERROR: Errors printed on pages 5,7,12,13,16,17,18,19.</code></pre>
<p>While I’m tempted to plot out the diameter and location on a map, it’s a bit excessive for this particular problem. Luckily, Wikipedia has us covered:
<img src="https://upload.wikimedia.org/wikipedia/commons/5/5f/Ike_2008_track.png" alt="Hurricane Ike’s path and strength over time" /></p>
It looks like Ike went long-ways across Cuba, which weakened it. When hurricanes weaken, often their wind fields expand (as they no longer have the angular momentum to maintain a tight structure). Ike crossed into the Gulf of Mexico, restrengthened, and then hit Houston just about dead-on. (I was living just northwest of Houston when it hit (in College Station), and I can verify that it was not a fun time).
</details>
</div>
<div id="other-dplyr-functions-across-relocate" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Other <code>dplyr</code> functions: across, relocate</h2>
<p>The dplyr package is filled with other handy functions for accomplishing common data-wrangling tasks. <code>across()</code> is particularly useful - it allows you to make a modification to several columns at the same time.</p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/raw/master/rstats-artwork/dplyr_across.png" alt="" />
<p class="caption">dplyr’s across() function lets you apply a mutate or summarize statement to many columns (by Allison Horst)</p>
</div>
<p>Suppose we want to summarize the numerical columns of any storm which was a hurricane (over the entire period it was a hurricane). We don’t want to write out all of the summarize statements individually, so we use across() instead.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="manipulating-data.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># for the make_datetime() function</span></span>
<span id="cb233-2"><a href="manipulating-data.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(storms)</span>
<span id="cb233-3"><a href="manipulating-data.html#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="manipulating-data.html#cb233-4" aria-hidden="true" tabindex="-1"></a>storms <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span></span>
<span id="cb233-5"><a href="manipulating-data.html#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct a time variable that behaves like a number but is formatted as a date</span></span>
<span id="cb233-6"><a href="manipulating-data.html#cb233-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">make_datetime</span>(year, month, day, hour))</span>
<span id="cb233-7"><a href="manipulating-data.html#cb233-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-8"><a href="manipulating-data.html#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use across to get average of all numeric variables</span></span>
<span id="cb233-9"><a href="manipulating-data.html#cb233-9" aria-hidden="true" tabindex="-1"></a>avg_hurricane_intensity <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span></span>
<span id="cb233-10"><a href="manipulating-data.html#cb233-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status <span class="sc">==</span> <span class="st">&quot;hurricane&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-11"><a href="manipulating-data.html#cb233-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb233-12"><a href="manipulating-data.html#cb233-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> T), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) </span>
<span id="cb233-13"><a href="manipulating-data.html#cb233-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-14"><a href="manipulating-data.html#cb233-14" aria-hidden="true" tabindex="-1"></a>avg_hurricane_intensity <span class="sc">%&gt;%</span></span>
<span id="cb233-15"><a href="manipulating-data.html#cb233-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, year, month, wind, pressure, ts_diameter, hu_diameter) <span class="sc">%&gt;%</span></span>
<span id="cb233-16"><a href="manipulating-data.html#cb233-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(wind)) <span class="sc">%&gt;%</span> </span>
<span id="cb233-17"><a href="manipulating-data.html#cb233-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get top 10</span></span>
<span id="cb233-18"><a href="manipulating-data.html#cb233-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-19"><a href="manipulating-data.html#cb233-19" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="co"># Make into a pretty table</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">year</th>
<th align="right">month</th>
<th align="right">wind</th>
<th align="right">pressure</th>
<th align="right">ts_diameter</th>
<th align="right">hu_diameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Andrew</td>
<td align="right">1992.000</td>
<td align="right">8.000000</td>
<td align="right">118.2609</td>
<td align="right">946.6522</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Mitch</td>
<td align="right">1998.000</td>
<td align="right">10.000000</td>
<td align="right">115.9091</td>
<td align="right">945.3182</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="odd">
<td align="left">Rita</td>
<td align="right">2005.000</td>
<td align="right">9.000000</td>
<td align="right">114.7368</td>
<td align="right">931.6316</td>
<td align="right">305.2952</td>
<td align="right">111.6934</td>
</tr>
<tr class="even">
<td align="left">Isabel</td>
<td align="right">2003.000</td>
<td align="right">9.000000</td>
<td align="right">112.1875</td>
<td align="right">946.5417</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="odd">
<td align="left">Gilbert</td>
<td align="right">1988.000</td>
<td align="right">9.000000</td>
<td align="right">110.8929</td>
<td align="right">945.4286</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Wilma</td>
<td align="right">2005.000</td>
<td align="right">10.000000</td>
<td align="right">110.3030</td>
<td align="right">939.4242</td>
<td align="right">402.5812</td>
<td align="right">136.1756</td>
</tr>
<tr class="odd">
<td align="left">Hugo</td>
<td align="right">1989.000</td>
<td align="right">9.000000</td>
<td align="right">106.5789</td>
<td align="right">950.9211</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">David</td>
<td align="right">1979.000</td>
<td align="right">8.457143</td>
<td align="right">105.1429</td>
<td align="right">956.1429</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="odd">
<td align="left">Luis</td>
<td align="right">1995.000</td>
<td align="right">8.893617</td>
<td align="right">104.1489</td>
<td align="right">951.8298</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Ivan</td>
<td align="right">1996.652</td>
<td align="right">9.269663</td>
<td align="right">103.5393</td>
<td align="right">953.9438</td>
<td align="right">315.9642</td>
<td align="right">115.2031</td>
</tr>
</tbody>
</table>
<p>Another handy dplyr function is relocate; while you definitely can do this operation in many, many different ways, it may be simpler to do it using relocate. But, I’m covering relocate here if only because it also comes with this handy cartoon illustration.</p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/raw/master/rstats-artwork/dplyr_relocate.png" alt="" />
<p class="caption">relocate lets you rearrange columns (by Allison Horst)</p>
</div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="manipulating-data.html#cb234-1" aria-hidden="true" tabindex="-1"></a>avg_hurricane_intensity <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="manipulating-data.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">relocate</span>(<span class="fu">c</span>(wind, pressure), <span class="at">.after =</span> month)</span>
<span id="cb234-3"><a href="manipulating-data.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 121 x 11</span></span>
<span id="cb234-4"><a href="manipulating-data.html#cb234-4" aria-hidden="true" tabindex="-1"></a>   name      year month  wind pressure   day  hour   lat  long ts_diameter</span>
<span id="cb234-5"><a href="manipulating-data.html#cb234-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb234-6"><a href="manipulating-data.html#cb234-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> AL121991 <span class="dv">1991</span>  <span class="dv">11</span>     <span class="dv">65</span>       <span class="fl">980.</span>  <span class="fl">1.5</span>   <span class="dv">9</span>     <span class="fl">38.8</span> <span class="sc">-</span><span class="fl">66.1</span>        <span class="cn">NaN</span> </span>
<span id="cb234-7"><a href="manipulating-data.html#cb234-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Alberto  <span class="fl">1999.</span>  <span class="fl">7.92</span>  <span class="fl">78.3</span>     <span class="fl">978.</span> <span class="fl">13.4</span>   <span class="fl">8.82</span>  <span class="fl">30.8</span> <span class="sc">-</span><span class="fl">49.0</span>        <span class="cn">NaN</span> </span>
<span id="cb234-8"><a href="manipulating-data.html#cb234-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Alex     <span class="fl">2006.</span>  <span class="fl">7.38</span>  <span class="fl">83.1</span>     <span class="fl">966.</span> <span class="dv">10</span>     <span class="fl">8.24</span>  <span class="dv">33</span>   <span class="sc">-</span><span class="fl">77.1</span>        <span class="fl">304.</span></span>
<span id="cb234-9"><a href="manipulating-data.html#cb234-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Alicia   <span class="dv">1983</span>   <span class="dv">8</span>     <span class="fl">84.4</span>     <span class="fl">974.</span> <span class="fl">17.5</span>   <span class="fl">7.62</span>  <span class="fl">28.4</span> <span class="sc">-</span><span class="fl">94.5</span>        <span class="cn">NaN</span> </span>
<span id="cb234-10"><a href="manipulating-data.html#cb234-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Allison  <span class="dv">1995</span>   <span class="dv">6</span>     <span class="dv">65</span>       <span class="fl">988.</span>  <span class="fl">4.33</span> <span class="dv">10</span>     <span class="fl">26.2</span> <span class="sc">-</span><span class="fl">86.2</span>        <span class="cn">NaN</span> </span>
<span id="cb234-11"><a href="manipulating-data.html#cb234-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Andrew   <span class="dv">1992</span>   <span class="dv">8</span>    <span class="fl">118.</span>      <span class="fl">947.</span> <span class="fl">24.0</span>   <span class="fl">9.09</span>  <span class="fl">26.4</span> <span class="sc">-</span><span class="fl">80.4</span>        <span class="cn">NaN</span> </span>
<span id="cb234-12"><a href="manipulating-data.html#cb234-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Anita    <span class="dv">1977</span>   <span class="fl">8.62</span>  <span class="fl">93.1</span>     <span class="fl">968.</span> <span class="fl">12.8</span>   <span class="fl">9.69</span>  <span class="fl">25.3</span> <span class="sc">-</span><span class="fl">94.2</span>        <span class="cn">NaN</span> </span>
<span id="cb234-13"><a href="manipulating-data.html#cb234-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Arthur   <span class="dv">2014</span>   <span class="dv">7</span>     <span class="fl">77.3</span>     <span class="fl">978.</span>  <span class="fl">3.73</span>  <span class="fl">7.55</span>  <span class="fl">34.6</span> <span class="sc">-</span><span class="fl">76.1</span>        <span class="fl">209.</span></span>
<span id="cb234-14"><a href="manipulating-data.html#cb234-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Barry    <span class="dv">1983</span>   <span class="dv">8</span>     <span class="fl">68.3</span>     <span class="fl">988.</span> <span class="dv">28</span>    <span class="fl">15.7</span>   <span class="fl">25.4</span> <span class="sc">-</span><span class="fl">97.1</span>        <span class="cn">NaN</span> </span>
<span id="cb234-15"><a href="manipulating-data.html#cb234-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Belle    <span class="dv">1976</span>   <span class="dv">8</span>     <span class="dv">91</span>       <span class="fl">966.</span>  <span class="fl">8.5</span>   <span class="dv">9</span>     <span class="fl">31.2</span> <span class="sc">-</span><span class="fl">74.8</span>        <span class="cn">NaN</span> </span>
<span id="cb234-16"><a href="manipulating-data.html#cb234-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 111 more rows, and 1 more variable: hu_diameter &lt;dbl&gt;</span></span>
<span id="cb234-17"><a href="manipulating-data.html#cb234-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-18"><a href="manipulating-data.html#cb234-18" aria-hidden="true" tabindex="-1"></a><span class="co"># move numeric variables to the front</span></span>
<span id="cb234-19"><a href="manipulating-data.html#cb234-19" aria-hidden="true" tabindex="-1"></a>avg_hurricane_intensity <span class="sc">%&gt;%</span></span>
<span id="cb234-20"><a href="manipulating-data.html#cb234-20" aria-hidden="true" tabindex="-1"></a><span class="fu">relocate</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb234-21"><a href="manipulating-data.html#cb234-21" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 121 x 11</span></span>
<span id="cb234-22"><a href="manipulating-data.html#cb234-22" aria-hidden="true" tabindex="-1"></a>    year month   day  hour   lat  long  wind pressure ts_diameter hu_diameter</span>
<span id="cb234-23"><a href="manipulating-data.html#cb234-23" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb234-24"><a href="manipulating-data.html#cb234-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1991</span>  <span class="dv">11</span>     <span class="fl">1.5</span>   <span class="dv">9</span>     <span class="fl">38.8</span> <span class="sc">-</span><span class="fl">66.1</span>  <span class="dv">65</span>       <span class="fl">980.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-25"><a href="manipulating-data.html#cb234-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="fl">1999.</span>  <span class="fl">7.92</span> <span class="fl">13.4</span>   <span class="fl">8.82</span>  <span class="fl">30.8</span> <span class="sc">-</span><span class="fl">49.0</span>  <span class="fl">78.3</span>     <span class="fl">978.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-26"><a href="manipulating-data.html#cb234-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="fl">2006.</span>  <span class="fl">7.38</span> <span class="dv">10</span>     <span class="fl">8.24</span>  <span class="dv">33</span>   <span class="sc">-</span><span class="fl">77.1</span>  <span class="fl">83.1</span>     <span class="fl">966.</span>        <span class="fl">304.</span>        <span class="fl">63.6</span></span>
<span id="cb234-27"><a href="manipulating-data.html#cb234-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1983</span>   <span class="dv">8</span>    <span class="fl">17.5</span>   <span class="fl">7.62</span>  <span class="fl">28.4</span> <span class="sc">-</span><span class="fl">94.5</span>  <span class="fl">84.4</span>     <span class="fl">974.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-28"><a href="manipulating-data.html#cb234-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1995</span>   <span class="dv">6</span>     <span class="fl">4.33</span> <span class="dv">10</span>     <span class="fl">26.2</span> <span class="sc">-</span><span class="fl">86.2</span>  <span class="dv">65</span>       <span class="fl">988.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-29"><a href="manipulating-data.html#cb234-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1992</span>   <span class="dv">8</span>    <span class="fl">24.0</span>   <span class="fl">9.09</span>  <span class="fl">26.4</span> <span class="sc">-</span><span class="fl">80.4</span> <span class="fl">118.</span>      <span class="fl">947.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-30"><a href="manipulating-data.html#cb234-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1977</span>   <span class="fl">8.62</span> <span class="fl">12.8</span>   <span class="fl">9.69</span>  <span class="fl">25.3</span> <span class="sc">-</span><span class="fl">94.2</span>  <span class="fl">93.1</span>     <span class="fl">968.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-31"><a href="manipulating-data.html#cb234-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">2014</span>   <span class="dv">7</span>     <span class="fl">3.73</span>  <span class="fl">7.55</span>  <span class="fl">34.6</span> <span class="sc">-</span><span class="fl">76.1</span>  <span class="fl">77.3</span>     <span class="fl">978.</span>        <span class="fl">209.</span>        <span class="fl">58.1</span></span>
<span id="cb234-32"><a href="manipulating-data.html#cb234-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1983</span>   <span class="dv">8</span>    <span class="dv">28</span>    <span class="fl">15.7</span>   <span class="fl">25.4</span> <span class="sc">-</span><span class="fl">97.1</span>  <span class="fl">68.3</span>     <span class="fl">988.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-33"><a href="manipulating-data.html#cb234-33" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1976</span>   <span class="dv">8</span>     <span class="fl">8.5</span>   <span class="dv">9</span>     <span class="fl">31.2</span> <span class="sc">-</span><span class="fl">74.8</span>  <span class="dv">91</span>       <span class="fl">966.</span>        <span class="cn">NaN</span>        <span class="cn">NaN</span>  </span>
<span id="cb234-34"><a href="manipulating-data.html#cb234-34" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 111 more rows, and 1 more variable: name &lt;chr&gt;</span></span></code></pre></div>
</div>
<div id="try-it-out-16" class="section level2 tryitout unnumbered">
<h2>Try it out</h2>
<details>
<summary>
Data Setup
</summary>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="manipulating-data.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;gapminder&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(<span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb235-2"><a href="manipulating-data.html#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb235-3"><a href="manipulating-data.html#cb235-3" aria-hidden="true" tabindex="-1"></a>gapminder_unfiltered</span>
<span id="cb235-4"><a href="manipulating-data.html#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3,313 x 6</span></span>
<span id="cb235-5"><a href="manipulating-data.html#cb235-5" aria-hidden="true" tabindex="-1"></a>   country     continent  year lifeExp      pop gdpPercap</span>
<span id="cb235-6"><a href="manipulating-data.html#cb235-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>       <span class="er">&lt;</span>fct<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb235-7"><a href="manipulating-data.html#cb235-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Afghanistan Asia       <span class="dv">1952</span>    <span class="fl">28.8</span>  <span class="dv">8425333</span>      <span class="fl">779.</span></span>
<span id="cb235-8"><a href="manipulating-data.html#cb235-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Afghanistan Asia       <span class="dv">1957</span>    <span class="fl">30.3</span>  <span class="dv">9240934</span>      <span class="fl">821.</span></span>
<span id="cb235-9"><a href="manipulating-data.html#cb235-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Afghanistan Asia       <span class="dv">1962</span>    <span class="fl">32.0</span> <span class="dv">10267083</span>      <span class="fl">853.</span></span>
<span id="cb235-10"><a href="manipulating-data.html#cb235-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Afghanistan Asia       <span class="dv">1967</span>    <span class="fl">34.0</span> <span class="dv">11537966</span>      <span class="fl">836.</span></span>
<span id="cb235-11"><a href="manipulating-data.html#cb235-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Afghanistan Asia       <span class="dv">1972</span>    <span class="fl">36.1</span> <span class="dv">13079460</span>      <span class="fl">740.</span></span>
<span id="cb235-12"><a href="manipulating-data.html#cb235-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Afghanistan Asia       <span class="dv">1977</span>    <span class="fl">38.4</span> <span class="dv">14880372</span>      <span class="fl">786.</span></span>
<span id="cb235-13"><a href="manipulating-data.html#cb235-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Afghanistan Asia       <span class="dv">1982</span>    <span class="fl">39.9</span> <span class="dv">12881816</span>      <span class="fl">978.</span></span>
<span id="cb235-14"><a href="manipulating-data.html#cb235-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Afghanistan Asia       <span class="dv">1987</span>    <span class="fl">40.8</span> <span class="dv">13867957</span>      <span class="fl">852.</span></span>
<span id="cb235-15"><a href="manipulating-data.html#cb235-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Afghanistan Asia       <span class="dv">1992</span>    <span class="fl">41.7</span> <span class="dv">16317921</span>      <span class="fl">649.</span></span>
<span id="cb235-16"><a href="manipulating-data.html#cb235-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Afghanistan Asia       <span class="dv">1997</span>    <span class="fl">41.8</span> <span class="dv">22227415</span>      <span class="fl">635.</span></span>
<span id="cb235-17"><a href="manipulating-data.html#cb235-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 3,303 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="manipulating-data.html#cb236-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(gapminder_unfiltered, <span class="st">&quot;data/gapminder.csv&quot;</span>, <span class="at">na =</span> <span class="st">&#39;.&#39;</span>)</span></code></pre></div>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          
8          filename fileloc &#39;data/gapminder.csv&#39;;


NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: The SAS System stopped processing this step because of errors.
9          PROC IMPORT  datafile = fileloc out=classdat.gapminder REPLACE
10         DBMS = csv; /* comma delimited file */
11         GUESSINGROWS=500;
12         GETNAMES = YES;
13         RUN;


ERROR: Errors printed on pages 5,7,12,13,16,17,18,19.</code></pre>
</details>
<p>You can <a href="https://www.gapminder.org/data/documentation/">read about the gapminder project here</a>.</p>
<p>The gapminder data used for this set of problems contains data from 142 countries on 5 continents. The filtered data in <code>gapminder</code> (in R) contain data about every 5 year period between 1952 and 2007, the country’s life expectancy at birth, population, and per capita GDP (in US $, inflation adjusted). In the <code>gapminder_unfiltered</code> table, however, things are a bit different. Some countries have yearly data, observations are missing, and some countries don’t have complete data. I’ve exported the <code>gapminder_unfiltered</code> table to CSV for import into SAS as well - try to do these tasks in both languages.</p>
<p>Task 1: How bad is it? Using your EDA skills, determine <em>how bad</em> the unfiltered data are. You may want to look for missing values, number of records, etc. Use WHERE or filter to show any countries which have incomplete data. Describe, in words, what operations were necessary to get this information.</p>
<details>
<summary>
R
</summary>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="manipulating-data.html#cb238-1" aria-hidden="true" tabindex="-1"></a>gapminder_unfiltered <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="manipulating-data.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="manipulating-data.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">missinglifeExp =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(lifeExp)), </span>
<span id="cb238-4"><a href="manipulating-data.html#cb238-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">missingpop =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(pop)),</span>
<span id="cb238-5"><a href="manipulating-data.html#cb238-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">missingGDP =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(gdpPercap))) <span class="sc">%&gt;%</span></span>
<span id="cb238-6"><a href="manipulating-data.html#cb238-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">!=</span> <span class="fu">length</span>(<span class="fu">seq</span>(<span class="dv">1952</span>, <span class="dv">2007</span>, <span class="at">by =</span> <span class="dv">5</span>)))</span>
<span id="cb238-7"><a href="manipulating-data.html#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 83 x 5</span></span>
<span id="cb238-8"><a href="manipulating-data.html#cb238-8" aria-hidden="true" tabindex="-1"></a>   country        n missinglifeExp missingpop missingGDP</span>
<span id="cb238-9"><a href="manipulating-data.html#cb238-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>          <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb238-10"><a href="manipulating-data.html#cb238-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Armenia        <span class="dv">4</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-11"><a href="manipulating-data.html#cb238-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Aruba          <span class="dv">8</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-12"><a href="manipulating-data.html#cb238-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Australia     <span class="dv">56</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-13"><a href="manipulating-data.html#cb238-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Austria       <span class="dv">57</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-14"><a href="manipulating-data.html#cb238-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Azerbaijan     <span class="dv">4</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-15"><a href="manipulating-data.html#cb238-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Bahamas       <span class="dv">10</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-16"><a href="manipulating-data.html#cb238-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Barbados      <span class="dv">10</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-17"><a href="manipulating-data.html#cb238-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Belarus       <span class="dv">18</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-18"><a href="manipulating-data.html#cb238-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Belgium       <span class="dv">57</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-19"><a href="manipulating-data.html#cb238-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Belize        <span class="dv">11</span>              <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span></span>
<span id="cb238-20"><a href="manipulating-data.html#cb238-20" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 73 more rows</span></span></code></pre></div>
</details>
<details>
<summary>
SAS
</summary>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE gapsummary AS
10         SELECT DISTINCT country, COUNT(*) AS n,
11         SUM(MISSING(lifeExp)) AS missinglifeExp,
12         SUM(MISSING(pop)) AS missingpop,
13         SUM(MISSING(gdpPercap)) AS missingGDP
14         FROM classdat.gapminder
15         GROUP BY country;
NOTE: Statement not executed due to NOEXEC option.
16         
17         /* Print the problem countries only */
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


18         PROC PRINT DATA = gapsummary;
ERROR: File WORK.GAPSUMMARY.DATA does not exist.
19         WHERE n ^= 12;
WARNING: No data sets qualify for WHERE processing.
20         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13,16,17,18,19.</code></pre>
</details>
<p>In order to determine what gaps were present in the gapminder dataset, I determined how many years of data were available for each country by grouping the dataset and counting the rows. There should be 12 years worth of data between 1952 and 2007; as a result, I displayed the countries which did not have exactly 12 years of data.</p>
<p>Task 2: Exclude any data which isn’t at 5-year increments, starting in 1952 (so 1952, 1957, 1962, …, 2007).</p>
<details>
<summary>
R
</summary>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="manipulating-data.html#cb240-1" aria-hidden="true" tabindex="-1"></a>gapminder_unfiltered <span class="sc">%&gt;%</span></span>
<span id="cb240-2"><a href="manipulating-data.html#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1952</span>, <span class="dv">2007</span>, <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb240-3"><a href="manipulating-data.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 2,013 x 6</span></span>
<span id="cb240-4"><a href="manipulating-data.html#cb240-4" aria-hidden="true" tabindex="-1"></a>   country     continent  year lifeExp      pop gdpPercap</span>
<span id="cb240-5"><a href="manipulating-data.html#cb240-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>       <span class="er">&lt;</span>fct<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb240-6"><a href="manipulating-data.html#cb240-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Afghanistan Asia       <span class="dv">1952</span>    <span class="fl">28.8</span>  <span class="dv">8425333</span>      <span class="fl">779.</span></span>
<span id="cb240-7"><a href="manipulating-data.html#cb240-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Afghanistan Asia       <span class="dv">1957</span>    <span class="fl">30.3</span>  <span class="dv">9240934</span>      <span class="fl">821.</span></span>
<span id="cb240-8"><a href="manipulating-data.html#cb240-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Afghanistan Asia       <span class="dv">1962</span>    <span class="fl">32.0</span> <span class="dv">10267083</span>      <span class="fl">853.</span></span>
<span id="cb240-9"><a href="manipulating-data.html#cb240-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Afghanistan Asia       <span class="dv">1967</span>    <span class="fl">34.0</span> <span class="dv">11537966</span>      <span class="fl">836.</span></span>
<span id="cb240-10"><a href="manipulating-data.html#cb240-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Afghanistan Asia       <span class="dv">1972</span>    <span class="fl">36.1</span> <span class="dv">13079460</span>      <span class="fl">740.</span></span>
<span id="cb240-11"><a href="manipulating-data.html#cb240-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Afghanistan Asia       <span class="dv">1977</span>    <span class="fl">38.4</span> <span class="dv">14880372</span>      <span class="fl">786.</span></span>
<span id="cb240-12"><a href="manipulating-data.html#cb240-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Afghanistan Asia       <span class="dv">1982</span>    <span class="fl">39.9</span> <span class="dv">12881816</span>      <span class="fl">978.</span></span>
<span id="cb240-13"><a href="manipulating-data.html#cb240-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Afghanistan Asia       <span class="dv">1987</span>    <span class="fl">40.8</span> <span class="dv">13867957</span>      <span class="fl">852.</span></span>
<span id="cb240-14"><a href="manipulating-data.html#cb240-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Afghanistan Asia       <span class="dv">1992</span>    <span class="fl">41.7</span> <span class="dv">16317921</span>      <span class="fl">649.</span></span>
<span id="cb240-15"><a href="manipulating-data.html#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Afghanistan Asia       <span class="dv">1997</span>    <span class="fl">41.8</span> <span class="dv">22227415</span>      <span class="fl">635.</span></span>
<span id="cb240-16"><a href="manipulating-data.html#cb240-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 2,003 more rows</span></span></code></pre></div>
</details>
<details>
<summary>
SAS
</summary>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE gap5 AS
10         SELECT *
11         FROM classdat.gapminder
12         WHERE MOD(year, 5) = 2;
NOTE: Statement not executed due to NOEXEC option.
13         
14         /* Aus had too much data, so use it to see if the command worked
14       !  */
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


15         PROC PRINT DATA = gap5;
ERROR: File WORK.GAP5.DATA does not exist.
16         WHERE country = &quot;Australia&quot;;
WARNING: No data sets qualify for WHERE processing.
17         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13,16,17,18,19.</code></pre>
</details>
<p>Task 3: Exclude any countries that don’t have a full set of observations from 1952 - 2007 in 5-year increments.</p>
<details>
<summary>
R
</summary>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="manipulating-data.html#cb242-1" aria-hidden="true" tabindex="-1"></a>gapminder_unfiltered <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="manipulating-data.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1952</span>, <span class="dv">2007</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb242-3"><a href="manipulating-data.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb242-4"><a href="manipulating-data.html#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nobs =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co"># Use mutate instead of summarize so that all rows stay</span></span>
<span id="cb242-5"><a href="manipulating-data.html#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nobs <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb242-6"><a href="manipulating-data.html#cb242-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>nobs)</span>
<span id="cb242-7"><a href="manipulating-data.html#cb242-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 1,704 x 6</span></span>
<span id="cb242-8"><a href="manipulating-data.html#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   country [142]</span></span>
<span id="cb242-9"><a href="manipulating-data.html#cb242-9" aria-hidden="true" tabindex="-1"></a>   country     continent  year lifeExp      pop gdpPercap</span>
<span id="cb242-10"><a href="manipulating-data.html#cb242-10" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>       <span class="er">&lt;</span>fct<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb242-11"><a href="manipulating-data.html#cb242-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Afghanistan Asia       <span class="dv">1952</span>    <span class="fl">28.8</span>  <span class="dv">8425333</span>      <span class="fl">779.</span></span>
<span id="cb242-12"><a href="manipulating-data.html#cb242-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Afghanistan Asia       <span class="dv">1957</span>    <span class="fl">30.3</span>  <span class="dv">9240934</span>      <span class="fl">821.</span></span>
<span id="cb242-13"><a href="manipulating-data.html#cb242-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Afghanistan Asia       <span class="dv">1962</span>    <span class="fl">32.0</span> <span class="dv">10267083</span>      <span class="fl">853.</span></span>
<span id="cb242-14"><a href="manipulating-data.html#cb242-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Afghanistan Asia       <span class="dv">1967</span>    <span class="fl">34.0</span> <span class="dv">11537966</span>      <span class="fl">836.</span></span>
<span id="cb242-15"><a href="manipulating-data.html#cb242-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Afghanistan Asia       <span class="dv">1972</span>    <span class="fl">36.1</span> <span class="dv">13079460</span>      <span class="fl">740.</span></span>
<span id="cb242-16"><a href="manipulating-data.html#cb242-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Afghanistan Asia       <span class="dv">1977</span>    <span class="fl">38.4</span> <span class="dv">14880372</span>      <span class="fl">786.</span></span>
<span id="cb242-17"><a href="manipulating-data.html#cb242-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Afghanistan Asia       <span class="dv">1982</span>    <span class="fl">39.9</span> <span class="dv">12881816</span>      <span class="fl">978.</span></span>
<span id="cb242-18"><a href="manipulating-data.html#cb242-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Afghanistan Asia       <span class="dv">1987</span>    <span class="fl">40.8</span> <span class="dv">13867957</span>      <span class="fl">852.</span></span>
<span id="cb242-19"><a href="manipulating-data.html#cb242-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Afghanistan Asia       <span class="dv">1992</span>    <span class="fl">41.7</span> <span class="dv">16317921</span>      <span class="fl">649.</span></span>
<span id="cb242-20"><a href="manipulating-data.html#cb242-20" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Afghanistan Asia       <span class="dv">1997</span>    <span class="fl">41.8</span> <span class="dv">22227415</span>      <span class="fl">635.</span></span>
<span id="cb242-21"><a href="manipulating-data.html#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 1,694 more rows</span></span></code></pre></div>
</details>
<details>
<summary>
SAS
</summary>
<pre class="sashtmllog"><code>6          libname classdat &quot;sas/&quot;;
NOTE: Libref CLASSDAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: 
      /home/susan/Projects/Class/unl-stat850/stat850-textbook/sas
7          


8          PROC SQL;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of 
      statements.
9          CREATE TABLE gap5 AS
10         SELECT *
11         FROM classdat.gapminder
12         WHERE MOD(year, 5) = 2;
NOTE: Statement not executed due to NOEXEC option.
13         
14         CREATE TABLE gap_clean AS
15         SELECT *, COUNT(*) as n
16         FROM gap5
17         GROUP BY country
18         HAVING n = 12;
NOTE: Statement not executed due to NOEXEC option.
19         
20         /* Clean up extra column */
21         ALTER TABLE gap_clean
22         DROP n;
NOTE: Statement not executed due to NOEXEC option.
23         
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


24         PROC PRINT DATA = gap_clean;
ERROR: File WORK.GAP_CLEAN.DATA does not exist.
25         RUN;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Errors printed on pages 5,7,12,13,16,17,18,19.</code></pre>
</details>
</div>
<div id="references-1" class="section level2 learn-more unnumbered">
<h2>References</h2>
<ul>
<li><p><a href="https://stat545.com/dplyr-intro.html">Introduction to dplyr</a> and <a href="https://stat545.com/dplyr-single.html">Single Table dplyr functions</a></p></li>
<li><p><a href="https://stats.idre.ucla.edu/sas/modules/using-where-with-sas-procedures/">Using WHERE with SAS Procedures</a></p></li>
<li><p><a href="https://documentation.sas.com/?docsetId=sqlproc&amp;docsetTarget=n1oihmdy7om5rmn1aorxui3kxizl.htm&amp;docsetVersion=9.4&amp;locale=en">PROC SQL documentation</a></p></li>
<li><p>R for Data Science: <a href="https://r4ds.had.co.nz/transform.html">Data Transformations</a></p></li>
<li><p>Additional practice exercises: <a href="https://stat579-at-isu.github.io/materials/03_tidyverse/01_dplyr.html#19">Intro to the tidyverse</a>, <a href="https://stat579-at-isu.github.io/materials//03_tidyverse/02_dplyr-examples.html">group_by + summarize examples</a>, <a href="https://stat579-at-isu.github.io/materials//03_tidyverse/03_dplyr-examples.html#1">group_by + mutate examples</a> (from a similar class at Iowa State)</p></li>
<li><p><a href="https://vknight.org/SAS-R/Content/R-Chapter-03/">Base R data manipulation</a></p></li>
<li><p><a href="https://vknight.org/SAS-R/Content/SAS-Chapter-03/">SAS data manipulation</a></p></li>
<li><p><a href="https://www.youtube.com/playlist?list=PL19ev-r1GBwkuyiwnxoHTRC8TTqP8OEi8">Videos of analysis of new data from Tidy Tuesday</a> - may include use of other packages, but almost definitely includes use of dplyr as well.</p></li>
</ul>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>See <a href="https://twitter.com/JennyBryan/status/722954354198597632">this twitter thread</a> for some horror stories. <a href="https://twitter.com/jengolbeck/status/1153064308483510272?s=20">This tweet</a> is also pretty good at showing one type of messiness.<a href="manipulating-data.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>The philosophy includes a preference for pipes, but this preference stems from the belief that code should be readable in the same way that text is readable.<a href="manipulating-data.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>It accomplishes this through the magic of quasiquotation, which we will not cover in this course because it’s basically witchcraft.<a href="manipulating-data.html#fnref21" class="footnote-back">↩︎</a></p></li>
<li id="fn22"><p>This is equivalent to using right assignment in R with <code>-&gt;</code>, which you shouldn’t do unless you have a <em>really</em> good reason, because it’s hard to read.<a href="manipulating-data.html#fnref22" class="footnote-back">↩︎</a></p></li>
<li id="fn23"><p>or <code>?summarise</code> if you like UK English – the developer of this package is from NZ<a href="manipulating-data.html#fnref23" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reading-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transforming-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
